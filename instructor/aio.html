<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="fr" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Introduction to data analysis with R and Bioconductor: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/incubator/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicons/incubator/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicons/incubator/favicon-16x16.png">
<link rel="manifest" href="../favicons/incubator/site.webmanifest">
<link rel="mask-icon" href="../favicons/incubator/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo.svg">
</div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Introduction to data analysis with R and Bioconductor
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Introduction to data analysis with R and Bioconductor
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to data analysis with R and Bioconductor
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="10-data-organisation.html">1. Organisation des données avec des feuilles de calcul</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="20-r-rstudio.html">2. R et RStudio</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="23-starting-with-r.html">3. Introduction à R</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="25-starting-with-data.html">4. Commencer par les données</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="30-dplyr.html">5. Manipulation et analyse de données avec dplyr</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="40-visualization.html">6. Visualisation de données</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="60-next-steps.html">7. Prochaines étapes</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-10-data-organisation"><p>Content from <a href="10-data-organisation.html">Organisation des données avec des feuilles de calcul</a></p>
<hr>
<p>Last updated on 2025-05-05 |

        <a href="https://github.com/carpentries-incubator/bioc-intro/edit/main/episodes/10-data-organisation.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Comment organiser des données tabulaires ?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Découvrir les feuilles de calcul, leurs forces et leurs
faiblesses.</li>
<li>Comment formater les données dans des feuilles de calcul pour une
utilisation efficace des données ?</li>
<li>Découvrir les erreurs courantes des feuilles de calcul et comment
les corriger.</li>
<li>Organiser vos données selon des principes de données propres.</li>
<li>Découvrir les formats de feuilles de calcul textuels tels que les
formats séparés par des virgules (CSV) ou par des tabulations
(TSV).</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<blockquote>
<p>Cet épisode est basé sur la leçon <em>Data Analysis and Visualisation
in R for Ecologists</em> de Data Carpentries.</p>
</blockquote>
<section><h2 class="section-heading" id="tableurs">Tableurs<a class="anchor" aria-label="anchor" href="#tableurs"></a>
</h2>
<hr class="half-width">
<p><strong>Question</strong></p>
<ul>
<li>Quels sont les principes de base d’utilisation des feuilles de
calcul pour une bonne organisation des données  ?</li>
</ul>
<p><strong>Objectifs</strong></p>
<ul>
<li>Décrire les bonnes pratiques pour organiser les données afin que les
ordinateurs puissent en faire la meilleure utilisation.</li>
</ul>
<p><strong>Point clé</strong></p>
<ul>
<li>Une bonne organisation des données est la base de tout projet de
recherche.</li>
</ul>
<p>Une bonne organisation des données est la base de votre projet de
recherche . La plupart des chercheurs disposent de données ou effectuent
la saisie de données dans des feuilles de calcul . Les tableurs sont des
interfaces graphiques très utiles pour concevoir des tableaux de données
et gérer des fonctions de contrôle qualité de données très basiques.
Voir aussi <span class="citation">@Broman</span> : 2018.</p>
<div class="section level3">
<h3 id="aperçu-de-la-feuille-de-calcul">Aperçu de la feuille de calcul<a class="anchor" aria-label="anchor" href="#aper%C3%A7u-de-la-feuille-de-calcul"></a>
</h3>
<p>Les feuilles de calcul sont utiles pour la saisie de données. Nous
avons donc beaucoup de données dans des feuilles de calcul. Une grande
partie de votre temps en tant que chercheur sera consacrée à cette étape
de « gestion des données ». Ce n’est pas le plus amusant, mais c’est
nécessaire. Nous vous apprendrons comment réfléchir à l’organisation des
données et quelques pratiques pour une gestion plus efficace des
données.</p>
</div>
<div class="section level3">
<h3 id="ce-que-cette-leçon-ne-vous-apprendra-pas">Ce que cette leçon ne vous apprendra pas<a class="anchor" aria-label="anchor" href="#ce-que-cette-le%C3%A7on-ne-vous-apprendra-pas"></a>
</h3>
<ul>
<li>Comment faire des <em>statistiques</em> dans une feuille de
calcul</li>
<li>Comment faire un <em>graphique</em> dans une feuille de calcul</li>
<li>Comment <em>écrire du code</em> dans des tableurs</li>
</ul>
<p>Si vous cherchez à faire cela, une bonne référence est Head First
Excel, publié par O’Reilly.</p>
</div>
<div class="section level3">
<h3 id="pourquoi-nenseignons-nous-pas-lanalyse-de-données-dans-des-feuilles-de-calcul">Pourquoi n’enseignons-nous pas l’analyse de données dans des
feuilles de calcul<a class="anchor" aria-label="anchor" href="#pourquoi-nenseignons-nous-pas-lanalyse-de-donn%C3%A9es-dans-des-feuilles-de-calcul"></a>
</h3>
<ul>
<li><p>L’analyse de données dans des feuilles de calcul nécessite
généralement beaucoup de travail manuel. Si vous souhaitez modifier un
paramètre ou exécuter une analyse avec un nouvel ensemble de données,
vous devez généralement tout refaire à la main. (Nous savons que vous
pouvez créer des macros, mais voir le point suivant.)</p></li>
<li><p>Il est également difficile de suivre ou de reproduire des
analyses statistiques ou graphiques effectuées dans des tableurs lorsque
vous souhaitez revenir à votre travail ou que quelqu’un vous demande des
détails sur votre analyse.</p></li>
</ul>
<p>De nombreux tableurs sont disponibles. Étant donné que la plupart des
participants utilisent Excel comme tableur principal, cette leçon
utilisera des exemples Excel. Un tableur gratuit qui peut également être
utilisé est LibreOffice. Les commandes peuvent différer un peu selon les
programmes, mais l’idée générale est la même.</p>
<p>Les tableurs englobent de nombreuses choses que nous devons être en
mesure de faire en tant que chercheurs. Nous pouvons les utiliser pour
:</p>
<ul>
<li>La saisie des données</li>
<li>L’organisation des données</li>
<li>Extraire des sous-ensembles et trier des données</li>
<li>Des statistiques</li>
<li>Visualiser des données</li>
</ul>
<p>Les tableurs utilisent des tableaux pour représenter et afficher les
données. Les données formatées sous forme de tableaux sont également le
thème principal de ce chapitre, et nous verrons comment organiser les
données en tableaux de manière standardisée pour assurer une analyse
efficace en aval.</p>
<div id="défi-discutez-des-points-suivants-avec-votre-voisin" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="défi-discutez-des-points-suivants-avec-votre-voisin" class="callout-inner">
<h3 class="callout-title">Défi : Discutez des points suivants avec votre voisin</h3>
<div class="callout-content">
<ul>
<li>Avez-vous utilisé des feuilles de calcul, dans vos recherches, vos
cours, ou à la maison ?</li>
<li>Quel type d’opérations effectuez-vous dans des feuilles de
calcul ?</li>
<li>Selon vous, pour lesquels les feuilles de calcul sont-elles
utiles ?</li>
<li>Avez-vous accidentellement fait quelque chose dans un tableur qui
vous a rendu frustré ou triste ?</li>
</ul>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="problèmes-avec-les-feuilles-de-calcul">Problèmes avec les feuilles de calcul<a class="anchor" aria-label="anchor" href="#probl%C3%A8mes-avec-les-feuilles-de-calcul"></a>
</h3>
<p>Les feuilles de calcul sont utiles pour la saisie de données, mais en
réalité, nous avons tendance à utiliser des tableurs pour bien plus que
la saisie de données. Nous les utilisons pour créer des tableaux de
données pour les publications, pour générer des statistiques
récapitulatives et faire des graphiques.</p>
<p>Générer des tableaux pour des publications dans une feuille de calcul
n’est pas optimal - souvent, lors du formatage d’un tableau de données,
nous rapportons les principales statistiques récapitulatives d’une
manière qui n’est pas vraiment destinée à être lue comme des données, et
implique souvent un formatage spécial (fusion de cellules, création de
bordures, préférences esthétiques pour les couleurs, etc.). Nous vous
conseillons d’effectuer ce genre d’opération au sein de votre logiciel
d’édition de documents.</p>
<p>Les deux dernières applications, la génération de statistiques et de
graphiques, doivent être utilisées avec précaution : en raison de la
nature graphique et glisser-déposer des tableurs, il peut être très
difficile, voire impossible, de retracer vos pas (et encore plus de
retracer ceux de quelqu’un d’autre), en particulier si vos statistiques
ou graphiques nécessitent que vous fassiez des calculs plus complexes.
De plus, en effectuant des calculs dans une feuille de calcul, il est
facile d’appliquer accidentellement une formule légèrement différente à
plusieurs cellules adjacentes. Lorsque vous utilisez un programme de
statistiques basé sur une ligne de commande comme R ou SAS, il est
pratiquement impossible d’appliquer un calcul à une observation de votre
ensemble de données mais pas à une autre, sauf si vous le faites
exprès.</p>
</div>
<div class="section level3">
<h3 id="utiliser-des-feuilles-de-calcul-pour-la-saisie-et-le-nettoyage-des-données">Utiliser des feuilles de calcul pour la saisie et le nettoyage des
données<a class="anchor" aria-label="anchor" href="#utiliser-des-feuilles-de-calcul-pour-la-saisie-et-le-nettoyage-des-donn%C3%A9es"></a>
</h3>
<p>Dans cette leçon, nous supposerons que vous utilisez très
probablement Excel comme tableur principal - il en existe d’autres
(gnumeric, Calc d’OpenOffice), et leurs fonctionnalités sont similaires,
mais Excel semble être le programme le plus utilisé par les biologistes
et les chercheurs en biomédical.</p>
<p>Dans cette leçon, nous allons parler de :</p>
<ol style="list-style-type: decimal">
<li>Formatage de tableaux de données dans des feuilles de calcul</li>
<li>Problèmes de formatage</li>
<li>Exportation des données</li>
</ol>
</div>
</section><section><h2 class="section-heading" id="formatage-des-tableaux-de-données-dans-des-feuilles-de-calcul">Formatage des tableaux de données dans des feuilles de calcul<a class="anchor" aria-label="anchor" href="#formatage-des-tableaux-de-donn%C3%A9es-dans-des-feuilles-de-calcul"></a>
</h2>
<hr class="half-width">
<p><strong>Questions</strong></p>
<ul>
<li>Comment formater les données dans des feuilles de calcul pour une
utilisation efficace des données ?</li>
</ul>
<p><strong>Objectifs</strong></p>
<ul>
<li><p>Décrire les meilleures pratiques pour la saisie et le formatage
des données dans les feuilles de calcul.</p></li>
<li><p>Appliquer les meilleures pratiques pour organiser les variables
et les observations dans une feuille de calcul.</p></li>
</ul>
<p><strong>Points clés</strong></p>
<ul>
<li><p>Ne modifiez jamais vos données brutes. Faites toujours une copie
avant d’apporter des modifications.</p></li>
<li><p>Gardez une trace de toutes les étapes que vous suivez pour
nettoyer vos données dans un fichier texte brut.</p></li>
<li><p>Organisez vos données selon les principes du <em>tidyverse</em>
(des données ordonnées).</p></li>
</ul>
<p>L’erreur la plus courante est de traiter les tableurs comme des
cahiers de laboratoire, c’est-à-dire de s’appuyer sur le contexte, les
notes dans la marge, la disposition spatiale des données et des champs
pour transmettre des informations. En tant qu’êtres humains, nous
pouvons (généralement) interpréter cela, mais les ordinateurs ne voient
pas les informations de la même manière, et à moins que nous expliquions
à l’ordinateur ce que tout signifie (et ça peut être dur !), il ne
pourra pas voir comment nos données sont reliées.</p>
<p>En utilisant la puissance des ordinateurs, nous pouvons gérer et
analyser les données de manière beaucoup plus efficace et plus rapide,
mais pour utiliser cette puissance, nous devons configurer nos données
pour que l’ordinateur puisse les comprendre (et les ordinateurs sont
très littéraux).</p>
<p>C’est pourquoi il est extrêmement important de mettre en place des
tableaux bien formatés dès le départ - avant même de commencer à saisir
les données de votre toute première expérience préliminaire .
L’organisation des données est le fondement de votre projet de
recherche. Cela peut simplifier ou complexifier le travail avec vos
données tout au long de votre analyse. Ça vaut donc la peine d’y
réfléchir au moment où vous effectuez votre saisie de données ou
configurez votre expérience. Vous pouvez configurer les choses de
différentes manières dans des feuilles de calcul, mais certains de ces
choix peuvent limiter votre capacité à travailler avec les données dans
d’autres programmes ou empêcher quelqu’un d’autre de travailler avec les
données.</p>
<p><strong>Remarque :</strong> les meilleures mises en page/formats
(ainsi que les logiciels et les interfaces ) pour la saisie et l’analyse
des données peuvent être différents. Il est important d’en tenir compte,
et idéalement d’automatiser la conversion de l’un à l’autre.</p>
<div class="section level3">
<h3 id="garder-une-trace-de-vos-analyses">Garder une trace de vos analyses<a class="anchor" aria-label="anchor" href="#garder-une-trace-de-vos-analyses"></a>
</h3>
<p>Lorsque vous travaillez avec des feuilles de calcul, lors du
nettoyage ou des analyses des données, il est très facile de vous
retrouver avec une feuille de calcul qui semble très différente de celle
avec laquelle vous avez commencée. Afin de pouvoir reproduire vos
analyses ou comprendre ce que vous avez fait lorsqu’un relecteur ou un
instructeur demande une analyse différente, vous devez</p>
<ul>
<li><p>Créer un nouveau fichier avec vos données nettoyées ou analysées.
Ne modifiez pas le jeu de données d’origine, sinon vous ne saurez jamais
par où vous avez commencé !</p></li>
<li><p>Garder une trace des étapes que vous avez suivies lors de votre
nettoyage ou de votre analyse. Vous devriez noter ces étapes comme vous
le feriez pour n’importe quelle étape d’une expérience. Nous vous
recommandons de le faire dans un fichier texte brut stocké dans le même
dossier que le fichier de données.</p></li>
</ul>
<p>Ceci pourrait être un exemple de configuration d’une feuille de
calcul :</p>
<figure><img src="../fig/spreadsheet-setup-updated.png" class="figure mx-auto d-block"></figure><p>Mettez ces principes en pratique aujourd’hui lors de vos
exercices.</p>
<p>Bien que la gestion des versions soit hors de portée de ce cours,
vous pouvez consulter la leçon <em>Carpentries</em> sur <a href="https://swcarpentry.github.io/git-novice/" class="external-link">‘Git’</a> pour
découvrir comment maintenir le <strong>contrôle des versions</strong> de
vos données. Voir aussi cet <a href="https://lgatto.github.io/github-intro/" class="external-link">article de blog</a> pour
un tutoriel rapide ou <span class="citation">@Perez-Riverol:2016</span>
pour un cas d’utilisation plus orienté vers la recherche.</p>
</div>
<div class="section level3">
<h3 id="structuration-des-données-dans-des-feuilles-de-calcul">Structuration des données dans des feuilles de calcul<a class="anchor" aria-label="anchor" href="#structuration-des-donn%C3%A9es-dans-des-feuilles-de-calcul"></a>
</h3>
<p>Les règles cardinales de l’utilisation des tableurs pour les
données :</p>
<ol style="list-style-type: decimal">
<li>Mettez toutes vos variables dans des colonnes - ce que vous mesurez,
comme “poids” ou “température”.</li>
<li>Placez chaque observation dans sa propre ligne.</li>
<li>Ne combinez pas plusieurs informations dans une seule cellule.
Parfois cela semble n’être qu’une seule information, mais demandez-vous
si c’est la seule façon dont vous voulez utiliser ou trier ces
données.</li>
<li>Laissez les données brutes telles quelles - ne les modifiez pas
!</li>
<li>Exportez les données nettoyées dans un format texte tel que le
format CSV (<em>comma-separated values</em> - valeurs séparées par des
virgules). Cela garantit que n’importe qui peut utiliser les données et
c’est requis par la plupart des référentiels de données.</li>
</ol>
<p>Par exemple, nous disposons de données provenant de patients ayant
visité plusieurs hôpitaux à Bruxelles, en Belgique. La date de la
visite, l’hôpital, le sexe, le poids et le groupe sanguin des patients
ont été enregistrés.</p>
<p>Si nous enregistrions les données comme ceci :</p>
<figure><img src="../fig/multiple-info.png" class="figure mx-auto d-block"></figure><p>le problème est que les groupes sanguins ABO et le rhésus sont dans
la même colonne <code>Blood</code>. Donc, si on voulait examiner toutes
les observations du groupe A ou examiner les distributions de poids par
groupe ABO, il serait difficile de le faire en utilisant cette
configuration de données. Si à la place nous mettions les groupes ABO et
le rhésus dans des colonnes différentes, vous voyez que ce serait
beaucoup plus facile.</p>
<figure><img src="../fig/single-info.png" class="figure mx-auto d-block"></figure><p>Une règle importante lors de la création d’une feuille de données est
que les <strong>colonnes sont utilisées pour les variables</strong> et
les <strong>lignes sont utilisées pour les observations</strong> :</p>
<ul>
<li>les colonnes sont des variables</li>
<li>les lignes sont des observations</li>
<li>les cellules sont des valeurs individuelles</li>
</ul>
<div id="défi-nous-allons-prendre-un-jeu-de-données-désordonné-et-décrire-comment-nous-allons-le-nettoyer." class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="défi-nous-allons-prendre-un-jeu-de-données-désordonné-et-décrire-comment-nous-allons-le-nettoyer." class="callout-inner">
<h3 class="callout-title">Défi : Nous allons prendre un jeu de données désordonné et décrire comment nous allons le nettoyer.</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Téléchargez un jeu de données désordonné en cliquant sur <a href="https://github.com/UCLouvain-CBIO/WSBIM1207/raw/master/data/messy_covid.xlsx" class="external-link">ici</a>.</p></li>
<li><p>Ouvrez les données dans un tableur.</p></li>
<li><p>Vous pouvez voir qu’il y a deux onglets. Les données contiennent
diverses variables cliniques enregistrées dans divers hôpitaux
bruxellois lors des première et deuxième vagues du COVID-19 en 2020.
Comme vous pouvez le constater, les données ont été enregistrées
différemment lors des vagues de mars et novembre. Vous êtes désormais la
personne en charge de ce projet et vous souhaitez pouvoir commencer à
analyser les données.</p></li>
<li><p>Avec la personne à côté de vous, identifiez ce qui ne va pas avec
cette feuille de calcul. Discutez également des étapes que vous devriez
suivre pour nettoyer les onglets de la première et de la deuxième vague,
et pour les rassembler tous dans une seule feuille de calcul.</p></li>
</ol>
<p><strong>Important :</strong> N’oubliez pas notre premier conseil :
pour créer un nouveau fichier (ou onglet) pour les données nettoyées, ne
modifiez jamais vos données (brutes) d’origine.</p>
</div>
</div>
</div>
<p>Après avoir effectué cet exercice, nous discuterons en groupe de ce
qui n’allait pas avec ces données et de la manière dont vous pourriez y
remédier.</p>
<!-- - Take about 10 minutes to work on this exercise. -->
<!-- - All the mistakes in the *common mistakes* section below are present -->
<!--   in the messy dataset. If the exercise is done during a workshop, ask -->
<!--   people what they saw as wrong with the data. As they bring up -->
<!--   different points, you can refer to the common mistakes or expand a -->
<!--   bit on the point they brought up. -->
<!-- - If you get a response where they've fixed the date, you can pause -->
<!--   and go to the dates lesson. Or you can say you'll come back to dates -->
<!--   at the end. -->
<div id="défi-une-fois-que-vous-avez-nettoyé-les-données-répondez-aux-questions-suivantes" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="défi-une-fois-que-vous-avez-nettoyé-les-données-répondez-aux-questions-suivantes" class="callout-inner">
<h3 class="callout-title">Défi : Une fois que vous avez nettoyé les données, répondez aux questions suivantes :</h3>
<div class="callout-content">
<ul>
<li>Combien d’hommes et de femmes ont participé à l’étude ?</li>
<li>Combien de personnes des groupes A, AB et B ont été testés ?</li>
<li>Idem, mais sans tenir compte des échantillons contaminés ?</li>
<li>Combien de personnes des rhésus + et - ont été testés ?</li>
<li>Combien de donneurs universels (O-) ont été testés ?</li>
<li>Quel est le poids moyen des hommes AB ?</li>
<li>Combien d’échantillons ont été testés dans les différents hôpitaux
?</li>
</ul>
</div>
</div>
</div>
<p>Une <strong>excellente référence</strong>, en particulier en ce qui
concerne les scripts R est l’article <em>Tidy Data</em> <span class="citation">@Wickham:2014</span>.</p>
</div>
</section><section><h2 class="section-heading" id="erreurs-courantes-dans-les-feuilles-de-calcul">Erreurs courantes dans les feuilles de calcul<a class="anchor" aria-label="anchor" href="#erreurs-courantes-dans-les-feuilles-de-calcul"></a>
</h2>
<hr class="half-width">
<p><strong>Questions</strong></p>
<ul>
<li>Quels sont les problèmes courants liés au formatage des données dans
les feuilles de calcul et comment pouvons-nous les éviter ?</li>
</ul>
<p><strong>Objectifs</strong></p>
<ul>
<li>Reconnaître et résoudre les problèmes courants de formatage des
feuilles de calcul.</li>
</ul>
<p><strong>Points clés</strong></p>
<ul>
<li>Éviter d’utiliser plusieurs tableaux dans une même feuille de
calcul.</li>
<li>Éviter de répartir les données sur plusieurs onglets.</li>
<li>Enregistrer les zéros comme des zéros.</li>
<li>Utilisez une valeur vide appropriée pour enregistrer les données
manquantes.</li>
<li>N’utilisez pas de formatage pour transmettre des informations ou
pour donner une jolie apparence à votre feuille de calcul.</li>
<li>Placez les commentaires dans une colonne séparée.</li>
<li>Enregistrez les unités dans les en-têtes de colonnes.</li>
<li>Incluez une seule information dans une cellule.</li>
<li>Évitez les espaces, les chiffres et les caractères spéciaux dans les
en-têtes de colonnes.</li>
<li>Évitez les caractères spéciaux dans vos données.</li>
<li>Enregistrez les métadonnées dans un fichier texte brut séparé.</li>
</ul>
<!-- This lesson is meant to be used as a reference for discussion as --><!-- learners identify issues with the messy dataset discussed in the --><!-- previous lesson. Instructors: don't go through this lesson except to --><!-- refer to responses to the exercise in the previous lesson. --><p>Il y a quelques erreurs potentielles à surveiller dans vos propres
données ainsi que dans les données de vos collaborateurs ou d’Internet.
Si vous êtes conscient des erreurs et de l’effet négatif possible sur
l’analyse des données en aval et l’interprétation des résultats, cela
pourrait vous motiver ainsi que les membres de votre projet à essayer de
les éviter. Apporter de petits changements à la façon dont vous formatez
vos données dans des feuilles de calcul peut avoir un grand impact sur
l’efficacité et la fiabilité en matière de nettoyage et d’analyse des
données.</p>
<ul>
<li><a href="#tables">Utilisation de plusieurs tables</a></li>
<li><a href="#tabs">Utilisation de plusieurs onglets</a></li>
<li><a href="#z%C3%A9ros">Zéros non remplis</a></li>
<li><a href="#null">Utilisation de valeurs vides problématiques</a></li>
<li><a href="#formatting">Utilisation du formatage pour transmettre des
informations</a></li>
<li><a href="#formatting_pretty">Utilisation du formatage pour rendre la
feuille de calcul jolie</a></li>
<li><a href="#unit%C3%A9s">Commentaires ou unités dans des cellules</a></li>
<li><a href="#info">Plusieurs informations dans une cellule</a></li>
<li><a href="#field_name">Utilisation de noms de champs
problématiques</a></li>
<li><a href="#special">Utilisation de caractères spéciaux dans les
données</a></li>
<li><a href="#metadata">Inclusion de métadonnées dans le tableau de
données</a></li>
</ul>
<div class="section level3">
<h3 id="tables">Utilisation de plusieurs tables<a class="anchor" aria-label="anchor" href="#tables"></a>
</h3>
<p>Une stratégie courante consiste à créer plusieurs tableaux de données
dans une seule feuille de calcul . Cela perturbe l’ordinateur, alors ne
faites pas ça ! Lorsque vous créez plusieurs tableaux dans une même
feuille de calcul, vous établissez de fausses associations entre les
éléments pour l’ordinateur, qui considère chaque ligne comme une
observation. Vous utilisez également potentiellement le même nom de
champ à plusieurs endroits, ce qui rendra plus difficile le nettoyage de
vos données dans un format utilisable. L’exemple ci-dessous illustre ce
problème :</p>
<figure><img src="../fig/2_datasheet_example.jpg" class="figure mx-auto d-block"></figure><p>Dans l’exemple ci-dessus, l’ordinateur verra (par exemple) la ligne 4
et supposera que toutes les colonnes A-AF font référence au même
échantillon. Cette ligne représente en fait quatre échantillons
distincts (échantillon 1 pour chacune des quatre dates de collecte
différentes - 29 mai, 12 juin, 19 juin et 26 juin), ainsi que quelques
statistiques récapitulatives calculées (une moyenne (avr) et une erreur
type de mesure (SEM)) pour deux de ces échantillons. D’autres lignes
posent également problème.</p>
</div>
<div class="section level3">
<h3 id="tabs">Utilisation de plusieurs onglets<a class="anchor" aria-label="anchor" href="#tabs"></a>
</h3>
<p>Mais qu’en est-il des onglets du classeur ? Cela semble être un moyen
simple d’organiser les données, n’est-ce pas ? Eh bien, oui et non.
Lorsque vous créez des onglets supplémentaires, vous ne permettez pas à
l’ordinateur de voir les connexions dans les données qui s’y trouvent
(vous devez introduire des fonctions spécifiques à l’application de
feuille de calcul ou des scripts pour garantir cette connexion).
Supposons, par exemple, que vous créiez un onglet séparé pour chaque
jour où vous prenez une mesure.</p>
<p>Ce n’est pas une bonne pratique pour deux raisons :</p>
<ol style="list-style-type: decimal">
<li><p>vous êtes plus susceptible d’ajouter accidentellement des
incohérences à vos données si à chaque fois que vous prenez une mesure,
vous commencez à enregistrer les données dans un nouvel onglet,
et</p></li>
<li><p>Même si vous parvenez à empêcher toute incohérence, vous vous
ajoutez une étape supplémentaire avant même d’analyser les données car
vous devrez combiner ces données en une seule table de données. Vous
devrez indiquer explicitement à l’ordinateur comment combiner les
onglets - et si les onglets ne sont pas formatés de manière cohérente,
vous devrez peut-être même le faire manuellement.</p></li>
</ol>
<p>La prochaine fois que vous saisirez des données et que vous créerez
un autre onglet ou un autre tableau, demandez-vous si vous pourriez
éviter d’ajouter cet onglet en ajoutant une autre colonne à votre
feuille de calcul d’origine. Nous avons utilisé plusieurs onglets dans
notre exemple de fichier de données désordonné, mais vous avez
maintenant vu comment vous pouvez réorganiser vos données pour regrouper
les onglets.</p>
<p>Votre feuille de calcul peut devenir très longue au cours de
l’expérience. Cela rend plus difficile la saisie des données si vous ne
voyez pas vos en-têtes en haut de la feuille de calcul mais ne répétez
pas votre ligne d’en-tête. Ceux-ci peuvent facilement être mélangés aux
données, entraînant des problèmes plus tard. À la place, vous pouvez <a href="https://support.office.com/en-ca/article/Freeze-column-headings-for-easy-scrolling-57ccce0c-cf85-4725-9579%20-c5d13106ca6a" class="external-link">geler
les en-têtes de la colonne</a> afin qu’ils restent visibles même lorsque
vous disposez d’une feuille de calcul comportant beaucoup de lignes.</p>
</div>
<div class="section level3">
<h3 id="zeros">Zéros non remplis<a class="anchor" aria-label="anchor" href="#zeros"></a>
</h3>
<p>Il se peut que lorsque vous mesurez quelque chose, il s’agisse
généralement d’un zéro, par exemple le nombre de fois qu’un lapin est
observé dans l’enquête. Pourquoi s’embêter à écrire le chiffre zéro dans
cette colonne, alors qu’il s’agit majoritairement de zéros ?</p>
<p>Cependant, il existe une différence entre un zéro et une cellule vide
dans une feuille de calcul. Pour l’ordinateur, un zéro est en réalité
une donnée. Vous l’avez mesuré ou compté. Une cellule vide signifie
qu’elle n’a pas été mesurée et l’ordinateur l’interprétera comme une
valeur inconnue (également appelée valeur vide ou valeur manquante).</p>
<p>Les feuilles de calcul ou les programmes statistiques interpréteront
probablement mal les cellules vides que vous envisagez d’être des zéros.
En n’entrant pas la valeur de votre observation, vous dites à votre
ordinateur de représenter ces données comme inconnues ou manquantes
(vides). Cela peut entraîner des problèmes lors des calculs ou analyses
ultérieurs. Par exemple, la moyenne d’un ensemble de nombres qui
comprend une seule valeur vide est toujours vide (car l’ordinateur ne
peut pas deviner la valeur des observations manquantes). À cause de
cela, il est très important d’enregistrer les zéros comme des zéros et
vraiment les données manquantes comme des valeurs vides.</p>
</div>
<div class="section level3">
<h3 id="null">Utilisation de valeurs vides problématiques<a class="anchor" aria-label="anchor" href="#null"></a>
</h3>
<p><strong>Exemple</strong> : utiliser -999 ou d’autres valeurs
numériques (ou zéro) pour représenter les données manquantes.</p>
<p><strong>Solutions</strong>:</p>
<p>Il existe plusieurs raisons pour lesquelles les valeurs vides sont
représentées différemment dans un jeu de données. Parfois, des valeurs
vides déroutantes sont automatiquement enregistrées à partir de
l’appareil de mesure. Si tel est le cas, vous ne pouvez pas faire
grand-chose, mais cela peut être résolu lors du nettoyage des données
avec un outil comme <a href="https://www.datacarpentry%20.org/OpenRefine-ecology-lesson/" class="external-link">OpenRefine</a>
avant l’analyse. D’autres fois, différentes valeurs vides sont utilisées
pour transmettre différentes raisons pour lesquelles les données ne sont
pas là. Il s’agit d’une information importante à capturer, mais elle
utilise en fait une seule colonne pour capturer deux informations. Comme
pour <a href="#formatting">l’utilisation du formatage pour transmettre
des informations</a>, il serait bon de créer une nouvelle colonne comme
“data_missing” et utiliser cette colonne pour capturer les différentes
raisons.</p>
<p>Quelle que soit la raison, c’est un problème si des données inconnues
ou manquantes sont enregistrées comme -999, 999 ou 0.</p>
<p>De nombreux programmes statistiques ne reconnaitront pas qu’ils sont
censés représenter des valeurs manquantes. La façon dont ces valeurs
sont interprétées dépendra du logiciel que vous utilisez pour analyser
vos données. Il est essentiel d’utiliser un indicateur clairement défini
et cohérent pour les valeurs vides.</p>
<p>Les blancs (pour la plupart des applications) et NA (pour R) sont de
bons choix. <span class="citation">@White</span> : 2013 explique les
bons choix pour indiquer des valeurs vides pour différentes applications
logicielles dans leur article :</p>
<figure><img src="../fig/3_white_table_1.jpg" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="formatting">Utilisation du formatage pour transmettre des informations<a class="anchor" aria-label="anchor" href="#formatting"></a>
</h3>
<p><strong>Exemple</strong> : mise en évidence des cellules, des lignes
ou des colonnes qui doivent être exclues d’une analyse, en laissant des
lignes vides pour indiquer séparations dans les données.</p>
<figure><img src="../fig/formatting.png" class="figure mx-auto d-block"></figure><p><strong>Solution</strong> : créer un nouveau champ pour coder les
données qui doivent être exclues.</p>
<figure><img src="../fig/good_formatting.png" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="utilisation-du-formatage-pour-rendre-la-feuille-de-calcul-jolie-formatting_pretty">Utilisation du formatage pour rendre la feuille de calcul jolie
{#formatting_pretty}<a class="anchor" aria-label="anchor" href="#utilisation-du-formatage-pour-rendre-la-feuille-de-calcul-jolie-formatting_pretty"></a>
</h3>
<p><strong>Exemple</strong> : fusion de cellules.</p>
<p><strong>Solution</strong> : Si vous ne faites pas attention, le
formatage d’une feuille de calcul pour qu’elle soit plus esthétique peut
compromettre la capacité de votre ordinateur à voir les associations
dans les données. Les cellules fusionnées rendront vos données
illisibles par les logiciels de statistiques. Pensez à restructurer vos
données de telle manière que vous n’aurez pas besoin de fusionner des
cellules pour organiser vos données.</p>
</div>
<div class="section level3">
<h3 id="units">Commentaires ou unités dans des cellules<a class="anchor" aria-label="anchor" href="#units"></a>
</h3>
<p>La plupart des logiciels d’analyse ne peuvent pas voir les
commentaires Excel ou LibreOffice, et serait embrouillé par les
commentaires placés dans vos cellules de données. Comme décrit ci-dessus
pour le formatage, créez un autre champ si vous devez ajouter des notes
aux cellules. De même, n’incluez pas d’unités dans les cellules :
idéalement, toutes les mesures que vous placez dans une colonne
devraient être dans la même unité , mais si pour une raison quelconque
ce n’est pas le cas, créez un autre champ et spécifient les unités dans
lesquelles se trouve la cellule.</p>
</div>
<div class="section level3">
<h3 id="info">Plusieurs informations dans une cellule<a class="anchor" aria-label="anchor" href="#info"></a>
</h3>
<p><strong>Exemple</strong> : Enregistrement des groupes sanguins ABO et
rhésus dans une seule cellule, tels que A+, B+, A-, …</p>
<p><strong>Solution</strong> : N’incluez pas plus d’une information dans
une cellule . Cela limitera les façons dont vous pourrez analyser vos
données. Si vous avez besoin de ces deux mesures, concevez votre feuille
de calcul pour inclure ces informations. Par exemple, incluez une
colonne pour le groupe ABO et une pour le rhésus.</p>
</div>
<div class="section level3">
<h3 id="utilisation-de-noms-de-champs-problématiques-field_name">Utilisation de noms de champs problématiques {#field_name}<a class="anchor" aria-label="anchor" href="#utilisation-de-noms-de-champs-probl%C3%A9matiques-field_name"></a>
</h3>
<p>Choisissez des noms de champs descriptifs, mais veillez à ne pas
inclure d’espaces, de chiffres ou de caractères spéciaux de quelque
nature que ce soit. Les espaces peuvent être mal interprétés par les
parseurs qui utilisent des espaces comme délimiteurs et certains
programmes n’aiment pas les noms de champs qui sont des chaînes de
caractères commençant par nombres.</p>
<p>Les tirets bas (<code>_</code>) sont une bonne alternative aux
espaces. Pensez à écrire les noms en <em>camel case</em> (comme ceci :
SampleFileName) pour améliorer la lisibilité de. N’oubliez pas que les
abréviations qui ont un sens pour le moment ne seront peut-être pas si
évidentes dans 6 mois, mais n’en faites pas trop avec des noms qui sont
excessivement longs. L’inclusion des unités dans les noms de champs
évite toute confusion et permet aux autres d’interpréter facilement vos
champs.</p>
<p><strong>Exemples</strong></p>
<table class="table">
<colgroup>
<col width="47%">
<col width="28%">
<col width="24%">
</colgroup>
<thead><tr class="header">
<th>Bon Nom</th>
<th>Bonne Alternative</th>
<th>Éviter</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Max_temp_C</td>
<td>MaxTemp</td>
<td>Temp Maximale (°C)</td>
</tr>
<tr class="even">
<td>Precipitations_mm</td>
<td>Precipitation</td>
<td>precmm</td>
</tr>
<tr class="odd">
<td>Croissance_annuelle_moyenne</td>
<td>CroissanceAnnuelleMoyenne</td>
<td>Croissance moyenne/an</td>
</tr>
<tr class="even">
<td>sexe</td>
<td>sexe</td>
<td>H/F</td>
</tr>
<tr class="odd">
<td>poids</td>
<td>poids</td>
<td>w.</td>
</tr>
<tr class="even">
<td>type_cellulaire</td>
<td>TypeCellulaire</td>
<td>Type cellulaire</td>
</tr>
<tr class="odd">
<td>Observation_01</td>
<td>premiere_observation</td>
<td>1er Obs.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="special">Utilisation de caractères spéciaux dans les données<a class="anchor" aria-label="anchor" href="#special"></a>
</h3>
<p><strong>Exemple</strong> : Vous traitez votre tableur comme un
traitement de texte lorsque vous rédigez des notes, par exemple en
copiant des données directement depuis Word ou d’autres
applications.</p>
<p><strong>Solution</strong> : Il s’agit d’une stratégie courante. Par
exemple, lorsqu’ils écrivent un texte plus long dans une cellule, les
utilisateurs incluent souvent des sauts de ligne, des tirets cadratins,
etc. dans leur feuille de calcul. De même, lors de la copie de données à
partir d’applications telles que Word, le formatage et les caractères
non standard (tels que les guillemets alignés à gauche et à droite et
les accents) sont inclus. Lors de l’exportation de ces données dans un
environnement de codage/statistique ou dans une base de données
relationnelle, des choses dangereuses peuvent se produire, comme des
lignes coupées en deux et des erreurs d’encodage générées.</p>
<p>La meilleure pratique consiste à éviter d’ajouter des caractères tels
que des nouvelles lignes, des tabulations et des accents. En d’autres
termes, traitez une cellule de texte comme s’il s’agissait d’un simple
formulaire web qui ne peut contenir que du texte et des espaces.</p>
</div>
<div class="section level3">
<h3 id="metadata">Inclusion de métadonnées dans le tableau de données<a class="anchor" aria-label="anchor" href="#metadata"></a>
</h3>
<p><strong>Exemple</strong> : Vous ajoutez une légende en haut ou en bas
de votre tableau de données expliquant la signification des colonnes,
les unités, les exceptions, etc.</p>
<p><strong>Solution</strong> : L’enregistrement des données sur vos
données (“métadonnées”) est essentiel. Il se peut que vous connaissiez
parfaitement votre jeu de données pendant que vous les collectez et les
analysez, mais il y a peu de chances que vous vous souveniez encore que
la variable “sglmemgp” signifie membre unique d’un groupe, par exemple,
ou de l’algorithme exact que vous avez utilisé pour transformer une
variable ou en créer une dérivée, après quelques mois, un an ou
plus.</p>
<p>De plus, il existe de nombreuses raisons pour lesquelles d’autres
personnes pourraient vouloir examiner ou utiliser vos données : pour
comprendre vos conclusions, pour vérifier vos conclusions, pour examiner
la publication que vous avez soumise, pour reproduire vos résultats,
pour concevoir une étude similaire, ou même archiver vos données pour y
accéder et réutiliser par d’autres. Bien que les données numériques
soient par définition lisibles par machine, comprendre leur
signification est un travail pour les êtres humains. L’importance de
documenter vos données pendant la phase de collecte et d’analyse de
votre recherche ne doit pas être sous-estimée, surtout si votre
recherche doit faire partie du dossier scientifique.</p>
<p>Cependant, les métadonnées ne doivent pas être contenues dans le
fichier de données lui-même. Contrairement à un tableau dans un article
ou un fichier supplémentaire, les métadonnées (sous forme de légendes)
ne doivent pas être incluses dans un fichier de données puisque ces
informations ne sont pas des données, et leur inclusion peut perturber
la façon dont les programmes informatiques interprètent votre fichier de
données. Les métadonnées doivent plutôt être stockées dans un fichier
distinct dans le même dossier que votre fichier de données, de
préférence au format texte brut avec un nom qui l’associe clairement à
votre fichier de données. Parce que les fichiers de métadonnées sont au
format texte libre, ils vous permettent également d’encoder des
commentaires, des unités, des informations sur la façon dont les valeurs
vides sont encodées, etc. qui sont importants pour documenter vos
données, mais peuvent perturber le formatage de votre fichier de
données.</p>
<p>De plus, les métadonnées au niveau d’un fichier ou de la base de
données décrivent comment les fichiers qui constituent le jeu de données
sont liés les uns aux autres ; dans quel format ils se trouvent ; et
s’ils remplacent ou sont remplacés par les fichiers précédents. Un
fichier readme.txt au niveau du dossier est la manière classique de
répertorier tous les fichiers et dossiers d’un projet.</p>
<p>(Texte sur les métadonnées adapté du cours en ligne Research Data <a href="https://datalib.edina.ac.uk/mantra" class="external-link">MANTRA</a> par EDINA et Data
Library, Université d’Édimbourg. MANTRA est sous licence Creative
Commons Attribution 4.0 International Licence.)</p>
</div>
</section><section><h2 class="section-heading" id="exporter-des-données">Exporter des données<a class="anchor" aria-label="anchor" href="#exporter-des-donn%C3%A9es"></a>
</h2>
<hr class="half-width">
<p><strong>Question</strong></p>
<ul>
<li>Comment pouvons-nous exporter des données à partir de feuilles de
calcul d’une manière utile pour les applications en aval ?</li>
</ul>
<p><strong>Objectifs</strong></p>
<ul>
<li>Stocker les données des feuilles de calcul dans des formats de
fichiers universels.</li>
<li>Exporter les données d’une feuille de calcul vers un fichier
CSV.</li>
</ul>
<p><strong>Points clés</strong></p>
<ul>
<li><p>Les données stockées dans des formats de feuilles de calcul
courants ne seront souvent pas lues correctement dans un logiciel
d’analyse de données, introduisant des erreurs dans vos
données.</p></li>
<li><p>L’exportation de données à partir de feuilles de calcul vers des
formats tels que CSV ou TSV les met dans un format qui peut être utilisé
de manière cohérente par la plupart des programmes.</p></li>
</ul>
<p>Le stockage des données avec lesquelles vous allez travailler pour
vos analyses dans le format de fichier Excel par défaut
(<code>*.xls</code> ou <code>*.xlsx</code> - selon la version d’Excel )
n’est pas une bonne idée. Pourquoi ?</p>
<ul>
<li><p>Parce qu’il s’agit d’un format propriétaire, et qu’il est
possible que dans le futur, la technologie n’existera pas (ou devienne
suffisamment rare) pour rendre l’ouverture du fichier peu pratique,
voire impossible.</p></li>
<li><p>D’autres logiciels de tableur peuvent ne pas être en mesure
d’ouvrir les fichiers enregistrés dans un format Excel
propriétaire.</p></li>
<li><p>Différentes versions d’Excel peuvent gérer les données
différemment, entraînant des incohérences. <a href="https://datacarpentry.org/spreadsheet-ecology-lesson/03-dates-as-data/index.html" class="external-link">Les
dates</a> sont un exemple bien documenté d’incohérences dans le stockage
de données.</p></li>
<li><p>Enfin, de plus en plus de revues et d’organismes de financement
vous demandent de déposer vos données dans un dépôt de données, et la
plupart d’entre eux n’acceptent pas le format Excel. Les données doivent
être dans l’un des formats discutés ci-dessous.</p></li>
<li><p>Les points ci-dessus s’appliquent également à d’autres formats
tels que les formats open data utilisés par LibreOffice/Open Office. Ces
formats ne sont pas statiques et ne sont pas analysés de la même manière
par différents logiciels.</p></li>
</ul>
<p>Le stockage des données dans un format universel, ouvert et statique
aidera à résoudre ce problème. Essayez les valeurs délimitées par des
tabulations (<em>tab separated values</em> ou TSV) ou délimitées par des
virgules (<em>comma separated values</em> ou CSV). Les fichiers CSV sont
des fichiers texte simples où les colonnes sont séparées par des
virgules, d’où <em>“comma separated values”</em> ou CSV. L’avantage d’un
fichier CSV par rapport à un Excel/SPSS/etc. est que nous pouvons ouvrir
et lire un fichier CSV en utilisant à peu près n’importe quel logiciel,
y compris des éditeurs de texte brut comme TextEdit ou NotePad. Les
données d’un fichier CSV peuvent également être facilement importées
dans d’autres formats et environnements, tels que SQLite et R. Nous ne
sommes pas limités à une certaine version d’un certain programme coûteux
lorsque nous travaillons avec des fichiers CSV, c’est donc un bon format
avec lequel travailler pour une interopérabilité et une durabilité
maximale. La plupart des tableurs peuvent facilement enregistrer au
format texte délimité comme CSV, bien qu’ils puissent vous avertir lors
de l’exportation du fichier.</p>
<p>Pour enregistrer un fichier que vous avez ouvert dans Excel au format
CSV :</p>
<ol style="list-style-type: decimal">
<li>Dans le menu supérieur, sélectionnez “Fichier” et “Enregistrer
sous”.</li>
<li>Dans le champ “Format”, dans la liste, sélectionnez “délimité par
des virgules” (<code>*.csv</code>).</li>
<li>Vérifiez le nom du fichier et l’emplacement où vous souhaitez
l’enregistrer et cliquez sur “Enregistrer”.</li>
</ol>
<p>Une remarque importante pour la rétrocompatibilité : vous pouvez
ouvrir les fichiers CSV dans Excel !</p>
<figure style="text-align: center"><img src="../fig/excel-to-csv.png" alt="Saving an Excel file to CSV." width="70%" class="figure mx-auto d-block"><figcaption>
Saving an Excel file to CSV.
</figcaption></figure><p><strong>Une note sur R et <code>xls</code></strong> : Il existe des
packages R qui peuvent lire les fichiers <code>xls</code> (ainsi que les
feuilles de calcul Google). Il est même possible d’accéder à différentes
feuilles de calcul des documents <code>xls</code>.</p>
<p><strong>Mais</strong></p>
<ul>
<li>certains d’entre eux ne fonctionnent que sous Windows.</li>
<li>cela équivaut à remplacer une exportation (simple mais manuelle)
vers <code>csv</code> par une complexité/dépendance supplémentaire dans
le code R d’analyse des données.</li>
<li>les meilleures pratiques en matière de formatage des données
s’appliquent toujours.</li>
<li>Y a-t-il vraiment une bonne raison pour laquelle <code>csv</code>
(ou un format similaire) n’est pas adéquat ?</li>
</ul>
<div class="section level3">
<h3 id="mises-en-garde-concernant-les-virgules">Mises en garde concernant les virgules<a class="anchor" aria-label="anchor" href="#mises-en-garde-concernant-les-virgules"></a>
</h3>
<p>Dans certains jeux de données, les valeurs des données elles-mêmes
peuvent inclure des virgules (,). Dans ce cas, le logiciel que vous
utilisez (y compris Excel) affichera très probablement de manière
incorrecte les données en colonnes. En effet, les virgules qui font
partie des valeurs de données seront interprétées comme des
délimiteurs.</p>
<p>Par exemple, nos données pourraient ressembler à ceci :</p>
<pre><code>species_id,genus,species,taxa
AB,Amphispiza,bilineata,Bird
AH,Ammospermophilus,harrisi,Rodent, not censused
AS,Ammodramus,savannarum,Bird
BA,Baiomys,taylori,Rodent</code></pre>
<p>Dans l’enregistrement “AH, Ammospermophilus, harrisi, Rodent, not
censused”, la valeur pour « taxons » comprend une virgule (“Rodent, not
censused”). Si nous essayons de lire ce qui précède dans Excel (ou un
autre tableur), nous obtiendrons quelque chose comme ceci :</p>
<figure style="text-align: center"><img src="../fig/csv-mistake.png" alt="The risks of having commas inside comma-separated data." width="80%" class="figure mx-auto d-block"><figcaption>
The risks of having commas inside comma-separated data.
</figcaption></figure><p>La valeur de « taxons » a été divisée en deux colonnes (au lieu
d’être placée dans une seule colonne “D”). Cela peut se propager à un
certain nombre d’autres erreurs. Par exemple, la colonne supplémentaire
sera interprétée comme une colonne avec de nombreuses valeurs manquantes
(et sans en-tête approprié). En plus de cela, la valeur dans la colonne
“D” pour l’enregistrement de la ligne 3 (donc celle où la valeur de
“taxons” contenait la virgule) est désormais incorrecte.</p>
<p>Si vous souhaitez stocker vos données au format <code>csv</code> et
vous attendez à ce que vos valeurs de données contiennent des virgules,
vous pouvez éviter le problème évoqué ci-dessus en mettant les valeurs
entre guillemets (““). En appliquant cette règle, nos données pourraient
ressembler à ceci :</p>
<pre><code>species_id,genus,species,taxa
"AB","Amphispiza","bilineata","Bird"
"AH","Ammospermophilus","harrisi","Rodent, not censused"
"AS","Ammodramus","savannarum","Bird"
"BA","Baiomys","taylori","Rodent"</code></pre>
<p>Désormais, l’ouverture de ce fichier en tant que “csv” dans Excel
n’entraînera pas une colonne supplémentaire, car Excel n’utilisera que
des virgules qui se trouvent en dehors des guillemets comme caractères
de délimitation.</p>
<p>Alternativement, si vous travaillez avec des données contenant des
virgules, vous devrez probablement utiliser un autre délimiteur lorsque
vous travaillerez dans une feuille de calcul <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. Dans ce cas, pensez à
utiliser des tabulations comme délimiteur et à travailler avec des
fichiers TSV. Les fichiers TSV peuvent être exportés à partir de
feuilles de calcul de la même manière que les fichiers CSV.</p>
<p>Si vous travaillez avec un jeu de données déjà existant dans lequel
les valeurs de données ne sont pas incluses entre “” mais qui ont à la
fois des virgules comme délimiteurs et faisant partie de valeurs de
données, vous êtes potentiellement confronté à un problème majeur avec
le nettoyage des données. Si le jeu de données que vous traitez contient
des centaines ou des milliers d’enregistrements, les nettoyer
manuellement (soit en supprimant les virgules des valeurs de données,
soit en mettant les valeurs entre guillemets - ““) non seulement va
prendre des heures et des heures, mais peut finir par vous amener à
introduire accidentellement de nombreuses erreurs.</p>
<p>Le nettoyage des jeux de données est l’un des problèmes majeurs dans
de nombreuses disciplines scientifiques. L’approche dépend presque
toujours du contexte particulier. Cependant, il est recommandé de
nettoyer les données de manière automatisée, par exemple en écrivant et
en exécutant un script. Des leçons Python et R vous donneront les bases
pour développer des compétences permettant de créer des scripts
pertinents.</p>
</div>
</section><section><h2 class="section-heading" id="résumé">Résumé<a class="anchor" aria-label="anchor" href="#r%C3%A9sum%C3%A9"></a>
</h2>
<hr class="half-width">
<figure style="text-align: center"><img src="../fig/analysis.png" alt="A typical data analysis workflow." class="figure mx-auto d-block"><figcaption>
A typical data analysis workflow.
</figcaption></figure><p>Un <em>workflow</em> typique d’analyse de données est illustré dans
la figure ci-dessus, où les données sont transformées, visualisées et
modélisées à plusieurs reprises. Cette itération est répétée plusieurs
fois jusqu’à ce que les données soient comprises. Cependant, dans de
nombreux cas réels, la majorité du temps est consacré au nettoyage et à
la préparation des données, plutôt qu’à leur analyse et à leur
compréhension.</p>
<p>Un <em>workflow</em> d’analyse de données agile, avec plusieurs
itérations rapides du cycle transformation/visualisation/modèle, n’est
possible que si les données sont formatées de manière prévisible et que
l’on peut raisonner sur les données sans avoir à les regarder et/ou à
les corriger.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Une bonne organisation des données est la base de tout projet de
recherche.</li>
</ul>
</div>
</div>
</div>
</section><div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Ceci est particulièrement pertinent dans les pays
européens où la virgule est utilisée comme séparateur décimal. Dans de
tels cas, le séparateur de valeurs par défaut dans un fichier csv sera
le point-virgule (;), ou les valeurs seront systématiquement entre
guillemets.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div></section><section id="aio-20-r-rstudio"><p>Content from <a href="20-r-rstudio.html">R et RStudio</a></p>
<hr>
<p>Last updated on 2025-05-05 |

        <a href="https://github.com/carpentries-incubator/bioc-intro/edit/main/episodes/20-r-rstudio.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Que sont R et RStudio ?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Décrire le principe des scripts RStudio, de la console, de
l’environnement et des panneaux de visualisation.</li>
<li>Organiser les fichiers et les répertoires d’une même série
d’analyses en projet R et comprendre le but du répertoire de
travail.</li>
<li>Utiliser l’interface d’aide intégrée de RStudio pour rechercher des
informations sur les fonctions R.</li>
<li>Montrer comment fournir suffisamment d’informations pour faciliter
le dépannage par la communauté des utilisateurs R.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<blockquote>
<p>Cet épisode est basé sur la leçon <em>Data Analysis and Visualisation
in R for Ecologists</em> de Data Carpentries.</p>
</blockquote>
<section><h2 class="section-heading" id="quest-ce-que-r-quest-ce-que-rstudio">Qu’est-ce que R ? Qu’est-ce que RStudio ?<a class="anchor" aria-label="anchor" href="#quest-ce-que-r-quest-ce-que-rstudio"></a>
</h2>
<hr class="half-width">
<p>Le terme <a href="https://www.r-project.org/" class="external-link">R</a> est utilisé pour
désigner le <em>langage de programmation</em>, l’<em>environnement de
calcul statistique</em> et <em>le logiciel</em> qui interprète les
scripts écrits à l’aide de celui-ci.</p>
<p><a href="https://rstudio.com" class="external-link">RStudio</a> est fréquemment utilisé
pour écrire des scripts R et pour interagir avec le logiciel R <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. R doit
être préalablement installé sur votre ordinateur pour que RStudio puisse
fonctionner correctement.</p>
<p>La RStudio IDE Cheat Sheet fournit davantage d’informations que ce
qui sera couvert dans cet épisode et peut être utile pour apprendre les
raccourcis clavier et découvrir de nouvelles fonctionnalités.</p>
</section><section><h2 class="section-heading" id="pourquoi-apprendre-r">Pourquoi apprendre R ?<a class="anchor" aria-label="anchor" href="#pourquoi-apprendre-r"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="r-utilise-peu-de-clic-bouton-ce-qui-est-une-bonne-chose">R utilise peu de “clic-bouton”, ce qui est une bonne chose<a class="anchor" aria-label="anchor" href="#r-utilise-peu-de-clic-bouton-ce-qui-est-une-bonne-chose"></a>
</h3>
<p>La courbe d’apprentissage en R est probablement plus complexe qu’avec
un autre logiciel. Par contre, les résultats des analyses effectuées ne
découleront pas d’une succession de commandes en clic-bouton (que l’on
risque d’oublier) mais d’une série de commandes écrites. L’énorme
avantage est que si vous souhaitez refaire votre analyse parce que vous
avez par exemple collecté davantage de données, vous n’aurez pas besoin
de vous rappeler sur quel bouton vous avez cliqué, ni dans quel ordre,
pour obtenir vos résultats ; il vous suffira de re-exécuter votre
script.</p>
<p>Travailler avec des scripts clarifie les étapes utilisées dans vos
analyses, et le code que vous écrivez peut être relu par quelqu’un
d’autre qui pourrait le commenter et repérer les erreurs.</p>
<p>Travailler avec des scripts vous force à bien comprendre ce que vous
faites. Vous aurez ainsi une meilleure compréhension des méthodes que
vous utilisez.</p>
</div>
<div class="section level3">
<h3 id="le-code-r-est-idéal-pour-la-reproductibilité">Le code R est idéal pour la reproductibilité<a class="anchor" aria-label="anchor" href="#le-code-r-est-id%C3%A9al-pour-la-reproductibilit%C3%A9"></a>
</h3>
<p>La reproductibilité signifie que quelqu’un d’autre (ou vous-même!)
peut obtenir les mêmes résultats à partir du même jeu de données en
utilisant le même code.</p>
<p>R s’intègre à d’autres outils pour générer des manuscrits ou des
rapports à partir de votre code. Si vous collectez davantage de données
ou si vous corrigez une erreur dans votre jeu de données, les chiffres
et les tests statistiques de votre rapport sont mis à jour
automatiquement.</p>
<p>De plus en plus de revues scientifiques et d’agences de financement
exigent que les analyses soient reproductibles. Savoir utiliser R sera
donc un avantage.</p>
</div>
<div class="section level3">
<h3 id="r-est-interdisciplinaire-et-extensible">R est interdisciplinaire et extensible<a class="anchor" aria-label="anchor" href="#r-est-interdisciplinaire-et-extensible"></a>
</h3>
<p>Plus de 10 000 <em>packages</em> <a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> (paquets) peuvent être installés pour
étendre les capacités de R. Les approches statistiques de nombreuses
disciplines scientifiques peuvent donc être combinées, ce qui permet
d’optimiser le cadre analytique nécessaire à l’analyse de vos données.
Par exemple, R propose des <em>packages</em> pour l’analyse d’images, de
données géographiques, de séries chronologiques, pour l’analyse de
génétique de population et bien plus encore.</p>
<figure style="text-align: center"><img src="../fig/cran.png" alt="Exponential increase of the number of packages available on [CRAN](https://cran.r-project.org/), the Comprehensive R Archive Network. From the R Journal, Volume 10/2, December 2018." class="figure mx-auto d-block"><figcaption>
Exponential increase of the number of packages available on <a href="https://cran.r-project.org/" class="external-link">CRAN</a>, the Comprehensive R Archive
Network. From the R Journal, Volume 10/2, December 2018.
</figcaption></figure>
</div>
<div class="section level3">
<h3 id="r-fonctionne-quel-que-soit-la-forme-et-la-taille-des-données">R fonctionne quel que soit la forme et la taille des données<a class="anchor" aria-label="anchor" href="#r-fonctionne-quel-que-soit-la-forme-et-la-taille-des-donn%C3%A9es"></a>
</h3>
<p>R fonctionne aussi bien sur des petits que sur des gros jeux de
données (pouvant contenir des millions de lignes).</p>
<p>R est conçu pour l’analyse des données. Ce langage utilise des
structures de données particulières ainsi que certains types de données
qui facilitent la gestion des données, comme les données manquantes ou
les variables catégorielles .</p>
<p>R peut se connecter à des feuilles de calcul, à des bases de données
et à de nombreux autres formats de données, sur votre ordinateur ou sur
le Web.</p>
</div>
<div class="section level3">
<h3 id="r-génère-des-graphiques-de-haute-qualité">R génère des graphiques de haute qualité<a class="anchor" aria-label="anchor" href="#r-g%C3%A9n%C3%A8re-des-graphiques-de-haute-qualit%C3%A9"></a>
</h3>
<p>Les fonctionnalités graphiques de R sont étendues. Elles permettent
d’ajuster n’importe quel aspect d’une figure pour transmettre
efficacement le message des données.</p>
</div>
<div class="section level3">
<h3 id="la-communauté-r-est-grande-et-accueillante">La communauté R est grande et accueillante<a class="anchor" aria-label="anchor" href="#la-communaut%C3%A9-r-est-grande-et-accueillante"></a>
</h3>
<p>Des milliers de personnes utilisent R quotidiennement. Beaucoup
d’entre elles sont prêtes à vous aider via des listes de diffusion et
des sites Web tels que Stack Overflow, ou sur le . Ces larges
communautés d’utilisateurs recouvrent des domaines spécialisés tels que
la bioinformatique. Un des sous-ensembles de la communauté R est <a href="https://bioconductor.org/" class="external-link">Bioconductor</a>, un projet
scientifique pour l’analyse et la compréhension de données biologiques .
Cet atelier a d’ailleurs été développé par des membres de la communauté
Bioconductor ; pour plus d’informations, veuillez consulter l’atelier
complémentaire <a href="https://carpentries-incubator.github.io/bioc-project/" class="external-link">“The
Bioconductor Project”</a>.</p>
</div>
<div class="section level3">
<h3 id="r-est-non-seulement-gratuit-mais-également-open-source-et-multiplateforme">R est non seulement gratuit, mais également open source et
multiplateforme<a class="anchor" aria-label="anchor" href="#r-est-non-seulement-gratuit-mais-%C3%A9galement-open-source-et-multiplateforme"></a>
</h3>
<p>N’importe qui peut inspecter le code source pour voir comment R
fonctionne. Grâce à cette transparence, il y a moins de risques
d’erreurs, et si vous (ou quelqu’un d’autre) en trouvez, vous pouvez
signaler et corriger des bugs.</p>
</div>
</section><section><h2 class="section-heading" id="rstudio">RStudio<a class="anchor" aria-label="anchor" href="#rstudio"></a>
</h2>
<hr class="half-width">
<p>Commençons par découvrir <a href="https://www.rstudio.com/" class="external-link">RStudio</a>, qui est un environnement de
développement intégré (IDE) permettant de travailler avec R.</p>
<p>Le produit open source RStudio IDE est gratuit sous la license .
L’IDE RStudio est également disponible avec une licence commerciale et
une assistance prioritaire par courrier électronique de Posit, Inc.</p>
<p>Nous utiliserons l’IDE RStudio pour écrire du code, parcourir les
fichiers sur notre ordinateur, inspecter les variables que nous allons
créer et visualiser les graphiques que nous allons générer. RStudio peut
également être utilisé pour d’autres choses (par exemple, le contrôle de
version, le développement de <em>packages</em>, l’écriture
d’applications <em>Shiny</em>) que nous n’aurons pas l’occasion
d’aborder pendant cet atelier.</p>
<figure style="text-align: center"><img src="../fig/rstudio-screenshot.png" alt="RStudio interface screenshot. Clockwise from top left: Source, Environment/History, Files/Plots/Packages/Help/Viewer, Console." width="100%" class="figure mx-auto d-block"><figcaption>
RStudio interface screenshot. Clockwise from top left: Source,
Environment/History, Files/Plots/Packages/Help/Viewer, Console.
</figcaption></figure><p>La fenêtre RStudio est divisée en 4 “Volets” :</p>
<ul>
<li>la <strong>Source</strong> de vos scripts et documents (en haut à
gauche, dans la mise en page par défaut )</li>
<li>votre <strong>Environnement/Historique</strong> (en haut à
droite),</li>
<li>vos <strong>Fichiers/Graphiques/Packages/Aide/Visionneuse</strong>
(en bas à droite), et</li>
<li>la R <strong>Console</strong> (en bas à gauche).</li>
</ul>
<p>L’emplacement de ces volets et leur contenu peuvent être
personnalisés (voir le menu ,
<code>Outils -&gt; Options globales -&gt; Disposition des volets</code>).</p>
<p>L’un des avantages de l’utilisation de RStudio est que toutes les
informations dont vous avez besoin pour écrire du code sont disponibles
dans la même fenêtre. De plus, avec de nombreux raccourcis, avec les
couleurs associées aux différents types de variables, et grâce à la
complétion automatique RStudio facilite l’écriture de code et le rend
moins sujet aux erreurs.</p>
</section><section><h2 class="section-heading" id="mise-en-place">Mise en place<a class="anchor" aria-label="anchor" href="#mise-en-place"></a>
</h2>
<hr class="half-width">
<p>Il est recommandé de conserver l’ensemble des données, d’analyses et
de textes relatifs à un même projet dans un seul et même dossier, appelé
<strong>répertoire de travail</strong>. Tous les scripts de ce dossier
peuvent alors utiliser des <strong>chemins relatifs</strong> qui
indiquent où se trouvent les différents fichiers dans le projet (par
opposition aux <strong>chemins absolus</strong>, qui pointent vers
l’endroit où se trouvent les fichiers sur un ordinateur spécifique).
Travailler de cette façon permet de pouvoir facilement déplacer le
projet sur votre ordinateur ou de le partager avec d’autres, sans vous
soucier de savoir si les scripts sous-jacents fonctionneront
toujours.</p>
<p>RStudio fournit un ensemble d’outils via son interface “Projets”, qui
non seulement crée un répertoire de travail pour vous, mais mémorise
également son emplacement (vous permettant d’y accéder rapidement). Ceci
permet aussi d’éventuellement conserver les paramètres personnalisés et
les fichiers ouverts pour faciliter la reprise du travail après une
pause. Suivez les étapes de création d’un “Projet R” pour ce tutoriel
ci-dessous.</p>
<ol style="list-style-type: decimal">
<li>Démarrez RStudio.</li>
<li>Dans le menu « Fichier », cliquez sur « Nouveau projet ». Choisissez
<code>Nouveau répertoire</code>, puis <code>Nouveau projet</code>.</li>
<li>Entrez un nom pour ce nouveau dossier (ou “répertoire”) et
choisissez un emplacement pratique pour celui-ci. Ce sera votre
<strong>répertoire de travail</strong> pour cette session (ou tout le
cours) (par exemple, <code>bioc-intro</code>).</li>
<li>Cliquez sur « Créer un projet ».</li>
<li>(Facultatif) Définissez les préférences sur « Jamais » pour
enregistrer l’espace de travail dans RStudio.</li>
</ol>
<p>Les préférences par défaut de RStudio fonctionnent généralement bien,
mais il vaut mieux éviter d’enregistrer l’espace de travail dans .RData,
surtout si vous travaillez avec des jeux de données volumineux. Pour
désactiver cela, allez dans Outils –&gt; « Options globales » et
sélectionnez l’option « Jamais » pour « Enregistrer l’espace de travail
dans .RData » à la sortie.</p>
<figure style="text-align: center"><img src="../fig/rstudio-preferences.png" alt="Set 'Save workspace to .RData on exit' to 'Never'" width="70%" class="figure mx-auto d-block"><figcaption>
Set ‘Save workspace to .RData on exit’ to ‘Never’
</figcaption></figure><p>Pour éviter les problèmes d’encodage des caractères entre Windows et
d’autres systèmes d’exploitation, nous allons utiliser UTF-8 par
défaut :</p>
<figure style="text-align: center"><img src="../fig/utf8.png" alt="Set the default text encoding to UTF-8 to save us headache in the coming future. (Figure from the link above)." width="70%" class="figure mx-auto d-block"><figcaption>
Set the default text encoding to UTF-8 to save us headache in the coming
future. (Figure from the link above).
</figcaption></figure><div class="section level3">
<h3 id="organiser-votre-répertoire-de-travail">Organiser votre répertoire de travail<a class="anchor" aria-label="anchor" href="#organiser-votre-r%C3%A9pertoire-de-travail"></a>
</h3>
<p>L’utilisation d’une structure de dossiers cohérente pour vos
différents projets vous aidera à être organisés et facilitera également
la recherche/le classement des éléments à l’avenir. Ce peut être
particulièrement utile lorsque vous avez plusieurs projets. En général,
vous pouvez créer des répertoires (dossiers) pour les
<strong>scripts</strong>, <strong>données</strong> et
<strong>documents</strong>.</p>
<ul>
<li>
<strong><code>data/</code></strong> Utilisez ce dossier pour stocker
vos données brutes et les données intermédiaires que vous pourriez avoir
besoin de créer lors d’une analyse particulière. Par souci de
transparence et pour pouvoir retracer l’origine et la <a href="https://en.wikipedia.org/wiki/Provenance" class="external-link">provenance</a> des
données, vous devez <em>toujours</em> conserver une copie (accessible)
des données brutes et effectuer le nettoyage et le prétraitement de vos
données autant que possible par programmation (c’est-à-dire avec
scripts, plutôt que manuellement) . Séparer les données brutes des
données traitées est également une bonne idée. Par exemple, vous
pourriez vouloir conserver les fichiers
<code>data/raw/tree_survey.plot1.txt</code> et <code>...plot2.txt</code>
dans un dossier séparé d’un fichier
<code>data/processed/tree.survey.csv</code> qui est, lui, un fichier
processé qui a été généré par le script
<code>scripts/01.preprocess.tree_survey.R</code>.</li>
<li>
<strong><code>documents/</code></strong> serait typiquement
l’endroit où conserver les plans, les brouillons, ou d’autre types de
textes.</li>
<li>
<strong><code>scripts/</code></strong> (ou <code>src</code>) serait
l’emplacement où sauvegarder les scripts correspondant différentes
analyses ou visualisations, et potentiellement un dossier séparé pour
vos fonctions (nous y reviendrons plus tard).</li>
</ul>
<p>Ces dossiers devraient être la structure de base de votre répertoire
de travail, auquel vous souhaiterez peut-être ajouter des répertoires ou
sous-répertoires supplémentaires en fonction des besoins de votre
projet. .</p>
<figure style="text-align: center"><img src="../fig/working-directory-structure.png" alt="Example of a working directory structure." width="100%" class="figure mx-auto d-block"><figcaption>
Example of a working directory structure.
</figcaption></figure><p>Pour ce cours, nous aurons besoin d’un dossier <code>data/</code>
pour stocker nos données brutes, nous utiliserons un dossier
<code>data_output/</code> lorsque nous exporterons des données sous
forme de fichiers CSV et nous créerons un dossier
<code>fig_output/</code> pour y mettre les figures que nous allons
enregistrer.</p>
<div id="défi-créer-la-structure-de-répertoires-de-votre-projet" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="défi-créer-la-structure-de-répertoires-de-votre-projet" class="callout-inner">
<h3 class="callout-title">Défi : créer la structure de répertoires de votre projet</h3>
<div class="callout-content">
<p>Sous l’onglet “Fichiers” à droite de l’écran, cliquez sur “Nouveau
dossier” et créez un dossier nommé “data” dans votre répertoire de
travail nouvellement créé (par exemple, “~/bioc-intro/data”). Vous
pouvez également taper <code>dir.create("data")</code> sur votre console
R. Répétez ces opérations pour créer un dossier
<code>data_output/</code> et un <code>fig_output</code>.</p>
</div>
</div>
</div>
<p>Nous allons conserver le script à la racine de notre répertoire de
travail car nous n’allons utiliser qu’un seul fichier et cela facilitera
les choses.</p>
<p>Votre répertoire de travail devrait maintenant ressembler à
ceci :</p>
<figure style="text-align: center"><img src="../fig/r-starting-how-it-should-look-like.png" alt="How it should look like at the beginning of this lesson" width="100%" class="figure mx-auto d-block"><figcaption>
How it should look like at the beginning of this lesson
</figcaption></figure><p>La <strong>gestion de projet</strong> s’applique évidemment aussi aux
projets de bioinformatique <a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>. William Noble (<span class="citation">@Noble:2009</span>) propose la structure de répertoires
suivante :</p>
<blockquote>
<p>Les noms de répertoires sont en gros caractères et les noms de
fichiers sont en caractères plus petits . Seul un sous-ensemble des
fichiers est affiché ici. Notez que les dates sont formatées en
<code>&lt;Année&gt;-&lt;mois&gt;-&lt;jour&gt;</code> afin qu’elles
puissent être triées par ordre chronologique. Le code source
<code>src/ms-analysis.c</code> est compilé pour créer
<code>bin/ms-analysis</code> et est documenté dans
<code>doc/ms-analysis.html</code>. Les fichiers <code>README</code> dans
les répertoires de données précisent qui a téléchargé les données, à
partir de quelle URL, et à quelle date . Le script
<code>results/2009-01-15/runall</code> génère automatiquement les trois
sous-répertoires split1, split2 et split3, correspondant à des
validation croisées de 3 sous-ensembles. Le script
<code>bin/parse-sqt.py</code> est appelé par le script
<code>runall</code> .</p>
</blockquote>
<figure style="text-align: center"><img src="../fig/noble-bioinfo-project.png" alt="Directory structure for a sample bioinformatics project." width="100%" class="figure mx-auto d-block"><figcaption>
Directory structure for a sample bioinformatics project.
</figcaption></figure><p>Un répertoire de projet bien défini et bien documenté doit permettre
à quelqu’un qui n’est pas familier avec le projet <a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> de :</p>
<ol style="list-style-type: decimal">
<li><p>comprendre en quoi consiste le projet, quelles données sont
disponibles, quelles analyses ont été effectuées et quels résultats ont
été produits</p></li>
<li><p>et surtout de répéter l’analyse à nouveau - avec de nouvelles
données ou en modifiant certains paramètres d’analyse .</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="le-répertoire-de-travail">Le répertoire de travail<a class="anchor" aria-label="anchor" href="#le-r%C3%A9pertoire-de-travail"></a>
</h3>
<p>Le répertoire de travail est un concept important à comprendre. C’est
l’endroit à partir duquel R recherchera et enregistrera les fichiers.
Lorsque vous écrivez du code pour votre projet, il doit faire référence
à des fichiers en relation avec la racine de votre répertoire de travail
et n’a besoin que de fichiers au sein de cette structure .</p>
<p>L’utilisation de projets RStudio facilite cela et garantit que votre
répertoire de travail est correctement défini. Si vous avez besoin de le
vérifier, vous pouvez utiliser <code>getwd()</code>. Si par hasard votre
répertoire de travail n’est pas celui qu’il devrait être, vous pouvez le
changer dans RStudio en y accédant via le navigateur de fichiers, puis
en cliquant sur l’icône representant un engrenage bleu, et sélectionner
<code>Définir comme répertoire de travail</code>. Vous pouvez également
utiliser <code>setwd("/path/to/working/directory")</code> pour
réinitialiser votre répertoire de travail. Cependant, vos scripts ne
doivent pas inclure cette ligne car elle échouera sur l’ordinateur de
quelqu’un d’autre.</p>
<p><strong>Exemple</strong></p>
<p>Le schéma ci-dessous représente le répertoire de travail
<code>bioc-intro</code> avec les sous-répertoires <code>data</code> et
<code>fig_output</code>, et 2 fichiers dans ce dernier :</p>
<pre><code>bioc-intro/data/
          /fig_output/fig1.pdf
          /fig_output/fig2.png</code></pre>
<p>Si on était dans le répertoire de travail, on pourrait faire
référence au fichier <code>fig1.pdf</code> en utilisant le chemin
relatif <code>bioc-intro/fig_output/fig1.pdf</code> ou le chemin absolu
<code>/home/user/bioc-intro/fig_output/fig1.pdf</code>.</p>
<p>Si nous étions dans le répertoire <code>data</code>, nous
utiliserions le chemin relatif <code>../fig_output/fig1.pdf</code> ou le
même chemin absolu
<code>/home/user/bioc-intro /fig_output/fig1.pdf</code>.</p>
</div>
</section><section><h2 class="section-heading" id="interagir-avec-r">Interagir avec R<a class="anchor" aria-label="anchor" href="#interagir-avec-r"></a>
</h2>
<hr class="half-width">
<p>La base de la programmation est que nous écrivons les instructions
que l’ordinateur doit faire, puis nous demandons à l’ordinateur de les
suivre . Nous écrivons, ou <em>codons</em>, des instructions dans R car
c’est un langage commun que l’ordinateur et nous pouvons comprendre.
Nous appelons les instructions <em>commandes</em> et nous demandons à
l’ordinateur de les suivre en <em>exécutant</em> (ou en
<em>runnant</em>) ces commandes.</p>
<p>Il existe deux manières principales d’interagir avec R : en utilisant
la <strong>console</strong> ou en utilisant des <strong>scripts</strong>
(fichiers texte brut contenant votre code). Le volet de la console (dans
RStudio, le panneau inférieur gauche) est l’endroit où les commandes
écrites en langage R peuvent être saisies et exécutées immédiatement par
l’ordinateur. C’est également là que les résultats seront affichés pour
les commandes exécutées. Vous pouvez taper des commandes directement
dans la console et appuyer sur « Entrée » pour exécuter ces commandes ,
mais elles seront oubliées lorsque vous fermerez la session.</p>
<p>Parce que nous voulons que notre code et notre flux de travail soient
reproductibles, il est préférable de taper les commandes souhaitées dans
l’éditeur de script et d’enregistrer le script . De cette façon, il
existe un enregistrement complet de ce que nous avons fait, et n’importe
qui (y compris nous-même !) pourra reproduire facilement les résultats
sur n’importe quel ordinateur. Notez cependant que le simple fait de
taper les commandes dans le script ne les <em>exécute</em> pas
automatiquement - elles doivent quand même être envoyées à la console
pour exécution.</p>
<p>RStudio vous permet d’exécuter des commandes directement depuis
l’éditeur de script en utilisant le raccourci <code>Ctrl</code> +
<code>Entrée</code> (sur Mac, <code>Cmd</code> + <code>Return</code>
fonctionnera également). La commande sur la ligne actuelle du script
(indiquée par le curseur) ou toutes les commandes dans le texte qui sont
sélectionnées seront envoyées à la console et exécutées lorsque vous
appuyez sur <code>Ctrl</code> + <code>Entrer</code>. Vous pouvez trouver
d’autres raccourcis clavier dans cette aide-mémoire RStudio sur l’IDE
RStudio .</p>
<p>Lors de votre analyse, il est possible qu’à un moment donné vous
souhaitiez vérifier le contenu d’une variable ou la structure d’un
objet, sans nécessairement vouloir sauvergarder cette commande dans
votre script. Vous pouvez taper ces commandes et les exécuter
directement dans la console. RStudio fournit les raccourcis
<code>Ctrl</code> + <code>1</code> et <code>Ctrl</code> + <code>2</code>
vous permettant de passer entre le script et les volets de la console
.</p>
<p>Si R est prêt à accepter les commandes, la console R affiche une
invite ‘&gt;’. S’il reçoit une commande (en tappant, en faisant un
copié-collé ou en l’envoyant à partir de l’éditeur de script avec
<code>Ctrl</code> + <code>Entrer</code>), R va essayer de l’exécuter, et
lorsqu’il sera prêt, R affichera les résultats et une nouvelle invite
‘&gt;’ apparaîtra.</p>
<p>Si R attend toujours que vous saisissiez plus de données parce que ce
n’est pas encore terminé, la console affichera une invite « + ». Cela
signifie que vous n’avez pas fini de saisir une commande complète. Ceci
peut arriver s’il manque par exemple une parenthèse ou un guillemet.
Lorsque cela se produit et que vous pensez avoir fini de taper votre
commande, cliquez dans la fenêtre de la console et appuyez sur « Échap
» ; cela annulera la commande incomplète et vous ramènera à l’invite
‘&gt;’.</p>
</section><section><h2 class="section-heading" id="comment-en-savoir-plus-pendant-et-après-le-cours">Comment en savoir plus pendant et après le cours ?<a class="anchor" aria-label="anchor" href="#comment-en-savoir-plus-pendant-et-apr%C3%A8s-le-cours"></a>
</h2>
<hr class="half-width">
<p>Le matériel que nous aborderons au cours de ce cours vous donnera un
premier aperçu de la façon dont vous pouvez utiliser R pour analyser vos
données. Cependant, vous devrez en apprendre davantage pour effectuer
des opérations avancées telles que nettoyer votre jeu de données,
utiliser des méthodes statistiques, ou créer de superbes graphiques<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>. La
meilleure façon de devenir efficace et compétent en R, comme avec tout
autre outil, est de l’utiliser pour répondre à de vraies questions de
recherche. En tant que débutant, il peut sembler intimidant de devoir
écrire un script à partir de zéro, et étant donné que de nombreuses
personnes rendent leur code disponible en ligne, modifiant le code
existant pour répondre à vos objectifs. cela pourrait vous permettre de
démarrer plus facilement.</p>
<figure><img src="../fig/kitten-try-things.jpg" width="400px" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="cherche-de-laide">Cherche de l’aide<a class="anchor" aria-label="anchor" href="#cherche-de-laide"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="utilisez-linterface-daide-intégrée-de-rstudio-pour-rechercher-plus-dinformations-sur-les-fonctions-r-">Utilisez l’interface d’aide intégrée de RStudio pour rechercher plus
d’informations sur les fonctions R.<a class="anchor" aria-label="anchor" href="#utilisez-linterface-daide-int%C3%A9gr%C3%A9e-de-rstudio-pour-rechercher-plus-dinformations-sur-les-fonctions-r-"></a>
</h3>
<figure style="text-align: center"><img src="../fig/rstudiohelp.png" alt="RStudio help interface." width="70%" class="figure mx-auto d-block"><figcaption>
RStudio help interface.
</figcaption></figure><p>L’un des moyens les plus rapides d’obtenir de l’aide consiste à
utiliser l’interface d’aide RStudio . Ce panneau par défaut se trouve
dans le panneau inférieur droit de RStudio. Comme le montre la capture
d’écran, en tapant le mot “Mean”, RStudio essaie également de donner un
certain nombre de suggestions qui pourraient vous intéresser . La
description s’affiche alors dans la fenêtre d’affichage .</p>
</div>
<div class="section level3">
<h3 id="je-connais-le-nom-de-la-fonction-que-je-souhaite-utiliser-mais-je-ne-sais-pas-comment-lutiliser">Je connais le nom de la fonction que je souhaite utiliser, mais je
ne sais pas comment l’utiliser<a class="anchor" aria-label="anchor" href="#je-connais-le-nom-de-la-fonction-que-je-souhaite-utiliser-mais-je-ne-sais-pas-comment-lutiliser"></a>
</h3>
<p>Si vous avez besoin d’aide à propos d’une fonction spécifique, par
exemple <code>barplot()</code>, vous pouvez taper :</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">barplot</span></span></code></pre>
</div>
<p>Si vous avez juste besoin de vous rappeler les noms des arguments,
vous pouvez utiliser :</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">args</span><span class="op">(</span><span class="va">lm</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="je-veux-utiliser-une-fonction-qui-fait-x-il-doit-y-avoir-une-fonction-pour-ça-mais-je-ne-sais-pas-laquelle">Je veux utiliser une fonction qui fait X, il doit y avoir une
fonction pour ça mais je ne sais pas laquelle…<a class="anchor" aria-label="anchor" href="#je-veux-utiliser-une-fonction-qui-fait-x-il-doit-y-avoir-une-fonction-pour-%C3%A7a-mais-je-ne-sais-pas-laquelle"></a>
</h3>
<p>Si vous recherchez une fonction pour effectuer une tâche
particulière, vous pouvez utiliser la fonction
<code>help.search()</code>, qui est appelée par le double point
d’interrogation <code>??</code>. Cependant, cela ne recherche dans les
packages installés que les pages d’aide avec une correspondance avec
votre demande de recherche.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="op">?</span><span class="va">kruskal</span></span></code></pre>
</div>
<p>Si vous ne trouvez pas ce que vous cherchez, vous pouvez utiliser le
site Web <a href="https://www.rdocumentation.org" class="external-link">rdocumentation.org</a>
qui recherche dans les fichiers d’aide de tous les packages
disponibles.</p>
<p>Enfin, une recherche générique sur Google ou sur Internet “R
&lt;task&gt;” vous enverra souvent soit à la documentation du package
appropriée, soit à un forum utile où quelqu’un d’autre a déjà posé votre
question.</p>
</div>
<div class="section level3">
<h3 id="je-suis-coincé-je-reçois-un-message-derreur-que-je-ne-comprends-pas">Je suis coincé… Je reçois un message d’erreur que je ne comprends
pas<a class="anchor" aria-label="anchor" href="#je-suis-coinc%C3%A9-je-re%C3%A7ois-un-message-derreur-que-je-ne-comprends-pas"></a>
</h3>
<p>Commencez par rechercher le message d’erreur sur Google. Cela ne
fonctionne cependant pas toujours très bien car souvent, les
développeurs de packages s’appuient sur la détection d’erreurs fournie
par R. Vous vous retrouvez avec des messages d’erreur généraux qui
pourraient ne pas être très utiles pour diagnostiquer un problème (par
exemple “indice hors limites”). Si le message est très générique, vous
pouvez également inclure le nom de la fonction ou du package que vous
utilisez dans votre requête.</p>
<p>Cependant, vous devriez vérifier Stack Overflow. Recherchez en
utilisant la balise <code>[r]</code>. La plupart des questions ont déjà
reçu une réponse, mais le défi consiste à utiliser les bons mots clés
dans la recherche pour trouver les réponses :</p>
<p><a href="https://stackoverflow.com/questions/tagged/r" class="external-link">http://stackoverflow.com/questions/tagged/r</a></p>
<p>L’<a href="https://cran.r-project.org/doc/manuals/R-intro.pdf" class="external-link">Introduction à
R</a> peut sembler compliquée pour les personnes ayant peu d’expérience
en programmation, mais c’est une bonne base pour tenter comprendre les
fondements du langage R.</p>
<p>La <a href="https://cran.r-project.org/doc/FAQ/R-FAQ.html" class="external-link">section
FAQ R</a> est également assez technique mais elle est riche et regorge
d’informations utiles.</p>
</div>
<div class="section level3">
<h3 id="demander-de-laide">Demander de l’aide<a class="anchor" aria-label="anchor" href="#demander-de-laide"></a>
</h3>
<p>La clé pour recevoir de l’aide de quelqu’un est qu’il comprenne
rapidement votre problème. Vous devez faire en sorte qu’il soit aussi
simple que possible d’identifier où pourrait se situer le problème.</p>
<p>Essayez d’utiliser les mots corrects pour décrire votre problème. Par
exemple, un package n’est pas la même chose qu’une librairie. La plupart
des gens comprendront ce que vous vouliez dire, mais d’autres ont des
sentiments très forts à propos de la différence de sens. Le point clé
est que cela peut rendre les choses déroutantes pour les personnes qui
essaient de vous aider. Soyez aussi précis que possible lorsque vous
décrivez votre problème.</p>
<p>Si possible, essayez de réduire ce qui ne fonctionne pas à un
<em>exemple simple et reproductible</em>. Si vous pouvez reproduire le
problème en utilisant une petite table de données au lieu de celui de 50
000 lignes et 10 000 colonnes, fournissez le petit avec la description
de votre problème. Essayez aussi de généraliser ce que vous faites afin
que les personnes qui ne connaissent pas grand chose à votre domaine
puissent également comprendre la question. Par exemple, au lieu
d’utiliser un sous-ensemble de votre ensemble de données réel, créez un
petit (3 colonnes, 5 lignes) générique. Pour plus d’informations sur la
façon d’écrire un exemple reproductible, voir cet article de Hadley
Wickham.</p>
<p>Pour partager un objet avec quelqu’un d’autre, s’il est relativement
petit, vous pouvez utiliser la fonction <code>dput()</code>. Elle
produira du code R qui pourra être utilisé pour recréer exactement le
même objet que celui en mémoire :</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## iris is an example data frame that comes with R and head() is a</span></span>
<span><span class="co">## function that returns the first part of the data frame</span></span>
<span><span class="fu">dput</span><span class="op">(</span><span class="fu">head</span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fu">structure</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>Sepal.Length <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.9</span>, <span class="fl">4.7</span>, <span class="fl">4.6</span>, <span class="fl">5</span>, <span class="fl">5.4</span><span class="op">)</span>,</span>
<span>    Sepal.Width <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">3.5</span>, <span class="fl">3</span>, <span class="fl">3.2</span>, <span class="fl">3.1</span>, <span class="fl">3.6</span>, <span class="fl">3.9</span><span class="op">)</span>, Petal.Length <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1.4</span>,</span>
<span>    <span class="fl">1.4</span>, <span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">1.4</span>, <span class="fl">1.7</span><span class="op">)</span>, Petal.Width <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>,</span>
<span>    <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span><span class="op">)</span>, Species <span class="op">=</span> <span class="fu">structure</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1L</span>, <span class="fl">1L</span>, <span class="fl">1L</span>, <span class="fl">1L</span>,</span>
<span>    <span class="fl">1L</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"setosa"</span>, <span class="st">"versicolor"</span>, <span class="st">"virginica"</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"factor"</span><span class="op">)</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="cn">NA</span>,</span>
<span><span class="fl">6L</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"data.frame"</span><span class="op">)</span></span></code></pre>
</div>
<p>Si l’objet est plus grand, vous pouvez fournir le fichier brut
(c’est-à-dire votre fichier CSV) avec votre script jusqu’au point
d’erreur (après avoir supprimé tout ce qui n’est pas pertinent pour
votre problème). Alternativement, si votre question n’est pas liée à un
jeu de données en particulier, vous pouvez enregistrer n’importe quel
objet R dans un fichier[^export] :</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">saveRDS</span><span class="op">(</span><span class="va">iris</span>, file<span class="op">=</span><span class="st">"/tmp/iris.rds"</span><span class="op">)</span></span></code></pre>
</div>
<p>Le contenu de ce fichier ne sera cependant pas lisible directement et
ne pourra pas être publié directement sur Stack Overflow. Il pourra par
contre être envoyé à quelqu’un par email qui pourra le lire avec la
commande <code>readRDS()</code> (dans ce cas-ci, le fichier téléchargé
est censé se trouver dans un dossier <code>Téléchargements</code> du
répertoire personnel de l’utilisateur) :</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">some_data</span> <span class="op">&lt;-</span> <span class="fu">readRDS</span><span class="op">(</span>file<span class="op">=</span><span class="st">"~/Downloads/iris.rds"</span><span class="op">)</span></span></code></pre>
</div>
<p>Dernier point, mais non des moindres, <strong>incluez toujours le
résultat de la fonction <code>sessionInfo()</code></strong> car elle
fournit des informations essentielles concernant votre plate-forme, les
versions de R et des <em>packages</em> que vous avez utilisé ainsi que
d’autres informations qui peuvent être importantes pour comprendre votre
problème.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sessionInfo</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>R version 4.5.0 (2025-04-11)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 24.04.2 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0  LAPACK version 3.12.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C

time zone: Asia/Tokyo
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.5.0 tools_4.5.0    knitr_1.50     xfun_0.52      evaluate_1.0.3</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="où-demander-de-laide">Où demander de l’aide ?<a class="anchor" aria-label="anchor" href="#o%C3%B9-demander-de-laide"></a>
</h3>
<ul>
<li>La personne assise à côté de vous pendant le cours. N’hésitez pas à
à comparer vos réponses, et demander de l’aide.</li>
<li>De même si un gentil collègue a plus d’expérience que vous,
n’hésitez pas à le solliciter, il pourra peut-être vous aider.</li>
<li>
<a href="https://stackoverflow.com/questions/tagged/r" class="external-link">Stack
Overflow</a> : si votre question n’a pas reçu de réponse auparavant et
est bien conçue, il y a de fortes chances que vous obteniez un réponse
en moins de 5 minutes. N’oubliez pas de suivre leurs directives sur la
manière de poser une bonne question.</li>
<li>La liste de diffusion R-help : elle est lue par un grand nombre de
personnes (dont la plupart des l’équipe principale de R), beaucoup de
gens y publient des messages, mais le ton peut être assez sec, et il
n’est pas toujours très accueillant pour les nouveaux utilisateurs. Si
votre question est valide, vous avez de bonnes chances d’obtenir une
réponse très rapidement, mais ne vous attendez pas à ce que celle-ci
arrive avec formules de politesse. Ici plus qu’ailleurs, veillez à
utiliser un vocabulaire précis (sinon vous pourriez obtenir une réponse
signalant l’utilisation de mots incorrects plutôt que la réponse
attendue). Vous aurez également plus de succès si votre question
concerne une fonction de base plutôt qu’un <em>package</em>
spécifique.</li>
<li>Si votre question concerne un <em>package</em> spécifique, vérifiez
s’il existe une liste de diffusion dédiée à celui-ci. Habituellement, il
est inclus dans le fichier DESCRIPTION du package et est accessible en
utilisant <code>packageDescription("name-of-package")</code>. Vous
pouvez également essayer d’envoyer un e-mail directement à l’auteur du
package ou d’ouvrir un ticket sur le référentiel de code (par exemple,
GitHub).</li>
<li>Il existe également quelques listes de diffusion thématiques
(Système d’information géographique SIG, phylogénétique, etc…), la liste
complète se trouve <a href="https://www.r-project.org/%20mail.html" class="external-link">ici</a>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="autres-ressources">Autres ressources<a class="anchor" aria-label="anchor" href="#autres-ressources"></a>
</h3>
<ul>
<li><p>Le <a href="https://www.r-project.org/posting-guide.html" class="external-link">Guide
de publication</a> pour les listes de diffusion R.</p></li>
<li>
<p>Comment demander de l’aide R</p>
<p>directives utiles.</p>
</li>
<li><p>Ce billet de blog de Jon Skeet contient des conseils relativement
complets sur la façon de poser des questions liées à la
programmation.</p></li>
<li><p>Le package <a href="https://cran.rstudio.com/web/packages/reprex/" class="external-link">reprex</a> est très
utile pour créer des exemples reproductibles lorsque vous demandez de
l’aide. Le lien « Comment poser des questions pour qu’elles obtiennent
de réponses » de la communauté rOpenSci (lien Github et enregistrement
vidéo ) comprend une présentation du package reprex et de sa
philosophie.</p></li>
</ul>
</div>
</section><section><h2 class="section-heading" id="packages-r">
<em>Packages</em> R<a class="anchor" aria-label="anchor" href="#packages-r"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="chargement-des-paquets">Chargement des paquets<a class="anchor" aria-label="anchor" href="#chargement-des-paquets"></a>
</h3>
<p>Comme nous l’avons vu plus haut, les <em>packages</em> R jouent un
rôle essentiel dans R. Pour bénéficier des fonctionnalités d’un
<em>package</em>, il faut qu’il soit préalablement installé et chargé.
Cela se fait avec la fonction <code>library()</code>. Ci-dessous, nous
chargeons <code>ggplot2</code>.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="installation-des-packages">Installation des packages<a class="anchor" aria-label="anchor" href="#installation-des-packages"></a>
</h3>
<p>The <em>Comprehensive R Archive Network</em> (CRAN) heberge de
nombreux <em>packages</em>. Ceux qui sont disponibles sur CRAN peuvent
être installés avec la fonction <code>install.packages()</code>.
Ci-dessous, nous installons par exemple le <em>package</em>
<code>dplyr</code> que nous découvrirons plus tard.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"dplyr"</span><span class="op">)</span></span></code></pre>
</div>
<p>Cette commande installera le <em>package</em> <code>dplyr</code>
ainsi que toutes ses dépendances, c’est à dire tous les
<em>packages</em> sur lesquels il s’appuie pour fonctionner.</p>
<p>Un autre source majeure de packages R est gérée par Bioconductor. <a href="https://bioconductor.org/packages/release/BiocViews.html#___Software" class="external-link">Packages
Bioconductor</a> sont gérés et installés à l’aide d’un package dédié, à
savoir <code>BiocManager</code>, qui peut être installé à partir de CRAN
avec</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span></code></pre>
</div>
<p>Des packages spécifiques tels que <code>SummarizedExperiment</code>
(nous l’utiliserons plus tard), <code>DESeq2</code> (pour l’analyse
RNA-Seq) et tout autre <em>package</em> Bioconductor ou CRAN peuvent
ensuite être installés avec <code>BiocManager::install</code>.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"SummarizedExperiment"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"DESeq2"</span><span class="op">)</span></span></code></pre>
</div>
<p>Par défaut, <code>BiocManager::install()</code>examinera également
tous vos packages installés et vérifiera si des versions plus récentes
sont disponibles. S’il y en a, il vous les montrera et vous demandera si
vous souhaitez « Mettre à jour tout/certains/aucun ? . Bien que vous
deviez vous efforcer de disposer des dernières versions des
<em>packages</em>, en pratique, nous vous recommandons de ne les mettre
à jour que lors d’une nouvelle session R avant le chargement des
<em>packages</em>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Commencez à utiliser R et RStudio</li>
</ul>
</div>
</div>
</div>
</div>
</section><div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Au lieu d’utiliser R directement en ligne de commande à
partir de la console . Il existe d’autres logiciels d’interface avec R,
mais RStudio est particulièrement bien adapté aux débutants tout en
proposant de nombreuses fonctionnalités très avancées.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Ce sont des modules complémentaires qui confèrent à R de
nouvelles fonctionnalités, telles que l’analyse de données
bioinformatiques.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Dans ce cours, nous considérons la bioinformatique comme
une science des données appliquée aux données biologiques ou
bio-médicales.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Cette personne pourrait être, et sera très probablement
vous-même, quelques mois ou années après que les analyses aient été
effectuées.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Nous présenterons ici la plupart d’entre eux (sauf les
statistiques), mais nous ne parviendrons à explorer qu’une infime partie
de ce qu’il est possible de faire avec R.<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div></section><section id="aio-23-starting-with-r"><p>Content from <a href="23-starting-with-r.html">Introduction à R</a></p>
<hr>
<p>Last updated on 2025-05-05 |

        <a href="https://github.com/carpentries-incubator/bioc-intro/edit/main/episodes/23-starting-with-r.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 120 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Premières commandes dans R</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Définir les termes suivants relatifs à R : objet, affectation,
appel, fonction, arguments, options.</li>
<li>Attribuer des valeurs aux objets dans R.</li>
<li>Apprendre à <em>nommer</em> des objets.</li>
<li>Utiliser des commentaires pour informer le script.</li>
<li>Résoudre des opérations arithmétiques simples dans R.</li>
<li>Appeler des fonctions et utiliser des arguments pour modifier leurs
options par défaut.</li>
<li>Inspecter le contenu des vecteurs et manipulez leur contenu.</li>
<li>Extraire un sous-ensemble ou des valeurs à partir de vecteurs.</li>
<li>Analyser des vecteurs contenant des données manquantes.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<blockquote>
<p>Cet épisode est basé sur le cours <em>Data Analysis and Visualization
in R for Ecologists</em> (<em>Analyse de données et Visualisation en R
pour les écologistes</em>) de Data Carpentries.</p>
</blockquote>
<section><h2 class="section-heading" id="créer-des-objets-dans-r">Créer des objets dans R<a class="anchor" aria-label="anchor" href="#cr%C3%A9er-des-objets-dans-r"></a>
</h2>
<hr class="half-width">
<p>En R, vous pouvez obtenir des résultats simplement en tapant des
opérations mathématiques directement dans la console :</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">3</span> <span class="op">+</span> <span class="fl">5</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 8</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">12</span> <span class="op">/</span> <span class="fl">7</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.714286</code></pre>
</div>
<p>Cependant, pour faire des analyses utiles et intéressantes, il est
avantageux d’attribuer des <em>valeurs</em> à des <em>objets</em>. Pour
créer un objet, nous devons lui donner un nom suivi de l’opérateur
d’assignation `←</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">poids_kg</span> <span class="op">&lt;-</span> <span class="fl">55</span></span></code></pre>
</div>
<p><code>&lt;-</code> est l’opérateur d’assignation (affectation). Il
attribue des valeurs à droite aux objets à gauche. Ainsi, après avoir
exécuté <code>x &lt;- 3</code>, la valeur de <code>x</code> est
<code>3</code>. La flèche peut être lue comme 3 <strong>entre
dans</strong> <code>x</code>. Pour des raisons historiques, vous pouvez
également utiliser <code>=</code> pour les assignations, mais pas dans
tous les contextes. En raison de <a href="https://blog.revolutionanalytics.com/2008/12/use-equals-or-arrow-for-assignment.html" class="external-link">légères
différences</a> dans la syntaxe, une bonne pratique est de toujours
utiliser <code>&lt;-</code> pour les assignations.</p>
<p>Dans RStudio, sur un PC, taper <kbd>Alt</kbd> + <kbd>-</kbd> (appuyer
sur <kbd>Alt</kbd> en même temps que la touche <kbd>-</kbd> ) écrira
<code>&lt;-</code> en une seule frappe, tandis que taper
<kbd>Option</kbd> + <kbd>-</kbd> (appuyer sur <kbd>Option</kbd> en même
temps que la touche <kbd>-</kbd> ) fera de même sur un Mac.</p>
<div class="section level3">
<h3 id="nommer-les-variables">Nommer les variables<a class="anchor" aria-label="anchor" href="#nommer-les-variables"></a>
</h3>
<p>Les objets peuvent avoir n’importe quel nom tel que « x », «
current_temperature » ou « subject_id ». Il est souhaitable que les noms
de vos objets soient explicites et pas trop longs. Ils ne peuvent pas
commencer par un nombre (<code>2x</code> n’est pas un nom valide, mais
<code>x2</code> l’est). R est sensible à la casse (par exemple,
<code>weight_kg</code> est différent de <code>Weight_kg</code>).
Certains noms ne peuvent pas être utilisés car ils sont les noms de
fonctions fondamentales dans R (par exemple, <code>if</code>,
<code>else</code>, <code>for</code>, voir <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Reserved.html" class="external-link">ici</a>
pour une liste complète des noms réservés). En général, même si c’est
autorisé, il est préférable de de ne pas utiliser d’autres noms de
fonctions (par exemple, <code>c</code>, <code>T</code>,
<code>mean</code>, <code>data</code>, <code>df</code>,
<code>weight</code>). En cas de doute, consultez l’aide pour voir si le
nom est déjà utilisé. Il est également préférable d’éviter les points
(<code>.</code>) dans un nom d’objet comme dans <code>my.dataset</code>
(utilisez plutôt <code>my_dataset</code> par exemple). Vous remarquerez
cependant qu’il existe de nombreuses fonctions dans R avec des points
dans leurs noms. Ces noms de fonction sont conservés pour des raisons
historiques, mais comme les points ont une signification particulière en
R (pour les méthodes) et autres langages de programmation, il est
préférable de les éviter. Il est également recommandé d’utiliser des
noms pour les noms d’objets et des verbes pour les noms de fonctions. Il
est important d’être cohérent dans le style de votre code (où vous
placez les espaces, comment vous nommez les objets, etc.). L’utilisation
d’un style de codage cohérent rend votre code plus clair à lire pour vos
collaborateurs, mais aussi pour vous-même dans le futur (vous vous
remercierez plus tard). En R, il existe plusieurs guides de styles
populaires comme le guides de style <a href="https://google.github.io/styleguide/Rguide.xml" class="external-link">de Google</a>, du
<a href="https://style.tidyverse.org/" class="external-link">tidyverse</a> ou le Bioconductor
style guide. Le style Tidyverse est très complet mais peut sembler un
peu lourd au début. Vous pouvez installer le package <a href="https://github.com/jimhester/lintr" class="external-link"><strong><code>lintr</code></strong></a>
qui vérifiera et corrigera automatiquement les problèmes ou incohérences
dans le style de votre code.</p>
<blockquote>
<p><strong>Objets et variables</strong> : ce que l’on appelle des «
objets » en « R » sont connus sous le nom de « variables » dans de
nombreux autres langages de programmation. Selon le contexte, « objet »
et « variable » peuvent avoir des significations radicalement
différentes. Cependant, dans cette leçon, les deux mots sont utilisés de
manière synonyme. Pour plus d’informations <a href="https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Objects" class="external-link">voir
ce lien.</a></p>
</blockquote>
<p>Lors de l’attribution d’une valeur à un objet, R n’imprime rien dans
la console. Vous pouvez forcer R à imprimer la valeur d’un objet en
utilisant des parenthèses ou en tapant le nom de l’objet :</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_kg</span> <span class="op">&lt;-</span> <span class="fl">55</span> <span class="co"># n'imprime rien</span></span>
<span><span class="op">(</span><span class="va">weight_kg</span> <span class="op">&lt;-</span> <span class="fl">55</span><span class="op">)</span> <span class="co"># mais mettre des parenthèses autour de l'appel imprime la valeur de `weight_kg`</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 55</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_kg</span> <span class="co"># et taper également le nom du objet</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 55</code></pre>
</div>
<p>Maintenant que R a <code>weight_kg</code> en mémoire, nous pouvons
faire des opérations arithmétiques sur cet objet. Par exemple, nous
pouvons vouloir convertir ce poids en livres (le poids en livres est 2,2
fois le poids en kg) :</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2.2</span> <span class="op">*</span> <span class="va">weight_kg</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 121</code></pre>
</div>
<p>On peut également changer la valeur d’un objet en lui attribuant une
nouvelle valeur :</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_kg</span> <span class="op">&lt;-</span> <span class="fl">57.5</span></span>
<span><span class="fl">2.2</span> <span class="op">*</span> <span class="va">weight_kg</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 126.5</code></pre>
</div>
<p>L’attribution d’une valeur à un objet ne modifie pas les valeurs
d’autres objets. Par exemple, stockons le poids en livres dans un nouvel
objet <code>weight_lb</code> :</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_lb</span> <span class="op">&lt;-</span> <span class="fl">2.2</span> <span class="op">*</span> <span class="va">weight_kg</span></span></code></pre>
</div>
<p>puis remplacons <code>weight_kg</code> par 100.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_kg</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></code></pre>
</div>
<div id="défi" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="défi" class="callout-inner">
<h3 class="callout-title">Défi:</h3>
<div class="callout-content">
<p>Selon vous, quel est maintenant le contenu de l’objet
<code>weight_lb</code> ? 126.5 ou 220?</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="commentaires">Commentaires<a class="anchor" aria-label="anchor" href="#commentaires"></a>
</h2>
<hr class="half-width">
<p>En R, le caractère de commentaire est <code>#</code>. Tout ce qui se
trouve à droite d’un <code>#</code> dans un script sera ignoré par R.
Les commentaires sont utiles pour laisser des notes et explications dans
vos scripts.</p>
<p>RStudio permet de facilement commenter ou “décommenter” un paragraphe
: après avoir sélectionné les lignes que vous souhaitez commenter (ou
décommenter), appuyez simultanément sur les touches <kbd>Ctrl</kbd> +
<kbd>Shift</kbd> + <kbd>C</kbd>. Si vous ne souhaitez commenter qu’une
seule ligne, vous pouvez placer le curseur à n’importe quel emplacement
de cette ligne (il n’est pas nécessaire de sélectionner la ligne
entière), puis appuyez sur <kbd>Ctrl</kbd> + <kbd>Shift</kbd> +
<kbd>C</kbd>.</p>
<div id="défi-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="défi-1" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Quelles sont les valeurs des objets après chaque instruction
ci-dessous ?</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="fl">47.5</span>            <span class="co"># mass?</span></span>
<span><span class="va">age</span>  <span class="op">&lt;-</span> <span class="fl">122</span>             <span class="co"># age?</span></span>
<span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="va">mass</span> <span class="op">*</span> <span class="fl">2.0</span>      <span class="co"># mass?</span></span>
<span><span class="va">age</span>  <span class="op">&lt;-</span> <span class="va">age</span> <span class="op">-</span> <span class="fl">20</span>        <span class="co"># age?</span></span>
<span><span class="va">mass_index</span> <span class="op">&lt;-</span> <span class="va">mass</span><span class="op">/</span><span class="va">age</span>  <span class="co"># mass_index?</span></span></code></pre>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="les-fonctions-et-leurs-arguments">Les fonctions et leurs arguments<a class="anchor" aria-label="anchor" href="#les-fonctions-et-leurs-arguments"></a>
</h2>
<hr class="half-width">
<p>Les fonctions sont des “scripts prédéfinis” qui automatisent des
ensembles de commandes plus complexes, y compris les affectations
d’opérations. De nombreuses fonctions sont prédéfinies ou peuvent être
rendues disponibles en important des <em>packages</em> R (nous en
parlerons plus tard). Une fonction “prend” généralement une ou plusieurs
entrées appelées <em>arguments</em>. Les fonctions renvoient souvent
(mais pas toujours) une <em>valeur</em>. Un exemple typique serait la
fonction <code>sqrt()</code>. L’entrée (l’argument) doit être un nombre
et la valeur de retour (la “sortie”) est la racine carrée de ce nombre.
Exécuter une fonction est appelé <em>appeler</em> la fonction (“<em>call
a function</em>” en anglais). Un exemple d’appel de fonction est :</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></code></pre>
</div>
<p>Ici, la valeur de <code>a</code> est donnée à la fonction
<code>sqrt()</code>, la fonction <code>sqrt()</code> en calcule la
racine carrée, et renvoie cette valeur qui est ensuite attribuée à
l’objet <code>b</code>. Cette fonction est simple car elle ne prend
qu’un seul argument.</p>
<p>La valeur de retour d’une fonction (sa sortie) n’est pas
nécessairement numérique (comme celle de <code>sqrt()</code>), et elle
n’est pas forcément un élément unique : une sortie peut être un ensemble
de choses, ou même un jeu de données. Nous en verrons un exemple lorsque
nous lirons des fichiers de données dans R.</p>
<p>Les arguments peuvent aussi être divers, pas uniquement des nombres
ou noms de fichiers, mais aussi d’autres objets (listes, jeux de
données, etc.). La signification exacte de chaque argument diffère selon
la fonction et doit être recherchée dans la documentation (voir
ci-dessous). Certaines fonctions ont des arguments qui peuvent être
spécifiés par l’utilisateur ou prendre une valeur <em>par défaut</em> :
ces arguments optionnels sont appelés <em>options</em>. Les options sont
généralement utilisées pour modifier le fonctionnement de la fonction,
par exemple si elle doit ignorer les « mauvaises valeurs » ou quel
symbole utiliser dans un graphique. Si vous souhaitez un comportement
spécifique pour une fonction, vous pouvez spécifier une valeur de votre
choix qui sera utilisée à la place de la valeur par défaut.</p>
<p>Essayons maintenant une fonction qui peut prendre plusieurs arguments
: <code>round()</code>.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span><span class="fl">3.14159</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3</code></pre>
</div>
<p>Ici, nous avons appelé <code>round()</code> avec un seul argument,
<code>3.14159</code>, et il a renvoyé la valeur <code>3</code>. En
effet, le comportement par défaut de la fonction <code>round()</code>
est d’arrondir au nombre entier le plus proche. Si nous souhaitons
conserver quelques chiffres décimaux, nous pouvons voir comment procéder
en obtenant des informations sur la fonction <code>round</code>.
<code>args(round)</code> ou <code>?round</code> nous permettront
d’obternir des informations sur les arguments (optionnels) de la
fonction <code>round</code>.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">args</span><span class="op">(</span><span class="va">round</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="kw">function</span> <span class="op">(</span><span class="va">x</span>, <span class="va">digits</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="cn">NULL</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">round</span></span></code></pre>
</div>
<p>Nous voyons que si nous souhaitons deux chiffres décimaux, nous
pouvons taper <code>digits=2</code>.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span><span class="fl">3.14159</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.14</code></pre>
</div>
<p>Si vous fournissez les arguments exactement dans le même ordre que
celui dans lequel ils sont définis, vous n’avez pas besoin de les
nommer :</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span><span class="fl">3.14159</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.14</code></pre>
</div>
<p>Et si vous nommez les arguments, vous pouvez changer leur ordre :</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span>, x <span class="op">=</span> <span class="fl">3.14159</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.14</code></pre>
</div>
<p>Il est recommandé de placer les arguments non facultatifs (comme le
nombre que vous arrondissez) en premier dans votre appel de fonction et
de spécifier les noms de tous les arguments facultatifs. Si vous ne le
faites pas, quelqu’un qui lit votre code devra peut-être rechercher la
définition d’une fonction avec des arguments inconnus pour comprendre ce
que vous faites. En spécifiant le nom des arguments, vous protégez
également votre code contre d’éventuelles modifications futures dans
l’interface de la fonction, qui peuvent potentiellement ajouter de
nouveaux arguments entre ceux existants.</p>
</section><section><h2 class="section-heading" id="vecteurs-et-types-de-données">Vecteurs et types de données<a class="anchor" aria-label="anchor" href="#vecteurs-et-types-de-donn%C3%A9es"></a>
</h2>
<hr class="half-width">
<p>Le vecteur est le type de données le plus courant, basique et central
de R. Un vecteur est composé d’une série de valeurs, telles que des
nombres ou caractères. Nous pouvons attribuer une série de valeurs à un
vecteur en utilisant la fonction <code>c()</code>. Par exemple, nous
pouvons créer un vecteur de poids d’animaux et l’attribuer à un nouvel
objet <code>weight_g</code> :</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_g</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">50</span>, <span class="fl">60</span>, <span class="fl">65</span>, <span class="fl">82</span><span class="op">)</span></span>
<span><span class="va">weight_g</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 50 60 65 82</code></pre>
</div>
<p>Un vecteur peut également contenir des caractères :</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">molecules</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"dna"</span>, <span class="st">"rna"</span>, <span class="st">"protein"</span><span class="op">)</span></span>
<span><span class="va">molecules</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "dna"     "rna"     "protein"</code></pre>
</div>
<p>Les guillemets autour de <code>"dna"</code>, <code>"rna"</code>, etc.
sont ici essentiels. Sans les guillemets, R supposera qu’il existe des
objets appelés <code>dna</code>, <code>rna</code> et
<code>protein</code>. Comme ces objets n’existent pas dans la mémoire de
R, il y aura un message d’erreur.</p>
<p>Il existe de nombreuses fonctions qui vous permettent d’inspecter le
contenu d’un vecteur. <code>length()</code> vous indique combien
d’éléments se trouvent dans un vecteur particulier :</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="va">weight_g</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="va">molecules</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3</code></pre>
</div>
<p>Une caractéristique importante d’un vecteur est que tous les éléments
sont du même type de données. La fonction <code>class()</code> indique
la classe (le type d’élément) d’un objet :</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">weight_g</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "numeric"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">molecules</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<p>La fonction <code>str()</code> fournit un aperçu de la structure d’un
objet et de ses éléments. C’est une fonction utile lorsque vous
travaillez avec des objets volumineux et complexes :</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">weight_g</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> num [1:4] 50 60 65 82</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">molecules</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> chr [1:3] "dna" "rna" "protein"</code></pre>
</div>
<p>Vous pouvez utiliser la fonction <code>c()</code> pour ajouter
d’autres éléments à votre vecteur :</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_g</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">weight_g</span>, <span class="fl">90</span><span class="op">)</span> <span class="co"># ajout à la fin du vecteur</span></span>
<span><span class="va">weight_g</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">30</span>, <span class="va">weight_g</span><span class="op">)</span> <span class="co"># ajout au début du vecteur</span></span>
<span><span class="va">weight_g</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 30 50 60 65 82 90</code></pre>
</div>
<p>Dans la première ligne, nous prenons le vecteur d’origine
<code>weight_g</code>, y ajoutons la valeur <code>90</code> à la fin et
enregistrons le résultat dans <code>weight_g</code>. Dans la deuxième
ligne, nous ajoutons la valeur « 30 » au début, en enregistrant à
nouveau le résultat dans « weight_g ».</p>
<p>Nous pouvons continuer à compléter ainsi un vecteur ou utiliser cette
syntaxe pour assembler des données. Cela peut être utile pour ajouter
les résultats que nous collectons ou calculons au fur et à mesure de
notre analyse.</p>
<p>Un <strong>vecteur atomique</strong> est le <strong>type de
données</strong> R le plus simple; il s’agit d’un vecteur linéaire
composé d’éléments du même type. Plus tôt, nous avons vu 2 des 6
principaux types de vecteurs <strong>atomiques</strong> que R utilise :
<code>"character"</code> (caractères) et <code>"numeric"</code>
(chiffres, décimaux ou entiers) (ou <code>"double"</code> (réels)). Ce
sont les éléments de base à partir desquels tous les objets R sont
construits. Les 4 autres types de <strong>vecteurs atomiques</strong>
sont :</p>
<ul>
<li>
<code>"logical"</code> pour <code>TRUE</code> et <code>FALSE</code>
(le type de données booléen)</li>
<li>
<code>"integer"</code> pour les nombres entiers (par exemple,
<code>2L</code>, le <code>L</code> indique à R que c’est un entier)</li>
<li>
<code>"complex"</code> pour représenter des nombres complexes avec
des parties réelles et imaginaires (par exemple, <code>1 + 4i</code>);
et c’est tout ce que dirons à leur sujet</li>
<li>
<code>"raw"</code> pour les “flux de bits” (bitstreams) dont nous ne
parlerons pas davantage</li>
</ul>
<p>Vous pouvez vérifier le type de votre vecteur en utilisant la
fonction <code>typeof()</code> et en saisissant votre vecteur comme
argument.</p>
<p>Les vecteurs sont l’une des nombreuses <strong>structures de
données</strong> utilisées par R. Les autres structures importantes sont
les listes (<code>list</code>), les matrices (<code>matrix</code>), les
tables de données (<code>data.frame</code>), les facteurs
(<code>factor</code>) et les tableaux (<code>array</code> ).</p>
<div id="défi-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-2" class="callout-inner">
<h3 class="callout-title">Défi:</h3>
<div class="callout-content">
<p>Nous avons vu que les vecteurs atomiques peuvent être de type
caractère, numérique (ou double), entier et logique. Que se passe-t-il
si nous essayons de mélanger ces types dans un seul vecteur ?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>R les convertit implicitement pour qu’ils soient tous du même
type</p>
</div>
</div>
</div>
</div>
<div id="défi-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-3" class="callout-inner">
<h3 class="callout-title">Défi:</h3>
<div class="callout-content">
<p>Que se passera-t-il dans chacun de ces exemples ? (indice : utilisez
la fonction <code>class()</code> pour vérifier le type de données des
objets) :</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_char</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="st">"a"</span><span class="op">)</span></span>
<span><span class="va">num_logical</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">char_logical</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">tricky</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="st">"4"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">num_char</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_char</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "1" "2" "3" "a"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">num_logical</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "numeric"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_logical</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3 1 0</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">char_logical</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">char_logical</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "a"    "b"    "c"    "TRUE"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">tricky</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tricky</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "1" "2" "3" "4"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="défi-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-4" class="callout-inner">
<h3 class="callout-title">Défi:</h3>
<div class="callout-content">
<p>Pourquoi pensez-vous que cela arrive ?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>Les éléments des vecteurs ne peuvent appartenir qu’à un seul type de
données. R essaie donc de convertir le contenu de ce vecteur pour
trouver un <em>dénominateur commun</em> qui n’amène à aucune perte
d’information.</p>
</div>
</div>
</div>
</div>
<div id="défi-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-5" class="callout-inner">
<h3 class="callout-title">Défi:</h3>
<div class="callout-content">
<p>Combien de valeurs dans <code>combined_logical</code> sont
<code>"TRUE"</code> (sous forme de caractère) dans l’exemple
suivant :</p>
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_logical</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">char_logical</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">combined_logical</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">num_logical</span>, <span class="va">char_logical</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>Seulement un. Il n’y a pas de mémoire des types de données passés et
la conversion (“coercition”) se produit la première fois que le vecteur
est évalué. Par conséquent, le <code>TRUE</code> dans
<code>num_logical</code> est converti en <code>1</code> avant d’être
converti en <code>"1"</code> dans <code>combined_logical</code>.</p>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combined_logical</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "1"    "2"    "3"    "1"    "a"    "b"    "c"    "TRUE"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="défi-6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-6" class="callout-inner">
<h3 class="callout-title">Défi:</h3>
<div class="callout-content">
<p>Dans R, nous appelons la conversion d’objets d’une classe vers une
autre classe <em>coercition</em>. Ces conversions se produisent selon
une hiérarchie, selon laquelle certains types sont préférentiellement
contraints vers d’autres types. Pouvez-vous dessiner un diagramme qui
représente la hiérarchie de la façon dont ces types de données sont
forcés ?</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p>logique → numérique → caractère ← logique</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="extraire-des-valeurs-dun-vecteur-subsetting">Extraire des valeurs d’un vecteur (Subsetting)<a class="anchor" aria-label="anchor" href="#extraire-des-valeurs-dun-vecteur-subsetting"></a>
</h2>
<hr class="half-width">
<p>Si l’on veut extraire une ou plusieurs valeurs d’un vecteur, il faut
fournir un ou plusieurs indices entre crochets. Par exemple:</p>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">molecules</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"dna"</span>, <span class="st">"rna"</span>, <span class="st">"peptide"</span>, <span class="st">"protein"</span><span class="op">)</span></span>
<span><span class="va">molecules</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "rna"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb69">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">molecules</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "peptide" "rna"    </code></pre>
</div>
<p>On peut également répéter les indices pour créer un objet avec plus
d’éléments que celui d’origine :</p>
<div class="codewrapper sourceCode" id="cb71">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">more_molecules</span> <span class="op">&lt;-</span> <span class="va">molecules</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">more_molecules</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "dna"     "rna"     "peptide" "rna"     "dna"     "protein"</code></pre>
</div>
<p>En R, les indices commencent à 1. Les langages de programmation comme
Fortran, MATLAB, Julia et R commencent à compter à 1, car c’est ce que
font généralement les êtres humains. Les langages de la famille C (y
compris C++, Java, Perl, et Python) comptent à partir de 0 car c’est
plus simple à faire pour les ordinateurs.</p>
<p>En utilisant des indices négatifs, on peut obtenir tous les éléments
d’un vecteur sauf ceux spécifiés par les indices négatifs :</p>
<div class="codewrapper sourceCode" id="cb73">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">molecules</span> <span class="co">## all molecules</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "dna"     "rna"     "peptide" "protein"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb75">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">molecules</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="co">## all but the first one</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "rna"     "peptide" "protein"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb77">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">molecules</span><span class="op">[</span><span class="op">-</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span> <span class="co">## all but 1st/3rd ones</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "rna"     "protein"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb79">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">molecules</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span> <span class="co">## all but 1st/3rd ones</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "rna"     "protein"</code></pre>
</div>
</section><section><h2 class="section-heading" id="sous-ensemble-conditionnel">Sous-ensemble conditionnel<a class="anchor" aria-label="anchor" href="#sous-ensemble-conditionnel"></a>
</h2>
<hr class="half-width">
<p>Une autre méthode courante de sous-ensemble consiste à utiliser un
vecteur logique. <code>TRUE</code> sélectionnera l’élément avec le même
index, tandis que <code>FALSE</code> ne le fera pas :</p>
<div class="codewrapper sourceCode" id="cb81">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_g</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">21</span>, <span class="fl">34</span>, <span class="fl">39</span>, <span class="fl">54</span>, <span class="fl">55</span><span class="op">)</span></span>
<span><span class="va">weight_g</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 21 39 54</code></pre>
</div>
<p>Généralement, ces vecteurs logiques ne sont pas tapés à la main, mais
sont le résultat d’autres fonctions ou tests logiques. Par exemple, si
vous souhaitez sélectionner uniquement les valeurs supérieures à
50 :</p>
<div class="codewrapper sourceCode" id="cb83">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## will return logicals with TRUE for the indices that meet</span></span>
<span><span class="co">## the condition</span></span>
<span><span class="va">weight_g</span> <span class="op">&gt;</span> <span class="fl">50</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE FALSE FALSE  TRUE  TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb85">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## so we can use this to select only the values above 50</span></span>
<span><span class="va">weight_g</span><span class="op">[</span><span class="va">weight_g</span> <span class="op">&gt;</span> <span class="fl">50</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 54 55</code></pre>
</div>
<p>Vous pouvez combiner plusieurs tests en utilisant <code>&amp;</code>
(les deux conditions sont vraies, AND) ou <code>|</code> (au moins une
des conditions est vraie, OR) :</p>
<div class="codewrapper sourceCode" id="cb87">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_g</span><span class="op">[</span><span class="va">weight_g</span> <span class="op">&lt;</span> <span class="fl">30</span> <span class="op">|</span> <span class="va">weight_g</span> <span class="op">&gt;</span> <span class="fl">50</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 21 54 55</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb89">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_g</span><span class="op">[</span><span class="va">weight_g</span> <span class="op">&gt;=</span> <span class="fl">30</span> <span class="op">&amp;</span> <span class="va">weight_g</span> <span class="op">==</span> <span class="fl">21</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fu">numeric</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<p>Ici, <code>&lt;</code> signifie “inférieur à”, <code>&gt;</code>
signifie “supérieur à”, <code>&gt;=</code> signifie “supérieur ou égal
à” et <code>==</code> signifie “égal à”. Le double signe égal
<code>==</code> est un test d’égalité numérique entre les côtés gauche
et droit, et ne doit pas être confondu avec le signe simple
<code>=</code>, qui effectue une affectation de variable (similaire à
<code>&lt;-</code>).</p>
<p>Une tâche courante consiste à rechercher certaines chaînes de
caractères dans un vecteur. On pourrait utiliser l’opérateur “ou”
<code>|</code> pour tester l’égalité de plusieurs valeurs, mais cela
peut rapidement devenir fastidieux. La fonction <code>%in%</code> permet
de tester si l’un des éléments d’un vecteur de recherche est trouvé
:</p>
<div class="codewrapper sourceCode" id="cb91">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">molecules</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"dna"</span>, <span class="st">"rna"</span>, <span class="st">"protein"</span>, <span class="st">"peptide"</span><span class="op">)</span></span>
<span><span class="va">molecules</span><span class="op">[</span><span class="va">molecules</span> <span class="op">==</span> <span class="st">"rna"</span> <span class="op">|</span> <span class="va">molecules</span> <span class="op">==</span> <span class="st">"dna"</span><span class="op">]</span> <span class="co"># returns both rna and dna</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "dna" "rna"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb93">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">molecules</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"rna"</span>, <span class="st">"dna"</span>, <span class="st">"metabolite"</span>, <span class="st">"peptide"</span>, <span class="st">"glycerol"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  TRUE  TRUE FALSE  TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb95">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">molecules</span><span class="op">[</span><span class="va">molecules</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"rna"</span>, <span class="st">"dna"</span>, <span class="st">"metabolite"</span>, <span class="st">"peptide"</span>, <span class="st">"glycerol"</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "dna"     "rna"     "peptide"</code></pre>
</div>
<div id="défi-7" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-7" class="callout-inner">
<h3 class="callout-title">Défi:</h3>
<div class="callout-content">
<p>À votre avis, pourquoi est-ce <code>"four" &gt; "five"</code>
(<code>"quatre" &gt; "cinq"</code>) renvoie <code>TRUE</code> ?</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb97">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="st">"four"</span> <span class="op">&gt;</span> <span class="st">"five"</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<p>Lorsque vous utilisez <code>&gt;</code> ou <code>&lt;</code> sur des
chaînes de caractère, R compare leur ordre alphabétique. Ici,
<code>"four"</code> (quatre) vient alphabétiquement après
<code>"five"</code> (cinq), et est donc <em>supérieur à</em> cinq.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="noms-déléments-dun-vecteur">Noms d’éléments d’un vecteur<a class="anchor" aria-label="anchor" href="#noms-d%C3%A9l%C3%A9ments-dun-vecteur"></a>
</h2>
<hr class="half-width">
<p>Il est possible de nommer chaque élément d’un vecteur. Le code
ci-dessous montre un exemple d’un vecteur dont les éléments n’ont
initialement aucun nom, et comment on peut ensuite définir et récupérer
les noms des éléments.</p>
<div class="codewrapper sourceCode" id="cb99">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co">## no names</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="cn">NULL</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb101">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">names</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span><span class="op">)</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co">## now we have names</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "A" "B" "C" "D" "E"</code></pre>
</div>
<p>Lorsqu’un vecteur possède des noms, il est possible d’accéder aux
éléments par leur nom, en plus de par leur index.</p>
<div class="codewrapper sourceCode" id="cb103">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>A C
1 3 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb105">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>A C
1 3 </code></pre>
</div>
</section><section><h2 class="section-heading" id="données-manquantes">Données manquantes<a class="anchor" aria-label="anchor" href="#donn%C3%A9es-manquantes"></a>
</h2>
<hr class="half-width">
<p>Comme R a été conçu pour analyser des jeux de données, il inclut le
concept de données manquantes (ce qui est rare dans d’autres langages de
programmation). Les données manquantes sont représentées dans les
vecteurs par <code>NA</code> (pour <em>not applicable</em>).</p>
<p>Lorsque vous effectuez des opérations sur des nombres, la plupart des
fonctions renverront <code>NA</code> si les données avec lesquelles vous
travaillez incluent des valeurs manquantes. Cette fonctionnalité par
défaut rend plus difficile l’ignorance des cas où vous avez affaire à
des données manquantes. Vous pouvez ajouter l’argument
<code>na.rm = TRUE</code> pour calculer le résultat en ignorant les
valeurs manquantes (<code>na.rm</code> peut se traduire par “<em>remove
NA</em>”, où “<em>remove</em>” signifie “enlever” en anglais).</p>
<div class="codewrapper sourceCode" id="cb107">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">heights</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="cn">NA</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="va">heights</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb109">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">max</span><span class="op">(</span><span class="va">heights</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb111">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">heights</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb113">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">max</span><span class="op">(</span><span class="va">heights</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 6</code></pre>
</div>
<p>Si vos données incluent des valeurs manquantes, vous souhaiterez
peut-être vous familiariser avec les fonctions <code>is.na()</code>,
<code>na.omit()</code> et <code>complete.cases()</code>. Voici quelques
exemples.</p>
<div class="codewrapper sourceCode" id="cb115">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extrait les éléments qui ne sont pas manquants.</span></span>
<span><span class="va">heights</span><span class="op">[</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">heights</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2 4 4 6</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb117">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Renvois un objet dont les cas incomplets ont été supprimés. </span></span>
<span><span class="co">## L'objet renvoyé est un vecteur atomique du type "numeric"</span></span>
<span><span class="co">## (ou "double").</span></span>
<span><span class="fu">na.omit</span><span class="op">(</span><span class="va">heights</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2 4 4 6
attr(,"na.action")
[1] 4
attr(,"class")
[1] "omit"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb119">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extrait les éléments qui représentent des cas complets.</span></span>
<span><span class="co">## L'objet renvoyé est un vecteur atomique du type "numeric"</span></span>
<span><span class="co">## (ou "double").</span></span>
<span><span class="va">heights</span><span class="op">[</span><span class="fu">complete.cases</span><span class="op">(</span><span class="va">heights</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2 4 4 6</code></pre>
</div>
<div id="défi-8" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-8" class="callout-inner">
<h3 class="callout-title">Défi:</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>En utilisant ce vecteur de hauteurs en pouces (<em>inches</em>),
créez un nouveau vecteur en supprimant les NA.</li>
</ol>
<div class="codewrapper sourceCode" id="cb121">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">heights</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">63</span>, <span class="fl">69</span>, <span class="fl">60</span>, <span class="fl">65</span>, <span class="cn">NA</span>, <span class="fl">68</span>, <span class="fl">61</span>, <span class="fl">70</span>, <span class="fl">61</span>, <span class="fl">59</span>, <span class="fl">64</span>, <span class="fl">69</span>, <span class="fl">63</span>, <span class="fl">63</span>, <span class="cn">NA</span>, <span class="fl">72</span>, <span class="fl">65</span>, <span class="fl">64</span>, <span class="fl">70</span>, <span class="fl">63</span>, <span class="fl">65</span><span class="op">)</span></span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Utilisez la fonction <code>median()</code> pour calculer la médiane
du vecteur <code>heights</code>.</li>
<li>Utilisez R pour déterminer combien de personnes dans l’échantillon
mesurent plus de 67 pouces.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7"> Show me the solution </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" aria-labelledby="headingSolution7" data-bs-parent="#accordionSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb122">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">heights_no_na</span> <span class="op">&lt;-</span> <span class="va">heights</span><span class="op">[</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">heights</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">## or</span></span>
<span><span class="va">heights_no_na</span> <span class="op">&lt;-</span> <span class="fu">na.omit</span><span class="op">(</span><span class="va">heights</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb123">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">median</span><span class="op">(</span><span class="va">heights</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 64</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb125">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">heights_above_67</span> <span class="op">&lt;-</span> <span class="va">heights_no_na</span><span class="op">[</span><span class="va">heights_no_na</span> <span class="op">&gt;</span> <span class="fl">67</span><span class="op">]</span></span>
<span><span class="fu">length</span><span class="op">(</span><span class="va">heights_above_67</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 6</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="sec:genvec">Génération de vecteurs<a class="anchor" aria-label="anchor" href="#sec:genvec"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="constructeurs">Constructeurs<a class="anchor" aria-label="anchor" href="#constructeurs"></a>
</h3>
<p>Il existe quelques fonctions pour générer des vecteurs de différents
types. Pour générer un vecteur de valeurs numériques, on peut utiliser
le constructeur <code>numeric()</code>, en lui fournissant la longueur
du vecteur de sortie comme paramètre. Les valeurs seront initialisées à
0.</p>
<div class="codewrapper sourceCode" id="cb127">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">numeric</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0 0 0</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb129">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">numeric</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] 0 0 0 0 0 0 0 0 0 0</code></pre>
</div>
<p>Notez que si l’on demande un vecteur de numériques de longueur 0, on
obtient exactement cela :</p>
<div class="codewrapper sourceCode" id="cb131">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">numeric</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fu">numeric</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<p>Il existe des constructeurs similaires pour les caractères et les
logiques, nommés respectivement <code>character()</code> et
<code>logical()</code>.</p>
<div id="défi-9" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-9" class="callout-inner">
<h3 class="callout-title">Défi:</h3>
<div class="callout-content">
<p>Quelles sont les valeurs par défaut pour les vecteurs de caractères
et les vecteurs logiques ?</p>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8"> Show me the solution </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" aria-labelledby="headingSolution8" data-bs-parent="#accordionSolution8">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb133">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">character</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="co">## the empty character</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "" ""</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb135">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">logical</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>   <span class="co">## FALSE</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE FALSE</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="répliquer-des-éléments">Répliquer des éléments<a class="anchor" aria-label="anchor" href="#r%C3%A9pliquer-des-%C3%A9l%C3%A9ments"></a>
</h3>
<p>La fonction <code>rep</code> permet de répéter une valeur un certain
nombre de fois. Si nous voulons initier un vecteur de numériques de
longueur 5 avec la valeur -1, par exemple, nous pourrions faire ce qui
suit :</p>
<div class="codewrapper sourceCode" id="cb137">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rep</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -1 -1 -1 -1 -1</code></pre>
</div>
<p>De même, pour générer un vecteur rempli de valeurs manquantes, ce qui
est souvent une bonne façon de commencer, sans poser d’hypothèses sur
les données qui seront collectées :</p>
<div class="codewrapper sourceCode" id="cb139">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rep</span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA NA NA NA NA</code></pre>
</div>
<p><code>rep</code> peut prendre en entrée des vecteurs de n’importe
quelle longueur (ci-dessus, nous avons utilisé des vecteurs de longueur
1) et de n’importe quel type. Par exemple, si nous voulions répéter cinq
fois les valeurs 1, 2 et 3, nous procéderions comme suit :</p>
<div class="codewrapper sourceCode" id="cb141">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3</code></pre>
</div>
<div id="défi-10" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-10" class="callout-inner">
<h3 class="callout-title">Défi:</h3>
<div class="callout-content">
<p>Et si nous voulions répéter les valeurs 1, 2 et 3 cinq fois, mais
obtenir cinq 1, cinq 2 et cinq 3 dans cet ordre, comment devrions-nous
procéder ? Il existe deux possibilités: voir <code>?rep</code> ou
<code>?sort</code> pour obtenir de l’aide.</p>
</div>
</div>
</div>
<div id="accordionSolution9" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution9" aria-expanded="false" aria-controls="collapseSolution9">
  <h4 class="accordion-header" id="headingSolution9"> Show me the solution </h4>
</button>
<div id="collapseSolution9" class="accordion-collapse collapse" aria-labelledby="headingSolution9" data-bs-parent="#accordionSolution9">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb143">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] 1 1 1 1 1 2 2 2 2 2 3 3 3 3 3</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb145">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sort</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] 1 1 1 1 1 2 2 2 2 2 3 3 3 3 3</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="génération-de-séquences">Génération de séquences<a class="anchor" aria-label="anchor" href="#g%C3%A9n%C3%A9ration-de-s%C3%A9quences"></a>
</h3>
<p>Une autre fonction très utile est <code>seq</code>, pour générer une
séquence de nombres. Par exemple, pour générer une séquence d’entiers de
1 à 20 par pas de 2, on utiliserait :</p>
<div class="codewrapper sourceCode" id="cb147">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">seq</span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">20</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  1  3  5  7  9 11 13 15 17 19</code></pre>
</div>
<p>La valeur par défaut de <code>by</code> est 1 et, étant donné que la
génération d’une séquence d’une valeur à une autre avec des pas de 1 est
fréquemment utilisée, il existe un raccourci :</p>
<div class="codewrapper sourceCode" id="cb149">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">seq</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3 4 5</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb151">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">seq</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span> <span class="co">## default by</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3 4 5</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb153">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3 4 5</code></pre>
</div>
<p>Pour générer une séquence de nombres de 1 à 20 de longueur finale de
3, on utiliserait :</p>
<div class="codewrapper sourceCode" id="cb155">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">seq</span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">20</span>, length.out <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  1.0 10.5 20.0</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="échantillons-aléatoires-et-permutations">Échantillons aléatoires et permutations<a class="anchor" aria-label="anchor" href="#%C3%A9chantillons-al%C3%A9atoires-et-permutations"></a>
</h3>
<p>Un dernier groupe de fonctions utiles sont celles qui génèrent des
données aléatoires. La première, <code>sample</code>, génère une
permutation aléatoire d’un autre vecteur. Par exemple, pour tirer au
sort un ordre aléatoire de 10 étudiants pour leur examen oral,
j’attribue d’abord à chaque étudiant·e un numéro de 1 à dix (par exemple
en fonction de l’ordre alphabétique de leurs noms) puis :</p>
<div class="codewrapper sourceCode" id="cb157">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  9  4  7  1  2  5  3 10  6  8</code></pre>
</div>
<p>Sans autres arguments, <code>sample</code> renverra une permutation
de tous les éléments du vecteur. Si je veux un échantillon aléatoire
d’une certaine taille, je définirais cette valeur comme deuxième
argument. Ci-dessous, j’échantillonne 5 lettres aléatoires de l’alphabet
contenu dans le vecteur <code>letters</code> prédéfini :</p>
<div class="codewrapper sourceCode" id="cb159">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sample</span><span class="op">(</span><span class="va">letters</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "s" "a" "u" "x" "j"</code></pre>
</div>
<p>Si je voulais une sortie plus grande que le vecteur d’entrée, ou
pouvoir tirer au sort certains éléments plusieurs fois, je devrais
définir l’argument <code>replace</code> à <code>TRUE</code> :</p>
<div class="codewrapper sourceCode" id="cb161">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">10</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] 2 1 5 5 1 1 5 5 2 2</code></pre>
</div>
<div id="défi-11" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-11" class="callout-inner">
<h3 class="callout-title">Défi:</h3>
<div class="callout-content">
<p>En essayant les fonctions ci-dessus, vous aurez réalisé que les
échantillons sont effectivement aléatoires et qu’on n’obtient pas deux
fois la même permutation. Pour pouvoir reproduire ces tirages
aléatoires, on peut définir manuellement la “graine d’échantillonage” de
nombres aléatoires avec la fonction <code>set.seed()</code> avant de
tirer l’échantillon aléatoire.</p>
<p>Testez cette fonctionnalité avec votre voisin. Tirez d’abord deux
permutations aléatoires de « 1:10 » indépendamment et observez que vous
obtenez résultats différents.</p>
<p>Définissez maintenant la graine avec, par exemple,
<code>set.seed(123)</code> et répétez le tirage au sort. Observez que
vous obtenez désormais les mêmes tirages.</p>
<p>Répétez en définissant une graine différente.</p>
</div>
</div>
</div>
<div id="accordionSolution10" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution10" aria-expanded="false" aria-controls="collapseSolution10">
  <h4 class="accordion-header" id="headingSolution10"> Show me the solution </h4>
</button>
<div id="collapseSolution10" class="accordion-collapse collapse" aria-labelledby="headingSolution10" data-bs-parent="#accordionSolution10">
<div class="accordion-body">
<p>Différentes permutations</p>
<div class="codewrapper sourceCode" id="cb163">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  9  1  4  3  6  2  5  8 10  7</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb165">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  4  9  7  6  1 10  8  3  2  5</code></pre>
</div>
<p>Mêmes permutations avec la graine 123</p>
<div class="codewrapper sourceCode" id="cb167">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  3 10  2  8  6  9  1  7  5  4</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb169">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  3 10  2  8  6  9  1  7  5  4</code></pre>
</div>
<p>Une graine différente</p>
<div class="codewrapper sourceCode" id="cb171">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  9  4  7  1  2  5  3 10  6  8</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb173">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu">sample</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  9  4  7  1  2  5  3 10  6  8</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="échantillonner-à-partir-dune-distribution-normale">Échantillonner à partir d’une distribution normale<a class="anchor" aria-label="anchor" href="#%C3%A9chantillonner-%C3%A0-partir-dune-distribution-normale"></a>
</h3>
<p>La dernière fonction que nous allons voir est <code>rnorm</code>, qui
tire un échantillon aléatoire à partir d’une distribution normale. Deux
distributions normales de moyennes 0 et 100 et d’écarts types 1 et 5,
notées <em>N(0, 1)</em> et <em>N(100, 5)</em>, sont présentées
graphiquement ci-dessous.</p>
<figure style="text-align: center"><img src="../fig/23-starting-with-r-rendered-unnamed-chunk-61-1.png" alt="Two normal distributions: *N(0, 1)* on the left and *N(100, 5)* on the right." class="figure mx-auto d-block"><figcaption>
Two normal distributions: <em>N(0, 1)</em> on the left and <em>N(100,
5)</em> on the right.
</figcaption></figure><p>Les trois arguments, <code>n</code>, <code>mean</code> et
<code>sd</code>, définissent la taille de l’échantillon, et les
paramètres de la distribution normale, c’est-à-dire sa moyenne et son
écart type. Les valeurs par défaut de ces derniers sont 0 et 1.</p>
<div class="codewrapper sourceCode" id="cb175">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  0.69641761  0.05351568 -1.31028350 -2.12306606 -0.20807859</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb177">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  1.3744268 -0.1164714  2.8344472  1.3690969  3.6510983</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb179">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 106.45636  96.87448  95.62427 100.71678 107.12595</code></pre>
</div>
<p>Maintenant que nous avons appris à écrire des scripts et connaissons
les bases des structures de données de R, nous sommes prêts à commencer
à travailler avec des données plus volumineuses et à en apprendre
davantage sur les “data frames” (tables de données).</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Comment interagir avec R</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-25-starting-with-data"><p>Content from <a href="25-starting-with-data.html">Commencer par les données</a></p>
<hr>
<p>Last updated on 2025-05-05 |

        <a href="https://github.com/carpentries-incubator/bioc-intro/edit/main/episodes/25-starting-with-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Première analyse de données dans R.</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Décrire ce qu’est un data frame.</li>
<li>Charger des données externes à partir d’un fichier .csv dans un data
frame.</li>
<li>Résumer le contenu d’un data frame.</li>
<li>Décrire ce qu’est un facteur.</li>
<li>Convertissez entre les chaînes de caractère et les facteurs.</li>
<li>Réorganiser et renommer les facteurs.</li>
<li>Formatez les dates.</li>
<li>Exporter et enregistrez les données.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<blockquote>
<p>Cet épisode est basé sur la leçon des Data Carpentries intitulée :
<em>Analyse des données et Visualisation dans R pour les
écologistes</em>.</p>
</blockquote>
<section><h2 class="section-heading" id="présentation-des-données-dexpression-des-gènes">Présentation des données d’expression des gènes<a class="anchor" aria-label="anchor" href="#pr%C3%A9sentation-des-donn%C3%A9es-dexpression-des-g%C3%A8nes"></a>
</h2>
<hr class="half-width">
<p>Nous allons utiliser une partie des données publiées par Blackmore ,
<em>The effect of upper-respiratory infection on transcriptomic changes
in the CNS</em>. Le but de l’étude était de déterminer l’effet d’une
infection des voies respiratoires supérieures sur les modifications de
la transcription de l’ARN se produisant dans le cervelet et la moelle
épinière après l’infection. Des souris C57BL/6, âgées de huit semaines
et appariées selon le genre, ont été inoculées avec une solution saline
ou avec la grippe A par voie intranasale et les changements
transcriptomiques dans les tissus du cervelet et de la moelle épinière
ont été évalués par RNA-seq aux jours 0 (non infectées), 4 et 8.</p>
<p>L’ensemble de données est stocké sous forme de fichier CSV
(<em>comma-separated values</em> ou valeurs séparées par des virgules).
Chaque ligne contient des informations pour une seule mesure
d’expression d’ARN. Les onze premières colonnes représentent :</p>
<table class="table">
<colgroup>
<col width="5%">
<col width="94%">
</colgroup>
<thead><tr class="header">
<th>Colonne</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>gene</td>
<td>Le nom du gène qui a été mesuré.</td>
</tr>
<tr class="even">
<td>sample</td>
<td>Le nom de l’échantillon dans lequel l’expression du gène a été
mesurée.</td>
</tr>
<tr class="odd">
<td>expression</td>
<td>La valeur de l’expression des gènes.</td>
</tr>
<tr class="even">
<td>organism</td>
<td>L’organisme/l’espèce - ici toutes les données proviennent de
souris.</td>
</tr>
<tr class="odd">
<td>age</td>
<td>L’âge de la souris (ici toutes les souris ont 8 semaines)</td>
</tr>
<tr class="even">
<td>sex</td>
<td>Le sexe de la souris.</td>
</tr>
<tr class="odd">
<td>infection</td>
<td>L’état d’infection de la souris, c’est-à-dire infectée par la grippe
A ou non infectée.</td>
</tr>
<tr class="even">
<td>strain</td>
<td>La souche grippale A.</td>
</tr>
<tr class="odd">
<td>time</td>
<td>La durée de l’infection (en jours).</td>
</tr>
<tr class="even">
<td>tissue</td>
<td>Le tissu utilisé pour l’expérience d’expression génique,
c’est-à-dire le cervelet (cerebellum) ou la moelle épinière (spinal
cord).</td>
</tr>
<tr class="odd">
<td>mouse</td>
<td>L’identifiant unique de la souris.</td>
</tr>
</tbody>
</table>
<p>Nous allons utiliser la fonction R <code>download.file()</code> pour
télécharger le fichier CSV contenant les données d’expression génique.
Nous utiliserons ensuite <code>read.csv()</code> pour charger en mémoire
le contenu du fichier CSV en tant qu’objet de classe
<code>data.frame</code>. Dans la commande <code>download.file</code>, la
première entrée est une chaîne de caractères avec l’URL source. Cette
URL télécharge un fichier CSV à partir d’un dépôt GitHub (GitHub
repository). Le second argument :
<code>destfile = "data/rnaseq.csv"</code> (texte après la virgule)
correspond à la destination du fichier sur votre machine locale. Vous
aurez besoin d’un dossier sur votre ordinateur appelé
<code>"data"</code> dans lequel vous téléchargerez le fichier. Pour
récapituler, cette commande télécharge le fichier distant, le nomme
<code>"rnaseq.csv"</code> et l’ajoute à un dossier préexistant nommé
<code>"data"</code>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">download.file</span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://github.com/carpentries-incubator/bioc-intro/raw/main/episodes/data/rnaseq.csv"</span>,</span>
<span>              destfile <span class="op">=</span> <span class="st">"data/rnaseq.csv"</span> <span class="op">)</span></span></code></pre>
</div>
<p>Vous êtes maintenant prêt à charger les données dans
<code>R</code>:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arn</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/rnaseq.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>Cette instruction ne produit aucune sortie dans la console car, comme
vous vous en souvenez peut-être, les commandes d’assignation n’affichent
rien. Si nous voulons vérifier que nos données ont bien été chargées,
nous pouvons voir le contenu du data frame (tableau de données) en en
tapant son nom :</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arn</span></span></code></pre>
</div>
<p>Ouah… cela fait beaucoup de lignes de sorties. Cela signifie que les
données ont été chargées correctement dans l’environnement de travail.
Vérifions le haut (les 6 premières lignes) de ce data frame en utilisant
la fonction <code>head()</code> :</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">rna</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'rna' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Essayez aussi</span></span>
<span><span class="co">## View(rna)</span></span></code></pre>
</div>
<p><strong>Note</strong></p>
<p><code>read.csv()</code> suppose que les champs soient délimités par
des virgules. Cependant, dans plusieurs pays et notamment en France, la
virgule est utilisée comme séparateur décimal et le point-virgule (;)
est utilisé comme délimiteur de champ. Si vous souhaitez lire ce type de
fichiers dans R, vous pouvez utiliser la fonction
<code>read.csv2()</code>. Il se comporte exactement comme
<code>read.csv()</code> mais utilise des paramètres différents pour la
décimale et les séparateurs de champ. Si vous travaillez avec un autre
format de données , ces paramètres peuvent tous deux être spécifiés
explicitement par l’utilisateur. Consultez l’aide de la fonction
<code>read.csv()</code> en tapant <code>?read.csv</code> pour en savoir
plus. Il existe également la fonction <code>read.delim()</code> pour
lire des fichiers de données séparées par des tabulations. Il est
important de noter que toutes ces fonctions sont en fait des fonctions
wrapper pour la fonction principale <code>read.table()</code> avec
différents arguments. Par exemple, les données ci-dessus auraient
également pu être chargées en utilisant <code>read.table()</code> avec
l’argument de séparation (<code>sep</code>) égal à <code>","</code>
selon le code suivant :</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">&lt;-</span> <span class="fu">read.table</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/rnaseq.csv"</span>,</span>
<span>                  sep <span class="op">=</span> <span class="st">","</span>,</span>
<span>                  header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<p>L’argument <code>header</code> (en-tête) doit être défini comme étant
<code>TRUE</code> pour pouvoir lire les en-têtes du fichier CSV, puisque
par défaut dans <code>read.table()</code>, l’argument
<code>header</code> défini comme étant <code>FALSE</code>.</p>
</section><section><h2 class="section-heading" id="quest-ce-quun-data-frame">Qu’est-ce qu’un data frame ?<a class="anchor" aria-label="anchor" href="#quest-ce-quun-data-frame"></a>
</h2>
<hr class="half-width">
<p>Le data frame (tableau de données) est une structure de données
<em>de facto</em> pour la plupart des données tabulaires et ce que nous
utilisons pour calculer des statistiques et faire des graphiques.</p>
<p>Un data frame peut être créé à la main, mais le plus souvent celui-ci
est générés par les fonctions <code>read.csv()</code> ou
<code>read.table()</code>, c’est-à-dire lors de l’importation de
feuilles de calcul depuis votre disque dur (ou le web).</p>
<p>Le data frame représente les données sous la forme d’un tableau où
les colonnes sont des vecteurs qui ont tous la même longueur. Étant
donné que les colonnes sont des vecteurs (de classe
<code>vector</code>), chaque colonne doit contenir un seul type de
données (par exemple, des caractères, des entiers, des facteurs). Par
exemple, voici une figure représentant un data frame comprenant trois
vecteurs : un numérique, un caractère et un logique.</p>
<figure><img src=".././fig/data-frame.svg" class="figure mx-auto d-block"></figure><p>Nous pouvons le voir lors de l’inspection de la <b>str</b>ucture d’un
data frame avec la fonction <code>str()</code> :</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">arn</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>'data.frame':	32428 obs. of  19 variables:
 $ gene                                 : chr  "Asl" "Apod" "Cyp2d22" "Klk6" ...
 $ sample                               : chr  "GSM2545336" "GSM2545336" "GSM2545336" "GSM2545336" ...
 $ expression                           : int  1170 36194 4060 287 85 782 1619 288 43217 1071 ...
 $ organism                             : chr  "Mus musculus" "Mus musculus" "Mus musculus" "Mus musculus" ...
 $ age                                  : int  8 8 8 8 8 8 8 8 8 8 ...
 $ sex                                  : chr  "Female" "Female" "Female" "Female" ...
 $ infection                            : chr  "InfluenzaA" "InfluenzaA" "InfluenzaA" "InfluenzaA" ...
 $ strain                               : chr  "C57BL/6" "C57BL/6" "C57BL/6" "C57BL/6" ...
 $ time                                 : int  8 8 8 8 8 8 8 8 8 8 ...
 $ tissue                               : chr  "Cerebellum" "Cerebellum" "Cerebellum" "Cerebellum" ...
 $ mouse                                : int  14 14 14 14 14 14 14 14 14 14 ...
 $ ENTREZID                             : int  109900 11815 56448 19144 80891 20528 97827 118454 18823 14696 ...
 $ product                              : chr  "argininosuccinate lyase, transcript variant X1" "apolipoprotein D, transcript variant 3" "cytochrome P450, family 2, subfamily d, polypeptide 22, transcript variant 2" "kallikrein related-peptidase 6, transcript variant 2" ...
 $ ensembl_gene_id                      : chr  "ENSMUSG00000025533" "ENSMUSG00000022548" "ENSMUSG00000061740" "ENSMUSG00000050063" ...
 $ external_synonym                     : chr  "2510006M18Rik" NA "2D22" "Bssp" ...
 $ chromosome_name                      : chr  "5" "16" "15" "7" ...
 $ gene_biotype                         : chr  "protein_coding" "protein_coding" "protein_coding" "protein_coding" ...
 $ phenotype_description                : chr  "abnormal circulating amino acid level" "abnormal lipid homeostasis" "abnormal skin morphology" "abnormal cytokine level" ...
 $ hsapiens_homolog_associated_gene_name: chr  "ASL" "APOD" "CYP2D6" "KLK6" ...</code></pre>
</div>
</section><section><h2 class="section-heading" id="inspection-des-objets-data-frame">Inspection des objets <code>data.frame</code>
<a class="anchor" aria-label="anchor" href="#inspection-des-objets-data-frame"></a>
</h2>
<hr class="half-width">
<p>Nous avons déjà vu comment les fonctions <code>head()</code> et
<code>str()</code> peuvent être utiles pour vérifier le contenu et la
structure d’un data frame. Voici une liste non exhaustive de fonctions
pour avoir une idée du contenu ou de la structure des données.
Essayons-les !</p>
<p><strong>Dimension</strong> :</p>
<ul>
<li>
<code>dim(rna)</code> - renvoie un vecteur avec le nombre de lignes
comme premier élément et le nombre de colonnes comme deuxième élément
(les <strong>dim</strong>ensions de l’objet).</li>
<li>
<code>nrow(rna)</code> - renvoie le nombre de lignes.</li>
<li>
<code>ncol(rna)</code> - renvoie le nombre de colonnes.</li>
</ul>
<p><strong>Contenu</strong> :</p>
<ul>
<li>
<code>head(rna)</code> - affiche les 6 premières lignes.</li>
<li>
<code>tail(rna)</code> - affiche les 6 dernières lignes.</li>
</ul>
<p><strong>Noms</strong> :</p>
<ul>
<li>
<code>names(rna)</code> - renvoie les noms de colonnes (synonyme de
<code>colnames()</code> pour les objets <code>data.frame</code>).</li>
<li>
<code>rownames(rna)</code> - renvoie les noms de lignes.</li>
</ul>
<p><strong>Résumé</strong> :</p>
<ul>
<li>
<code>str(rna)</code> - structure de l’objet et informations sur la
classe , longueur et contenu de chaque colonne.</li>
<li>
<code>summary(rna)</code> - statistiques récapitulatives pour chaque
colonne.</li>
</ul>
<p>Remarque : la plupart de ces fonctions sont “génériques”,
c’est-à-dire qu’elles peuvent être utilisées sur d’autres types d’objets
en plus des objets <code>data.frame</code>.</p>
<div id="défi" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Sur la base du résultat de <code>str(rna)</code>, pouvez-vous
répondre aux questions suivantes ?</p>
<ul>
<li>Quelle est la classe de l’objet <code>rna</code> ?</li>
<li>Combien de lignes et combien de colonnes y a-t-il dans cet
objet ?</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ul>
<li>classe : data frame</li>
<li>Nombre de lignes : 66465, Nombre de colonnes : 11</li>
</ul>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="indexation-et-création-de-sous-ensembles-de-data-frames">Indexation et création de sous-ensembles de data frames<a class="anchor" aria-label="anchor" href="#indexation-et-cr%C3%A9ation-de-sous-ensembles-de-data-frames"></a>
</h2>
<hr class="half-width">
<p>Notre data frame « rna » comporte des lignes et des colonnes (il a 2
dimensions) ; si nous voulons en extraire des données spécifiques, nous
devons spécifier les “coordonnées” que nous voulons. Les numéros de
ligne viennent en premier, suivis des numéros de colonne. Cependant,
notez qu’il y a différentes manières de spécifier ces coordonnées,
conduisant à des résultats avec des classes différentes.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># premier élément de la première colonne du bloc de données (sous forme de vecteur)</span></span>
<span><span class="va">rna</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="co"># premier élément de la 6ème colonne (sous forme de vecteur)</span></span>
<span><span class="va">rna</span> <span class="op">[</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">]</span></span>
<span><span class="co"># première colonne du bloc de données (sous forme de vecteur)</span></span>
<span><span class="va">rna</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="co"># première colonne du bloc de données (sous forme de data.frame )</span></span>
<span><span class="va">rna</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co"># les trois premiers éléments de la 7ème colonne (en tant que vecteur)</span></span>
<span><span class="va">rna</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">7</span><span class="op">]</span></span>
<span><span class="co"># la 3ème ligne de la trame de données (en tant que data.frame)</span></span>
<span><span class="va">rna</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span></span>
<span><span class="co"># équivalent à head_rna &lt;- head(rna)</span></span>
<span><span class="va">head_rna</span> <span class="op">&lt;-</span> <span class="va">rna</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="op">]</span></span>
<span><span class="va">head_rna</span></span></code></pre>
</div>
<p><code>:</code> est une fonction spéciale qui crée des vecteurs
numériques d’entiers dans un ordre croissant ou décroissant. Testez
<code>1:10</code> et <code>10:1</code> par exemple. Voir section <span class="citation">@ref</span>(sec:genvec) pour plus de détails.</p>
<p>Vous pouvez également exclure certains indices d’un data frame à
l’aide du signe “<code>-</code>” :</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="co">## La trame de données entière, sauf la première colonne</span></span>
<span><span class="va">rna</span><span class="op">[</span><span class="op">-</span><span class="fu">c</span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fl">66465</span><span class="op">)</span>, <span class="op">]</span> <span class="co">## Équivalent à head(rna)</span></span></code></pre>
</div>
<p>L’on peut créer des sous-ensembles à partir des data frames en
utilisant des indices (comme vu précédemment), mais aussi en appelant
directement les noms de colonnes à extraire :</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span><span class="op">[</span><span class="st">"gene"</span><span class="op">]</span>       <span class="co"># Result is a data.frame</span></span>
<span><span class="va">rna</span><span class="op">[</span>, <span class="st">"gene"</span><span class="op">]</span>     <span class="co"># Result is a vector</span></span>
<span><span class="va">rna</span><span class="op">[[</span><span class="st">"gene"</span><span class="op">]</span><span class="op">]</span>     <span class="co"># Result is a vector</span></span>
<span><span class="va">rna</span><span class="op">$</span><span class="va">gene</span>          <span class="co"># Result is a vector</span></span></code></pre>
</div>
<p>Dans RStudio, vous pouvez utiliser la fonctionnalité de saisie
automatique pour obtenir les noms complets et corrects des colonnes.</p>
<div id="défi-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-1" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Créez un <code>data.frame</code> (<code>rna_200</code>) contenant
uniquement les données de la ligne 200 du jeu de données
<code>rna</code>.</p></li>
<li><p>Notez comment <code>nrow()</code> vous a donné le nombre de
lignes dans un <code>data.frame</code> ?</p></li>
</ol>
<ul>
<li><p>Utilisez ce chiffre pour extraire uniquement la dernière ligne du
data frame initial <code>rna</code>.</p></li>
<li><p>Comparez ceci avec la dernière ligne du data frame en utilisant
<code>tail()</code> pour s’assurer d’obtenir des résultats
identiques.</p></li>
<li><p>Extrayez à présent cette dernière ligne en utilisant
<code>nrow()</code> au lieu du numéro de ligne.</p></li>
<li><p>Créez un nouveau data frame (<code>rna_last</code>) à partir de
cette dernière ligne.</p></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><p>Utilisez <code>nrow()</code> pour extraire la ligne qui se trouve
au milieu du data frame <code>rna</code>. Stockez le contenu de cette
ligne dans un objet nommé <code>rna_middle</code>.</p></li>
<li><p>Combinez <code>nrow()</code> avec la notation <code>-</code>
ci-dessus pour reproduire le comportement de <code>head(rna)</code>, en
conservant uniquement les lignes 1 à 6 du data frame
<code>rna</code>.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 1.</span></span>
<span><span class="va">rna_200</span> <span class="op">&lt;-</span> <span class="va">rna</span><span class="op">[</span><span class="fl">200</span>, <span class="op">]</span></span>
<span><span class="co">## 2.</span></span>
<span><span class="co">## Sauvegarde de `n_rows` pour améliorer la lisibilité et réduire la duplication</span></span>
<span><span class="va">n_rows</span> <span class="op">&lt;</span> <span class="op">-</span> <span class="fu">nrow</span><span class="op">(</span><span class="va">rna</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'n_rows' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_last</span> <span class="op">&lt;-</span> <span class="va">rna</span><span class="op">[</span><span class="va">n_rows</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'n_rows' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 3.</span></span>
<span><span class="va">rna_middle</span> <span class="op">&lt;-</span> <span class="va">rna</span><span class="op">[</span><span class="va">n_rows</span> <span class="op">/</span> <span class="fl">2</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'n_rows' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 4 .</span></span>
<span><span class="va">rna_head</span> <span class="op">&lt;-</span> <span class="va">rna</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="va">n_rows</span><span class="op">)</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'n_rows' not found</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="facteurs">Facteurs<a class="anchor" aria-label="anchor" href="#facteurs"></a>
</h2>
<hr class="half-width">
<p>Les facteurs représentent des <strong>données catégorielles</strong>.
Ils sont stockés sous forme d’entiers (integer) avec des étiquettes
associées et ils peuvent être ordonnés ou non. Alors que les facteurs
ressemblent (et se comportent souvent) comme des vecteurs de caractères,
ils sont en réalité traités comme des vecteurs entiers par R. Vous devez
donc être très prudent lorsque vous les traitez comme des chaînes.</p>
<p>Une fois créés, les facteurs ne peuvent contenir qu’un ensemble
prédéfini de valeurs ou <em>niveaux</em>. Par défaut, R trie toujours
les niveaux par ordre alphabétique. Par exemple, si vous avez un facteur
à 2 niveaux :</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sexe</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"mâle"</span>, <span class="st">"femelle"</span>, <span class="st">"femelle"</span>, <span class="st">"mâle"</span>, <span class="st">"femelle"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>R va assigner <code>1</code> au niveau <code>"female"</code> et
<code>2</code> au niveau <code>"male"</code> (puisque <code>f</code>
vient avant <code>m</code>, même si le premier élément de ce vecteur est
<code>"male"</code>). Vous pouvez le vérifier en utilisant la fonction
<code>levels()</code> et vous pouvez trouver le nombre de niveaux en
utilisant <code>nlevels()</code> :</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">niveaux</span><span class="op">(</span><span class="va">sexe</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in niveaux(sexe): could not find function "niveaux"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nniveaux</span><span class="op">(</span><span class="va">sexe</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in nniveaux(sexe): could not find function "nniveaux"</code></pre>
</div>
<p>Parfois, l’ordre des facteurs n’a pas d’importance, d’autres fois
vous pourriez vouloir spécifier l’ordre car il est pertinent (par
exemple, “faible”, “moyen”, “élevé”), il améliore votre visualisation,
ou il est requis par un type particulier d’analyse. Ici, une façon de
réorganiser nos niveaux dans le vecteur <code>sex</code> serait :</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sex</span> <span class="co">## commande actuelle</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'sex' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="va">sex</span>,levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'sex' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sex</span> <span class="co">## après la nouvelle commande</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'sex' not found</code></pre>
</div>
<p>Ces facteurs sont représentés par des entiers (ex: 1, 2, 3) dans la
mémoire de R mais ils sont plus informatifs que les entiers car les
facteurs se décrivent d’eux-mêmes : <code>"female"</code>,
<code>"male"</code> est plus descriptif que <code>1</code>,
<code>2</code>. Lequel est « male » ? Vous ne seriez pas en mesure de le
savoir uniquement à partir des données entières . Les facteurs, en
revanche, intègrent cette information. Ceci est particulièrement utile
lorsqu’il existe de nombreux niveaux (comme le biotype du gène dans
notre exemple d’ensemble de données).</p>
<p>Lorsque vos données sont stockées sous forme de facteur, vous pouvez
utiliser la fonction <code>plot()</code> pour obtenir un aperçu rapide
du nombre d’observations représenté par chaque niveau de facteur.
Regardons le nombre d’hommes et de femmes dans nos données.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">intrigue</span> <span class="op">(</span><span class="va">sexe</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in intrigue(sexe): could not find function "intrigue"</code></pre>
</div>
<div class="section level3">
<h3 id="conversion-en-chaîne-de-caractères">Conversion en chaîne de caractères<a class="anchor" aria-label="anchor" href="#conversion-en-cha%C3%AEne-de-caract%C3%A8res"></a>
</h3>
<p>Un facteur peut être converti en vecteur caractère, vous pouvez
utiliser la fonction <code>as.character(x)</code>.</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">as.personnage</span> <span class="op">(</span><span class="va">sexe</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in as.personnage(sexe): could not find function "as.personnage"</code></pre>
</div>
<!-- ### Numeric factors -->
<!-- Converting factors where the levels appear as numbers (such as -->
<!-- concentration levels, or years) to a numeric vector is a little -->
<!-- trickier. The `as.numeric()` function returns the index values of the -->
<!-- factor, not its levels, so it will result in an entirely new (and -->
<!-- unwanted in this case) set of numbers.  One method to avoid this is to -->
<!-- convert factors to characters, and then to numbers.  Another method is -->
<!-- to use the `levels()` function. Compare: -->
<!-- ```{r} -->
<!-- year_fct <- factor(c(1990, 1983, 1977, 1998, 1990)) -->
<!-- as.numeric(year_fct)  ## Wrong! And there is no warning... -->
<!-- as.numeric(as.character(year_fct)) ## Works... -->
<!-- as.numeric(levels(year_fct))[year_fct] ## The recommended way. -->
<!-- ```

<!-- Notice that in the `levels()` approach, three important steps occur: -->
<!-- * We obtain all the factor levels using `levels(year_fct)` -->
<!-- * We convert these levels to numeric values using `as.numeric(levels(year_fct))` -->
<!-- * We then access these numeric values using the underlying integers of the -->
<!--   vector `year_fct` inside the square brackets -->
</div>
<div class="section level3">
<h3 id="renommer-les-facteurs">Renommer les facteurs<a class="anchor" aria-label="anchor" href="#renommer-les-facteurs"></a>
</h3>
<p>Si l’on veut renommer ces facteurs, il suffit de changer ses niveaux
avec la fonction <code>levels()</code> :</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">niveaux</span><span class="op">(</span><span class="va">sexe</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in niveaux(sexe): could not find function "niveaux"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">niveaux</span><span class="op">(</span><span class="va">sexe</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"M"</span>, <span class="st">"F"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in niveaux(sexe) &lt;- c("M", "F"): could not find function "niveaux&lt;-"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sexe</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] mâle    femelle femelle mâle    femelle
Levels: femelle mâle</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">intrigue</span><span class="op">(</span><span class="va">sexe</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in intrigue(sexe): could not find function "intrigue"</code></pre>
</div>
</div>
</section><div class="section level2 défi">
<h2 id="défi-2">Défi<a class="anchor" aria-label="anchor" href="#d%C3%A9fi-2"></a>
</h2>
<ul>
<li>Renommez <code>F</code> et <code>M</code> respectivement en
<code>Female</code> et <code>Male</code>.</li>
</ul>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">niveaux</span><span class="op">(</span><span class="va">sexe</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in niveaux(sexe): could not find function "niveaux"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">niveaux</span><span class="op">(</span><span class="va">sexe</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Homme"</span>, <span class="st">"Femme"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in niveaux(sexe) &lt;- c("Homme", "Femme"): could not find function "niveaux&lt;-"</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="défi-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-3" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Nous avons vu comment les data frame sont créés avec
<code>read.csv()</code>, mais ils peuvent également être créés à la main
avec la fonction <code>data.frame()</code>. Il y a quelques erreurs dans
ce <code>data.frame</code> construit manuellement. Pouvez-vous les
repérer et les corriger ? N’hésitez pas à expérimenter !</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>animal_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>       <span class="at">animal =</span> <span class="fu">c</span>(dog, cat, sea cucumber, sea urchin),</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>       <span class="at">feel =</span> <span class="fu">c</span>(<span class="st">"furry"</span>, <span class="st">"squishy"</span>, <span class="st">"spiny"</span>),</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>       <span class="at">weight =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">8</span> <span class="fl">1.1</span>, <span class="fl">0.8</span>))</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<ul>
<li>Les guillemets sont manquants autour des noms des animaux.</li>
<li>Il manque une entrée dans la colonne <code>feel</code> (probablement
pour l’un des animaux à fourrure).</li>
<li>Il manque une virgule dans la colonne <code>weight</code>.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="défi-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-4" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Pouvez-vous prédire la classe de chacune des colonnes dans l’exemple
suivant ?</p>
<p>Vérifiez vos suppositions en utilisant
<code>str(country_climate)</code> :</p>
<ul>
<li><p>Sont-ils ce à quoi vous vous attendiez ? Pourquoi? Pourquoi
pas?</p></li>
<li><p>Réessayez en ajoutant <code>stringsAsFactors = TRUE</code> après
la dernière variable lors de la création du data frame. Que se
passe-t-il à présent ? <code>stringsAsFactors</code> peut également être
défini lors de la lecture de feuilles de calcul basées sur du texte dans
R à l’aide de <code>read.csv()</code>.</p></li>
</ul>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">country_climate</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>       country <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Canada"</span>, <span class="st">"Panama"</span>, <span class="st">"Afrique du Sud"</span>, <span class="st">"Australie"</span><span class="op">)</span>,</span>
<span>       climat <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"froid"</span>, <span class="st">"chaud"</span> , <span class="st">"tempéré"</span>, <span class="st">"chaud/tempéré"</span><span class="op">)</span>,</span>
<span>       température <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">18</span>, <span class="st">"15"</span><span class="op">)</span>,</span>
<span>       hémisphère_nord <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">VRAI</span>, <span class="va">VRAI</span>, <span class="va">FAUX</span>, <span class="st">"FAUX"</span> <span class="op">)</span>,</span>
<span>       has_kangaroo <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">country_climate</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>       country <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Canada"</span>, <span class="st">"Panama"</span>, <span class="st">"Afrique du Sud"</span>, <span class="st">"Australie"</span><span class="op">)</span>,</span>
<span>       climat <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"froid"</span>, <span class="st">"chaud"</span> , <span class="st">"tempéré"</span>, <span class="st">"chaud/tempéré"</span><span class="op">)</span>,</span>
<span>       température <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">18</span>, <span class="st">"15"</span><span class="op">)</span>,</span>
<span>       hémisphère_nord <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">VRAI</span>, <span class="va">VRAI</span>, <span class="va">FAUX</span>, <span class="st">"FAUX"</span> <span class="op">)</span>,</span>
<span>       has_kangaroo <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>       <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'VRAI' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">country_climate</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'country_climate' not found</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>La conversion automatique du type de données est parfois une
bénédiction, parfois un désagrément. Sachez que cela existe, apprenez
les règles et vérifiez que les données que vous importez dans R sont du
bon type dans votre data frame. Sinon, utilisez-le à votre avantage pour
détecter les erreurs qui auraient pu être introduites lors de la saisie
des données (une lettre dans une colonne qui ne doit contenir que des
chiffres par exemple).</p>
<p>Apprenez-en plus dans ce tutoriel RStudio</p>
<section><h2 class="section-heading" id="matrices">Matrices<a class="anchor" aria-label="anchor" href="#matrices"></a>
</h2>
<hr class="half-width">
<p>Avant de continuer, maintenant que nous avons découvert les data
frames, récapitulons l’installation de packages et découvrons un nouveau
type de données, à savoir la classe <code>matrix</code>. Comme un objet
de classe <code>data.frame</code>, une matrice a deux dimensions, des
lignes et colonnes. La différence majeure est que toutes les cellules
d’une matrice doivent être du même type : « numérique », « caractère »,
« logique », … À cet égard, les matrices sont plus proches d’un vecteur
que d’un data frame.</p>
<p>Le constructeur par défaut d’une matrice est « matrix ». Le
remplissage de la matrice nécessite un vecteur de valeurs et de fixer le
nombre de lignes et/ou colonnes[^<code>ncol</code>]. Les valeurs sont
triées le long des colonnes, comme illustré ci-dessous.</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">matrice</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>, ncol <span class="op">=</span> <span class="fl">3</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in matrice(1:9, ncol = 3, nrow = 3): could not find function "matrice"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'm' not found</code></pre>
</div>
<div id="défi-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-5" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>À l’aide de la fonction <code>installed.packages()</code>, créez une
matrice caractère contenant les informations sur tous les packages
actuellement installés sur votre ordinateur. Explorez-la.</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="do">## créer la matrice</span></span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>ip <span class="ot">&lt;-</span> <span class="fu">Installed.packages</span>()</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a><span class="fu">head</span>(ip)</span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a><span class="do">## essayez aussi View(ip)</span></span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a><span class="do">## numéro de paquet</span></span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a><span class="fu">nrow</span>(ip)</span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a><span class="do">## noms de tous les packages installés</span></span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a><span class="fu">rownames</span>(ip)</span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a><span class="do">## type d'informations dont nous disposons sur chaque package</span></span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>noms de <span class="fu">colonnes</span> (ip)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Il est souvent utile de créer de grandes matrices de données
aléatoires comme données de test. L’exercice ci-dessous vous demande de
créer une telle matrice avec des données aléatoires tirées d’une
distribution normale de moyenne 0 et d’écart type 1, ce qui peut être
fait avec la fonction <code>rnorm()</code>.</p>
<div id="défi-6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-6" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Construire une matrice de dimension 1000 (nombre de lignes) par 3
(nombre de colonnes) de données normalement distribuées (moyenne 0,
écart type 1).</p>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7"> Show me the solution </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" data-bs-parent="#accordionSolution7" aria-labelledby="headingSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">matrice</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">3000</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in matrice(rnorm(3000), ncol = 3): could not find function "matrice"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'm' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tête</span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in tête(m): could not find function "tête"</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="formatage-des-dates">Formatage des dates<a class="anchor" aria-label="anchor" href="#formatage-des-dates"></a>
</h2>
<hr class="half-width">
<p>L’un des problèmes les plus courants rencontrés par les nouveaux (et
les plus expérimentés !) utilisateurs de R concerne la conversion des
informations de date et d’heure en une variable appropriée et utilisable
lors des analyses.</p>
<div class="section level3">
<h3 id="remarque-sur-les-dates-dans-les-tableurs">Remarque sur les dates dans les tableurs<a class="anchor" aria-label="anchor" href="#remarque-sur-les-dates-dans-les-tableurs"></a>
</h3>
<p>Les dates dans les feuilles de calcul sont généralement stockées dans
une seule colonne. Bien que cela semble la manière la plus naturelle
d’enregistrer des dates, ce ne fait en réalité pas partie des bonnes
pratiques. Un tableur affichera les dates d’une manière apparemment
correcte (pour un observateur humain), mais la façon dont il gère et
stocke réellement les dates peut être problématique. Il est souvent plus
sûr de stocker les dates avec ANNÉE, MOIS et JOUR dans des colonnes
séparées ou comme ANNÉE et JOUR DE L’ANNÉE dans des colonnes
séparées.</p>
<p>Des tableurs tels que LibreOffice, Microsoft Excel, OpenOffice,
Gnumeric, … ont des manières différentes (et souvent incompatibles)
d’encoder les dates (même pour le même programme entre les versions et
les systèmes d’exploitation). De plus, Excel peut <a href="https://nsaunders.wordpress.com/2012/10/22/gene-name-errors-and-excel-lessons-not%20-learned/" class="external-link">transformer
des éléments qui ne sont pas des dates en dates</a> (<span class="citation">@Zeeberg:2004</span>), par exemple des noms ou des
identifiants comme MAR1, DEC1, OCT4. Donc, si vous évitez de façon
générale le format date, il est plus facile d’identifier ces
problèmes.</p>
<p>La section Dates as data de la leçon Data Carpentry fournit des
informations supplémentaires sur les pièges des dates avec des feuilles
de calcul.</p>
<p>Nous allons utiliser la fonction <code>ymd()</code> du package
<strong><code>lubridate</code></strong> (qui appartient au
<strong><code>tidyverse</code></strong> ; en savoir plus [ici] (<a href="https://www.tidyverse.org/" class="external-link uri">https://www.tidyverse.org/</a>)). .
<strong><code>lubridate</code></strong> est automatiquement installé
lors de l’installation de <strong><code>tidyverse</code></strong>.
Lorsque vous chargez le <strong><code>tidyverse</code></strong>
(commande <code><a href="https://tidyverse.tidyverse.org" class="external-link">library(tidyverse)</a></code>), les packages de base (les
packages utilisés dans la plupart des analyses de données) sont chargés.
<strong><code>lubridate</code></strong> n’appartient cependant pas aux
fonctionnalités de base de tidyverse, vous devez donc le charger
explicitement avec <code><a href="https://lubridate.tidyverse.org" class="external-link">library(lubridate)</a></code>.</p>
<p>Commencez par charger le package requis :</p>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">bibliothèque</span><span class="op">(</span><span class="st">"lubrifier"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in bibliothèque("lubrifier"): could not find function "bibliothèque"</code></pre>
</div>
<p><code>ymd()</code> prend un vecteur représentant l’année, le mois et
le jour, et le convertit en un vecteur <code>Date</code>.
<code>Date</code> est une classe de données reconnue par R comme étant
une date et peut être manipulée comme telle. L’argument requis par la
fonction est flexible, mais, à titre de bonnes pratiques, il s’agit d’un
vecteur de caractère au format “AAAA-MM-JJ”.</p>
<p>Créons un objet date et inspectons la structure :</p>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ma_date</span> <span class="op">&lt;-</span> <span class="fu">ymd</span><span class="op">(</span><span class="st">"2015-01-01"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ymd("2015-01-01"): could not find function "ymd"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb69">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">ma_date</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'ma_date' not found</code></pre>
</div>
<p>Collons maintenant l’année, le mois et le jour séparément - nous
obtenons le même résultat :</p>
<div class="codewrapper sourceCode" id="cb71">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sep indique le caractère à utiliser pour séparer chaque composant</span></span>
<span><span class="va">my_date</span> <span class="op">&lt;-</span> <span class="fu">ymd</span><span class="op">(</span><span class="fu">paste</span><span class="op">(</span><span class="st">"2015"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ymd(paste("2015", "1", "1", sep = "-")): could not find function "ymd"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb73">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">my_date</span> <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'my_date' not found</code></pre>
</div>
<p>Familiarisons-nous maintenant avec un pipeline typique de
manipulation de date . Le data frame ci-dessous a stocké des dates dans
différentes colonnes « year », « month » et « jour ».</p>
<div class="codewrapper sourceCode" id="cb75">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>année <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1996</span>, <span class="fl">1992</span>, <span class="fl">1987</span>, <span class="fl">1986</span>, <span class="fl">2000</span>, <span class="fl">1990</span>, <span class="fl">2002</span>, <span class="fl">1994</span>, <span class="fl">1997</span>, <span class="fl">1985</span><span class="op">)</span>,</span>
<span>                mois <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">10</span>, <span class="fl">1</span> , <span class="fl">8</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>                jour <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">24</span>, <span class="fl">8</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">17</span>, <span class="fl">13</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">24</span><span class="op">)</span>,</span>
<span>                valeur <span class="op">=</span> <span class="fu">c</span> <span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">9</span>, <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">2</span>, <span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   année mois jour valeur
1   1996    2   24      4
2   1992    3    8      5
3   1987    3    1      1
4   1986   10    5      9
5   2000    1    8      3
6   1990    8   17      8
7   2002    3   13     10
8   1994    4   10      2
9   1997    5   11      6
10  1985    5   24      7</code></pre>
</div>
<p>Nous appliquons maintenant cette fonction à l’ensemble du jeu de
données « x ». Nous créons d’abord un vecteur de caractères à partir des
colonnes <code>year</code>, <code>month</code> et <code>day</code> de
<code>x</code> en utilisant <code>paste()</code> :</p>
<div class="codewrapper sourceCode" id="cb77">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">coller</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">year</span>, <span class="va">x</span><span class="op">$</span><span class="va">month</span>, <span class="va">x</span><span class="op">$</span><span class="va">day</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in coller(x$year, x$month, x$day, sep = "-"): could not find function "coller"</code></pre>
</div>
<p>Ce vecteur de caractères peut être utilisé comme argument pour
<code>ymd()</code> :</p>
<div class="codewrapper sourceCode" id="cb79">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ymd</span><span class="op">(</span><span class="fu">coller</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">year</span>, <span class="va">x</span><span class="op">$</span><span class="va">month</span>, <span class="va">x</span><span class="op">$</span><span class="va">day</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ymd(coller(x$year, x$month, x$day, sep = "-")): could not find function "ymd"</code></pre>
</div>
<p>Le vecteur <code>Date</code> résultant peut être ajouté à
<code>x</code> en tant que nouvelle colonne appelée
<code>date</code> :</p>
<div class="codewrapper sourceCode" id="cb81">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;-</span> <span class="fu">ymd</span><span class="op">(</span><span class="fu">paste</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">year</span>, <span class="va">x</span><span class="op">$</span><span class="va">month</span>, <span class="va">x</span><span class="op">$</span><span class="va">day</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ymd(paste(x$year, x$month, x$day, sep = "-")): could not find function "ymd"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb83">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># remarquez la nouvelle colonne, avec 'date' comme classe</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>'data.frame':	10 obs. of  4 variables:
 $ année : num  1996 1992 1987 1986 2000 ...
 $ mois  : num  2 3 3 10 1 8 3 4 5 5
 $ jour  : num  24 8 1 5 8 17 13 10 11 24
 $ valeur: num  4 5 1 9 3 8 10 2 6 7</code></pre>
</div>
<p>Assurons-nous que tout a fonctionné correctement. Une façon
d’inspecter la nouvelle colonne est d’utiliser la fonction
<code>summary()</code> :</p>
<div class="codewrapper sourceCode" id="cb85">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">résumé</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in résumé(x$date): could not find function "résumé"</code></pre>
</div>
<p>Notez que <code>ymd()</code> s’attend à avoir successivement l’année,
le mois et le jour. Si vous avez par exemple le jour, le mois et
l’année, vous aurez besoin de la fonction <code>dmy()</code>.</p>
<div class="codewrapper sourceCode" id="cb87">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dmy</span><span class="op">(</span><span class="fu">coller</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">day</span>, <span class="va">x</span><span class="op">$</span><span class="va">month</span>, <span class="va">x</span><span class="op">$</span><span class="va">year</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in dmy(coller(x$day, x$month, x$year, sep = "-")): could not find function "dmy"</code></pre>
</div>
<p><code>lubdridate</code> a de nombreuses fonctions pour gérer toutes
les variantes de date.</p>
</div>
</section><section><h2 class="section-heading" id="résumé-des-objets-r">Résumé des objets R<a class="anchor" aria-label="anchor" href="#r%C3%A9sum%C3%A9-des-objets-r"></a>
</h2>
<hr class="half-width">
<p>Jusqu’à présent, nous avons vu plusieurs types d’objets R variant
selon le nombre de dimensions et s’ils pouvaient stocker un ou plusieurs
types de données  :</p>
<ul>
<li>
<strong><code>vector</code></strong> : une dimension (ils ont une
longueur), un seul type de données.</li>
<li>
<strong><code>matrix</code></strong> : deux dimensions, un seul type
de données.</li>
<li>
<strong><code>data.frame</code></strong> : deux dimensions, un type
par colonne.</li>
</ul></section><section><h2 class="section-heading" id="listes">Listes<a class="anchor" aria-label="anchor" href="#listes"></a>
</h2>
<hr class="half-width">
<p>Un type de données que nous n’avons pas encore vu, mais qu’il est
utile de connaître, et découle du résumé que nous venons de voir sont
des listes (classe <code>list</code>) :</p>
<ul>
<li>
<strong><code>list</code></strong> : une dimension, chaque élément
peut être d’un type de données différent .</li>
</ul>
<p>Ci-dessous, créons une liste contenant un vecteur de nombres, de
caractères, une matrice, un data frame et une autre liste :</p>
<div class="codewrapper sourceCode" id="cb89">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="co">## numérique</span></span>
<span>          <span class="va">lettres</span>, <span class="co">## caractère</span></span>
<span>          <span class="fu">installé.packages</span><span class="op">(</span><span class="op">)</span>, <span class="co">## une matrice</span></span>
<span>          <span class="va">voitures</span>, <span class="co">## un data.frame</span></span>
<span>          <span class="fu">liste</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="co">## une liste</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'lettres' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb91">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">longueur</span><span class="op">(</span><span class="va">l</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in longueur(l): could not find function "longueur"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb93">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">l</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'l' not found</code></pre>
</div>
<p>L’indiçage (i.e. la réalisation d’un sous-ensemble) de liste est
effectué en utilisant <code>[]</code> pour créer une nouvelle sous-liste
ou <code>[[]]</code> pour extraire un seul élément de cette liste (en
utilisant des indices ou des noms si la liste possède un attribut de
nom).</p>
<div class="codewrapper sourceCode" id="cb95">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co">## premier élément</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'l' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb97">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="co">## une liste de longueur 2</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'l' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb99">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co">## une liste de longueur 1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'l' not found</code></pre>
</div>
</section><section><h2 class="section-heading" id="sec:exportandsave">Exportation et sauvegarde de données tabulaires<a class="anchor" aria-label="anchor" href="#sec:exportandsave"></a>
</h2>
<hr class="half-width">
<p>Nous avons vu comment lire une feuille de calcul textuelle dans R à
l’aide de la famille de fonctions <code>read.table</code>. Pour exporter
un <code>data.frame</code> vers une feuille de calcul texte , nous
pouvons utiliser l’ensemble de fonctions <code>write.table</code>
(<code>write.csv</code>, <code>write.delim</code>, …). Ils ont tous pour
arguments la variable à exporter et le fichier vers lequel exporter. Par
exemple, pour exporter les données <code>rna</code> vers le fichier
<code>my_rna.csv</code> dans le répertoire <code>data_output</code>,
nous exécuterions :</p>
<div class="codewrapper sourceCode" id="cb101">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write.csv</span><span class="op">(</span><span class="va">rna</span>, file <span class="op">=</span> <span class="st">"data_output/my_rna.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>Ce nouveau fichier csv peut maintenant être partagé avec d’autres
collaborateurs qui ne sont pas familiers avec R. Notez que même s’il y a
des virgules dans certains des champs dans le <code>data.frame</code>
(voir par exemple la colonne “product”), R entourera par défaut chaque
champ de texte avec des guillemets. Nous serons donc en mesure de le
lire à nouveau dans R correctement, malgré l’utilisation de virgules
comme séparateurs de colonnes.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Données tabulaires dans R</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-30-dplyr"><p>Content from <a href="30-dplyr.html">Manipulation et analyse de données avec dplyr</a></p>
<hr>
<p>Last updated on 2025-05-05 |

        <a href="https://github.com/carpentries-incubator/bioc-intro/edit/main/episodes/30-dplyr.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 150 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Analyse de données en R à l’aide du méta-package (paquet)
tidyverse</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Décrire l’objectif des packages <strong><code>dplyr</code></strong>
et <strong><code>tidyr</code></strong>.</li>
<li>Décrire plusieurs fonctions extrêmement utiles pour manipuler des
données.</li>
<li>Décrire le concept d’un tableau large et long, et comment remodeler
un tableau d’un format à l’autre.</li>
<li>Montrer comment joindre des tables.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<blockquote>
<p>Cet épisode est basé sur la leçon <em>Data Analysis and Visualisation
in R for Ecologists</em> de Data Carpentries.</p>
</blockquote>
<section><h2 class="section-heading" id="manipulation-des-données-avec-dplyr-et-tidyr">Manipulation des données avec <strong><code>dplyr</code></strong> et
<strong><code>tidyr</code></strong>
<a class="anchor" aria-label="anchor" href="#manipulation-des-donn%C3%A9es-avec-dplyr-et-tidyr"></a>
</h2>
<hr class="half-width">
<p>Extraire un sous-ensemble avec les crochets est pratique, mais peut
être fastidieux et difficile à lire, en particulier pour les opérations
compliquées.</p>
<p>Certains packages peuvent grandement faciliter notre tâche lorsque
nous manipulons des données. Les packages dans R sont essentiellement
des ensembles de fonctions supplémentaires qui vous permettent de faire
plus de choses. Les fonctions que nous avons utilisées jusqu’à présent,
comme <code>str()</code> ou <code>data.frame()</code>, sont intégrées à
R ; le chargement de packages donne accès à d’autres fonctions
spécifiques. Avant d’utiliser un package pour la première fois, vous
devez l’installer sur votre machine, puis vous devez l’importer à chaque
session R suivante lorsque vous en avez besoin.</p>
<ul>
<li><p>Le package <strong><code>dplyr</code></strong> fournit des outils
puissants pour les tâches de manipulation de données. Il est conçu pour
fonctionner directement avec des data frames, avec de nombreuses tâches
de manipulation optimisées.</p></li>
<li><p>Comme nous le verrons plus loin, nous souhaitons parfois qu’un
data frame soit remodelé pour pouvoir effectuer des analyses spécifiques
ou pour la visualisation. Le package <strong><code>tidyr</code></strong>
résout ce problème courant de remodelage des données et fournit des
outils pour une manipulation <em>tidy</em> des données, c’est-à-dire
selon les principes du <em>tidyverse</em>.</p></li>
</ul>
<p>Pour en savoir plus sur <strong><code>dplyr</code></strong> et
<strong><code>tidyr</code></strong>, vous voudrez consulter l’
aide-mémoire sur la transformation de données pratique avec ** et celui
sur .</p>
<ul>
<li>Le package <strong><code>tidyverse</code></strong> est un “package
parapluie” qui installe plusieurs packages utiles pour l’analyse des
données qui fonctionnent bien ensemble, tels que
<strong><code>tidyr</code></strong>, * *<code>dplyr</code>**,
<strong><code>ggplot2</code></strong>,
<strong><code>tibble</code></strong>, etc. Ces packages nous aident à
travailler et à interagir avec les données. Ils nous permettent de faire
beaucoup de choses avec nos données, comme en extraire des
sous-ensembles, les transformer, les visualiser, etc.</li>
</ul>
<p>Si vous avez configuré RStudio, vous devriez déjà avoir installé le
package tidyverse. Vérifiez si vous l’avez en essayant de le charger
depuis la librarie (library) :</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## load the tidyverse packages, incl. dplyr</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></span></code></pre>
</div>
<p>Si vous recevez un message d’erreur
<code>aucun package nommé 'tidyverse' n'est trouvé</code> alors vous
n’avez pas installé le package pour cette version de R. Pour installer
le package <strong><code>tidyverse</code></strong>, tapez :</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></span></code></pre>
</div>
<p>Si vous avez dû installer le package
<strong><code>tidyverse</code></strong>, n’oubliez pas de le charger
dans cette session R en utilisant la commande <code>library()</code>
ci-dessus !</p>
</section><section><h2 class="section-heading" id="chargement-de-données-avec-le-tidyverse">Chargement de données avec le tidyverse<a class="anchor" aria-label="anchor" href="#chargement-de-donn%C3%A9es-avec-le-tidyverse"></a>
</h2>
<hr class="half-width">
<p>Au lieu d’utiliser la fonction <code>read.csv()</code>, nous allons
lire nos données avec la fonction <code>read_csv()</code> (notez le
<code>_</code> au lieu du <code>.</code>) du package
<strong><code>readr</code></strong> du tidyverse.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/rnaseq.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## view the data</span></span>
<span><span class="va">rna</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 32,428 × 19
   gene    sample  expression organism   age sex   infection strain  time tissue
   &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
 1 Asl     GSM254…       1170 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 2 Apod    GSM254…      36194 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 3 Cyp2d22 GSM254…       4060 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 4 Klk6    GSM254…        287 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 5 Fcrls   GSM254…         85 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 6 Slc2a4  GSM254…        782 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 7 Exd2    GSM254…       1619 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 8 Gjc2    GSM254…        288 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 9 Plp1    GSM254…      43217 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
10 Gnb4    GSM254…       1071 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
# ℹ 32,418 more rows
# ℹ 9 more variables: mouse &lt;dbl&gt;, ENTREZID &lt;dbl&gt;, product &lt;chr&gt;,
#   ensembl_gene_id &lt;chr&gt;, external_synonym &lt;chr&gt;, chromosome_name &lt;chr&gt;,
#   gene_biotype &lt;chr&gt;, phenotype_description &lt;chr&gt;,
#   hsapiens_homolog_associated_gene_name &lt;chr&gt;</code></pre>
</div>
<p>Notez que la classe de la variable est désormais appelée
“tibble”.</p>
<p>Les tibbles modifient certains comportements des objets data frame
que nous avons introduits précédemment. La structure des données est
très similaire à un data frame. Pour nos besoins, les seules différences
sont les suivantes :</p>
<ol style="list-style-type: decimal">
<li><p>Il affiche le type de données de chaque colonne sous son nom.
Notez que &lt;<code>dbl</code>&gt; est un type de données défini pour
contenir des valeurs numériques décimales.</p></li>
<li><p>Il imprime uniquement les premières lignes de données et
seulement les colonnes affichables à l’écran.</p></li>
</ol>
<p>Nous allons maintenant apprendre les fonctions
<strong><code>dplyr</code></strong> les plus courantes :</p>
<ul>
<li>
<code>select()</code> : extraire des sous-ensembles de colonnes</li>
<li>
<code>filter()</code> : extraire des sous-ensembles de lignes</li>
<li>
<code>mutate()</code> : crée de nouvelles colonnes en utilisant les
informations de colonnes préexistantes</li>
<li>
<code>group_by()</code> et <code>summarise()</code> : créent des
statistiques récapitulatives sur des données groupées</li>
<li>
<code>arrange()</code> : trier les résultats</li>
<li>
<code>count()</code> : compte des valeurs discrètes</li>
</ul></section><section><h2 class="section-heading" id="sélection-de-colonnes-et-filtrage-de-lignes">Sélection de colonnes et filtrage de lignes<a class="anchor" aria-label="anchor" href="#s%C3%A9lection-de-colonnes-et-filtrage-de-lignes"></a>
</h2>
<hr class="half-width">
<p>Pour sélectionner les colonnes d’un bloc de données, utilisez
<code>select()</code>. Le premier argument de cette fonction est le
dataframe (<code>rna</code>), et les arguments suivants reprennent les
colonnes à conserver.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">select</span><span class="op">(</span><span class="va">rna</span>, <span class="va">gene</span>, <span class="va">sample</span>, <span class="va">tissue</span>, <span class="va">expression</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 32,428 × 4
   gene    sample     tissue     expression
   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;           &lt;dbl&gt;
 1 Asl     GSM2545336 Cerebellum       1170
 2 Apod    GSM2545336 Cerebellum      36194
 3 Cyp2d22 GSM2545336 Cerebellum       4060
 4 Klk6    GSM2545336 Cerebellum        287
 5 Fcrls   GSM2545336 Cerebellum         85
 6 Slc2a4  GSM2545336 Cerebellum        782
 7 Exd2    GSM2545336 Cerebellum       1619
 8 Gjc2    GSM2545336 Cerebellum        288
 9 Plp1    GSM2545336 Cerebellum      43217
10 Gnb4    GSM2545336 Cerebellum       1071
# ℹ 32,418 more rows</code></pre>
</div>
<p>Pour sélectionner toutes les colonnes <em>sauf</em> certaines, mettez
un “-” devant la variable à exclure.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">select</span><span class="op">(</span><span class="va">rna</span>, <span class="op">-</span><span class="va">tissue</span>, <span class="op">-</span><span class="va">organism</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 32,428 × 17
   gene    sample   expression   age sex   infection strain  time mouse ENTREZID
   &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
 1 Asl     GSM2545…       1170     8 Fema… Influenz… C57BL…     8    14   109900
 2 Apod    GSM2545…      36194     8 Fema… Influenz… C57BL…     8    14    11815
 3 Cyp2d22 GSM2545…       4060     8 Fema… Influenz… C57BL…     8    14    56448
 4 Klk6    GSM2545…        287     8 Fema… Influenz… C57BL…     8    14    19144
 5 Fcrls   GSM2545…         85     8 Fema… Influenz… C57BL…     8    14    80891
 6 Slc2a4  GSM2545…        782     8 Fema… Influenz… C57BL…     8    14    20528
 7 Exd2    GSM2545…       1619     8 Fema… Influenz… C57BL…     8    14    97827
 8 Gjc2    GSM2545…        288     8 Fema… Influenz… C57BL…     8    14   118454
 9 Plp1    GSM2545…      43217     8 Fema… Influenz… C57BL…     8    14    18823
10 Gnb4    GSM2545…       1071     8 Fema… Influenz… C57BL…     8    14    14696
# ℹ 32,418 more rows
# ℹ 7 more variables: product &lt;chr&gt;, ensembl_gene_id &lt;chr&gt;,
#   external_synonym &lt;chr&gt;, chromosome_name &lt;chr&gt;, gene_biotype &lt;chr&gt;,
#   phenotype_description &lt;chr&gt;, hsapiens_homolog_associated_gene_name &lt;chr&gt;</code></pre>
</div>
<p>Cela sélectionnera toutes les variables de <code>rna</code> sauf
<code>tissue</code> et <code>organism</code>.</p>
<p>Pour choisir des lignes en fonction d’un critère spécifique, utilisez
<code>filter()</code> :</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">filter</span><span class="op">(</span><span class="va">rna</span>, <span class="va">sex</span> <span class="op">==</span> <span class="st">"Male"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 14,740 × 19
   gene    sample  expression organism   age sex   infection strain  time tissue
   &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
 1 Asl     GSM254…        626 Mus mus…     8 Male  Influenz… C57BL…     4 Cereb…
 2 Apod    GSM254…      13021 Mus mus…     8 Male  Influenz… C57BL…     4 Cereb…
 3 Cyp2d22 GSM254…       2171 Mus mus…     8 Male  Influenz… C57BL…     4 Cereb…
 4 Klk6    GSM254…        448 Mus mus…     8 Male  Influenz… C57BL…     4 Cereb…
 5 Fcrls   GSM254…        180 Mus mus…     8 Male  Influenz… C57BL…     4 Cereb…
 6 Slc2a4  GSM254…        313 Mus mus…     8 Male  Influenz… C57BL…     4 Cereb…
 7 Exd2    GSM254…       2366 Mus mus…     8 Male  Influenz… C57BL…     4 Cereb…
 8 Gjc2    GSM254…        310 Mus mus…     8 Male  Influenz… C57BL…     4 Cereb…
 9 Plp1    GSM254…      53126 Mus mus…     8 Male  Influenz… C57BL…     4 Cereb…
10 Gnb4    GSM254…       1355 Mus mus…     8 Male  Influenz… C57BL…     4 Cereb…
# ℹ 14,730 more rows
# ℹ 9 more variables: mouse &lt;dbl&gt;, ENTREZID &lt;dbl&gt;, product &lt;chr&gt;,
#   ensembl_gene_id &lt;chr&gt;, external_synonym &lt;chr&gt;, chromosome_name &lt;chr&gt;,
#   gene_biotype &lt;chr&gt;, phenotype_description &lt;chr&gt;,
#   hsapiens_homolog_associated_gene_name &lt;chr&gt;</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">filter</span><span class="op">(</span><span class="va">rna</span>, <span class="va">sex</span> <span class="op">==</span> <span class="st">"Male"</span> <span class="op">&amp;</span> <span class="va">infection</span> <span class="op">==</span> <span class="st">"NonInfected"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 4,422 × 19
   gene    sample  expression organism   age sex   infection strain  time tissue
   &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
 1 Asl     GSM254…        535 Mus mus…     8 Male  NonInfec… C57BL…     0 Cereb…
 2 Apod    GSM254…      13668 Mus mus…     8 Male  NonInfec… C57BL…     0 Cereb…
 3 Cyp2d22 GSM254…       2008 Mus mus…     8 Male  NonInfec… C57BL…     0 Cereb…
 4 Klk6    GSM254…       1101 Mus mus…     8 Male  NonInfec… C57BL…     0 Cereb…
 5 Fcrls   GSM254…        375 Mus mus…     8 Male  NonInfec… C57BL…     0 Cereb…
 6 Slc2a4  GSM254…        249 Mus mus…     8 Male  NonInfec… C57BL…     0 Cereb…
 7 Exd2    GSM254…       3126 Mus mus…     8 Male  NonInfec… C57BL…     0 Cereb…
 8 Gjc2    GSM254…        791 Mus mus…     8 Male  NonInfec… C57BL…     0 Cereb…
 9 Plp1    GSM254…      98658 Mus mus…     8 Male  NonInfec… C57BL…     0 Cereb…
10 Gnb4    GSM254…       2437 Mus mus…     8 Male  NonInfec… C57BL…     0 Cereb…
# ℹ 4,412 more rows
# ℹ 9 more variables: mouse &lt;dbl&gt;, ENTREZID &lt;dbl&gt;, product &lt;chr&gt;,
#   ensembl_gene_id &lt;chr&gt;, external_synonym &lt;chr&gt;, chromosome_name &lt;chr&gt;,
#   gene_biotype &lt;chr&gt;, phenotype_description &lt;chr&gt;,
#   hsapiens_homolog_associated_gene_name &lt;chr&gt;</code></pre>
</div>
<p>Imaginons maintenant que nous nous intéressions aux homologues
humains des gènes de souris analysés dans ces données. Ces informations
se trouvent dans la dernière colonne du tibble <code>rna</code>, nommée
<code>hsapiens_homolog_associated_gene_name</code>. Pour le visualiser
facilement, nous allons créer un nouveau tableau contenant uniquement
les 2 colonnes <code>gene</code> et
<code>hsapiens_homolog_associated_gene_name</code>.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu">select</span><span class="op">(</span><span class="va">rna</span>, <span class="va">gene</span>, <span class="va">hsapiens_homolog_associated_gene_name</span><span class="op">)</span></span>
<span><span class="va">genes</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 32,428 × 2
   gene    hsapiens_homolog_associated_gene_name
   &lt;chr&gt;   &lt;chr&gt;
 1 Asl     ASL
 2 Apod    APOD
 3 Cyp2d22 CYP2D6
 4 Klk6    KLK6
 5 Fcrls   FCRL2
 6 Slc2a4  SLC2A4
 7 Exd2    EXD2
 8 Gjc2    GJC2
 9 Plp1    PLP1
10 Gnb4    GNB4
# ℹ 32,418 more rows</code></pre>
</div>
<p>Certains gènes de souris n’ont pas d’homologues humains. Ceux-ci
peuvent être récupérés en utilisant <code>filter()</code> et la fonction
<code>is.na()</code>, qui détermine si quelque chose est un
<code>NA</code>.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">filter</span><span class="op">(</span><span class="va">genes</span>, <span class="fu">is.na</span><span class="op">(</span><span class="va">hsapiens_homolog_associated_gene_name</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 4,290 × 2
   gene     hsapiens_homolog_associated_gene_name
   &lt;chr&gt;    &lt;chr&gt;
 1 Prodh    &lt;NA&gt;
 2 Tssk5    &lt;NA&gt;
 3 Vmn2r1   &lt;NA&gt;
 4 Gm10654  &lt;NA&gt;
 5 Hexa     &lt;NA&gt;
 6 Sult1a1  &lt;NA&gt;
 7 Gm6277   &lt;NA&gt;
 8 Tmem198b &lt;NA&gt;
 9 Adam1a   &lt;NA&gt;
10 Ebp      &lt;NA&gt;
# ℹ 4,280 more rows</code></pre>
</div>
<p>Si on veut conserver uniquement les gènes de souris qui ont un
homologue humain, on peut utiliser “!” qui inverse le résultat logique
pour demander chaque ligne où
<code>hsapiens\_homolog\_associated\_gene\_name</code> <em>n’est
pas</em> un <code>NA</code>.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">filter</span><span class="op">(</span><span class="va">genes</span>, <span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">hsapiens_homolog_associated_gene_name</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 28,138 × 2
   gene    hsapiens_homolog_associated_gene_name
   &lt;chr&gt;   &lt;chr&gt;
 1 Asl     ASL
 2 Apod    APOD
 3 Cyp2d22 CYP2D6
 4 Klk6    KLK6
 5 Fcrls   FCRL2
 6 Slc2a4  SLC2A4
 7 Exd2    EXD2
 8 Gjc2    GJC2
 9 Plp1    PLP1
10 Gnb4    GNB4
# ℹ 28,128 more rows</code></pre>
</div>
</section><section><h2 class="section-heading" id="pipes">Pipes<a class="anchor" aria-label="anchor" href="#pipes"></a>
</h2>
<hr class="half-width">
<p>Comment faire si vous souhaitez sélectionner et filtrer en même
temps ? Il existe trois façons de procéder : utiliser des étapes
intermédiaires, des fonctions imbriquées ou des <em>pipes</em>.</p>
<p>Avec des étapes intermédiaires, vous créez un data frame temporaire
et l’utilisez comme entrée de la fonction suivante, comme ceci :</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna2</span> <span class="op">&lt;-</span> <span class="fu">filter</span><span class="op">(</span><span class="va">rna</span>, <span class="va">sex</span> <span class="op">==</span> <span class="st">"Male"</span><span class="op">)</span></span>
<span><span class="va">rna3</span> <span class="op">&lt;-</span> <span class="fu">select</span><span class="op">(</span><span class="va">rna2</span>, <span class="va">gene</span>, <span class="va">sample</span>, <span class="va">tissue</span>, <span class="va">expression</span><span class="op">)</span></span>
<span><span class="va">rna3</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 14,740 × 4
   gene    sample     tissue     expression
   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;           &lt;dbl&gt;
 1 Asl     GSM2545340 Cerebellum        626
 2 Apod    GSM2545340 Cerebellum      13021
 3 Cyp2d22 GSM2545340 Cerebellum       2171
 4 Klk6    GSM2545340 Cerebellum        448
 5 Fcrls   GSM2545340 Cerebellum        180
 6 Slc2a4  GSM2545340 Cerebellum        313
 7 Exd2    GSM2545340 Cerebellum       2366
 8 Gjc2    GSM2545340 Cerebellum        310
 9 Plp1    GSM2545340 Cerebellum      53126
10 Gnb4    GSM2545340 Cerebellum       1355
# ℹ 14,730 more rows</code></pre>
</div>
<p>Ceci est lisible, mais peut encombrer votre espace de travail avec de
nombreux objets intermédiaires que vous devez nommer individuellement.
Avec beaucoup d’étapes, cette approche devient difficile à suivre.</p>
<p>Vous pouvez également imbriquer des fonctions (c’est-à-dire une
fonction dans une autre), comme ceci :</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna3</span> <span class="op">&lt;-</span> <span class="fu">select</span><span class="op">(</span><span class="fu">filter</span><span class="op">(</span><span class="va">rna</span>, <span class="va">sex</span> <span class="op">==</span> <span class="st">"Male"</span><span class="op">)</span>, <span class="va">gene</span>, <span class="va">sample</span>, <span class="va">tissue</span>, <span class="va">expression</span><span class="op">)</span></span>
<span><span class="va">rna3</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 14,740 × 4
   gene    sample     tissue     expression
   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;           &lt;dbl&gt;
 1 Asl     GSM2545340 Cerebellum        626
 2 Apod    GSM2545340 Cerebellum      13021
 3 Cyp2d22 GSM2545340 Cerebellum       2171
 4 Klk6    GSM2545340 Cerebellum        448
 5 Fcrls   GSM2545340 Cerebellum        180
 6 Slc2a4  GSM2545340 Cerebellum        313
 7 Exd2    GSM2545340 Cerebellum       2366
 8 Gjc2    GSM2545340 Cerebellum        310
 9 Plp1    GSM2545340 Cerebellum      53126
10 Gnb4    GSM2545340 Cerebellum       1355
# ℹ 14,730 more rows</code></pre>
</div>
<p>Cette approche est pratique, mais peut être difficile à lire si trop
de fonctions sont imbriquées, car R évalue l’expression de l’intérieur
vers l’extérieur (dans ce cas, filtrer, puis sélectionner).</p>
<p>La dernière option, le <em>pipe</em>, est un ajout plus récent à R.
Un <em>pipe</em> permet de prendre la sortie d’une fonction et de la
passer directement à la suivante. Cette approche est utile lorsque vous
devez faire beaucoup d’opérations sur le même jeu de données.</p>
<p>Les <em>pipes</em> dans R s’écrivent à <code>%&gt;%</code> (mis à
disposition via le package <code>magrittr</code>) ou <code>|&gt;</code>
(via R). Si vous utilisez RStudio, vous pouvez afficher un <em>pipe</em>
avec <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>M</kbd> sur un PC ou
<kbd>Cmd</kbd> + <kbd>Shift</kbd> + <kbd>M</kbd> sur un Mac.</p>
<p>Dans le code ci-dessus, nous utilisons le <em>pipe</em> pour passer
les données <code>rna</code> d’abord dans <code>filter()</code> pour
conserver les lignes où <code>sex</code> est égal à <code>"Male"</code>,
puis dans <code>select()</code> pour conserver uniquement les colonnes
<code>gene</code>, <code>sample</code>, <code>tissue</code> et
<code>expression</code>.</p>
<p>Le <em>pipe</em> <code>%&gt;%</code> prend l’objet à sa gauche et le
passe directement en tant que premier argument à la fonction à sa
droite. Nous n’avons donc plus besoin d’inclure explicitement les
données comme un argument pour les fonctions <code>filter()</code> et
<code>select()</code>.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"Male"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">gene</span>, <span class="va">sample</span>, <span class="va">tissue</span>, <span class="va">expression</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 14,740 × 4
   gene    sample     tissue     expression
   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;           &lt;dbl&gt;
 1 Asl     GSM2545340 Cerebellum        626
 2 Apod    GSM2545340 Cerebellum      13021
 3 Cyp2d22 GSM2545340 Cerebellum       2171
 4 Klk6    GSM2545340 Cerebellum        448
 5 Fcrls   GSM2545340 Cerebellum        180
 6 Slc2a4  GSM2545340 Cerebellum        313
 7 Exd2    GSM2545340 Cerebellum       2366
 8 Gjc2    GSM2545340 Cerebellum        310
 9 Plp1    GSM2545340 Cerebellum      53126
10 Gnb4    GSM2545340 Cerebellum       1355
# ℹ 14,730 more rows</code></pre>
</div>
<p>Certains trouveront peut-être utile de lire le <em>pipe</em> comme le
mot “ensuite”. Par exemple, dans l’exemple ci-dessus, nous avons pris le
data frame <code>rna</code>, <em>ensuite</em> nous avons
<code>filtré</code> pour les lignes avec <code>sex == "Male"</code>,
<em>ensuite</em> nous avons sélectionné les colonnes <code>gene</code>
<code>sample</code>, <code>tissue</code>, et
<code>expression</code>.</p>
<p>Les fonctions de <strong><code>dplyr</code></strong> sont
relativement simples, mais en les combinant avec le <em>pipe</em>, nous
pouvons accomplir des manipulations plus complexes.</p>
<p>Si nous voulons créer un nouvel objet avec cette version plus petite
des données, il suffit de lui attribuer un nouveau nom :</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna3</span> <span class="op">&lt;-</span> <span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"Male"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">gene</span>, <span class="va">sample</span>, <span class="va">tissue</span>, <span class="va">expression</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rna3</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 14,740 × 4
   gene    sample     tissue     expression
   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;           &lt;dbl&gt;
 1 Asl     GSM2545340 Cerebellum        626
 2 Apod    GSM2545340 Cerebellum      13021
 3 Cyp2d22 GSM2545340 Cerebellum       2171
 4 Klk6    GSM2545340 Cerebellum        448
 5 Fcrls   GSM2545340 Cerebellum        180
 6 Slc2a4  GSM2545340 Cerebellum        313
 7 Exd2    GSM2545340 Cerebellum       2366
 8 Gjc2    GSM2545340 Cerebellum        310
 9 Plp1    GSM2545340 Cerebellum      53126
10 Gnb4    GSM2545340 Cerebellum       1355
# ℹ 14,730 more rows</code></pre>
</div>
<div id="défi" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi" class="callout-inner">
<h3 class="callout-title">Défi:</h3>
<div class="callout-content">
<p>À l’aide de <em>pipes</em>, extraire un sous-ensemble de
<code>rna</code> pour ne conserver que les observations des souris
femelles au temps 0, où le gène a une expression supérieure à 50000, et
ne conservez que les colonnes <code>gene</code>, <code>sample</code>,
<code>time</code>, <code>expression</code> et <code>age</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">expression</span> <span class="op">&gt;</span> <span class="fl">50000</span>,</span>
<span>         <span class="va">sex</span> <span class="op">==</span> <span class="st">"Female"</span>,</span>
<span>         <span class="va">time</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">gene</span>, <span class="va">sample</span>, <span class="va">time</span>, <span class="va">expression</span>, <span class="va">age</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 9 × 5
  gene   sample      time expression   age
  &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;
1 Plp1   GSM2545337     0     101241     8
2 Atp1b1 GSM2545337     0      53260     8
3 Plp1   GSM2545338     0      96534     8
4 Atp1b1 GSM2545338     0      50614     8
5 Plp1   GSM2545348     0     102790     8
6 Atp1b1 GSM2545348     0      59544     8
7 Plp1   GSM2545353     0      71237     8
8 Glul   GSM2545353     0      52451     8
9 Atp1b1 GSM2545353     0      61451     8</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="mutate">Mutate<a class="anchor" aria-label="anchor" href="#mutate"></a>
</h2>
<hr class="half-width">
<p>Vous souhaiterez fréquemment créer de nouvelles colonnes basées sur
les valeurs des colonnes existantes, par exemple pour effectuer des
conversions d’unités ou pour trouver le rapport des valeurs dans deux
colonnes . Pour cela, nous utiliserons la fonction
<code>mutate()</code>.</p>
<p>Pour créer une nouvelle colonne de temps en heures :</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>time_hours <span class="op">=</span> <span class="va">time</span> <span class="op">*</span> <span class="fl">24</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">time</span>, <span class="va">time_hours</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 32,428 × 2
    time time_hours
   &lt;dbl&gt;      &lt;dbl&gt;
 1     8        192
 2     8        192
 3     8        192
 4     8        192
 5     8        192
 6     8        192
 7     8        192
 8     8        192
 9     8        192
10     8        192
# ℹ 32,418 more rows</code></pre>
</div>
<p>Vous pouvez également créer une deuxième nouvelle colonne basée sur
la première nouvelle colonne dans le même appel de
<code>mutate()</code> :</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>time_hours <span class="op">=</span> <span class="va">time</span> <span class="op">*</span> <span class="fl">24</span>,</span>
<span>         time_mn <span class="op">=</span> <span class="va">time_hours</span> <span class="op">*</span> <span class="fl">60</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">time</span>, <span class="va">time_hours</span>, <span class="va">time_mn</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 32,428 × 3
    time time_hours time_mn
   &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
 1     8        192   11520
 2     8        192   11520
 3     8        192   11520
 4     8        192   11520
 5     8        192   11520
 6     8        192   11520
 7     8        192   11520
 8     8        192   11520
 9     8        192   11520
10     8        192   11520
# ℹ 32,418 more rows</code></pre>
</div>
<div id="défi-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-1" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Créez un nouveau data frane à partir de <code>rna</code> qui répond
aux critères suivants : contient uniquement les colonnes
<code>gene</code>, <code>chromosome_name</code>,
<code>phenotype_description</code>, <code>sample</code> et
<code>expression</code>. Les valeurs d’expression doivent être
transformées en log. Ce data frame doit contenir uniquement des gènes
situés sur les chromosomes sexuels, ayant bien un
<code>phenotype \_description</code>, et une expression en log
supérieure à 5.</p>
<p><strong>Astuce</strong> : réfléchissez bien à la façon dont les
commandes doivent être ordonnées !</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>expression <span class="op">=</span> <span class="fu">log</span><span class="op">(</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">gene</span>, <span class="va">chromosome_name</span>, <span class="va">phenotype_description</span>, <span class="va">sample</span>, <span class="va">expression</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">chromosome_name</span> <span class="op">==</span> <span class="st">"X"</span> <span class="op">|</span> <span class="va">chromosome_name</span> <span class="op">==</span> <span class="st">"Y"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">phenotype_description</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">expression</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 649 × 5
   gene   chromosome_name phenotype_description                sample expression
   &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;                                &lt;chr&gt;       &lt;dbl&gt;
 1 Plp1   X               abnormal CNS glial cell morphology   GSM25…      10.7
 2 Slc7a3 X               decreased body length                GSM25…       5.46
 3 Plxnb3 X               abnormal coat appearance             GSM25…       6.58
 4 Rbm3   X               abnormal liver morphology            GSM25…       9.32
 5 Cfp    X               abnormal cardiovascular system phys… GSM25…       6.18
 6 Ebp    X               abnormal embryonic erythrocyte morp… GSM25…       6.68
 7 Cd99l2 X               abnormal cellular extravasation      GSM25…       8.04
 8 Piga   X               abnormal brain development           GSM25…       6.06
 9 Pim2   X               decreased T cell proliferation       GSM25…       7.11
10 Itm2a  X               no abnormal phenotype detected       GSM25…       7.48
# ℹ 639 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="analyse-de-données-split-apply-combine">Analyse de données “split-apply-combine”<a class="anchor" aria-label="anchor" href="#analyse-de-donn%C3%A9es-split-apply-combine"></a>
</h2>
<hr class="half-width">
<p>De nombreuses tâches d’analyse de données peuvent être abordées à
l’aide du paradigme <em>split-apply-combine</em> : divisez les données
en groupes, appliquez une analyse à chaque groupe, puis combinez les
résultats. <strong><code>dplyr</code></strong> rend cela très facile
grâce à l’utilisation de la fonction <code>group_by()</code>.</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">gene</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 32,428 × 19
# Groups:   gene [1,474]
   gene    sample  expression organism   age sex   infection strain  time tissue
   &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
 1 Asl     GSM254…       1170 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 2 Apod    GSM254…      36194 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 3 Cyp2d22 GSM254…       4060 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 4 Klk6    GSM254…        287 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 5 Fcrls   GSM254…         85 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 6 Slc2a4  GSM254…        782 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 7 Exd2    GSM254…       1619 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 8 Gjc2    GSM254…        288 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 9 Plp1    GSM254…      43217 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
10 Gnb4    GSM254…       1071 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
# ℹ 32,418 more rows
# ℹ 9 more variables: mouse &lt;dbl&gt;, ENTREZID &lt;dbl&gt;, product &lt;chr&gt;,
#   ensembl_gene_id &lt;chr&gt;, external_synonym &lt;chr&gt;, chromosome_name &lt;chr&gt;,
#   gene_biotype &lt;chr&gt;, phenotype_description &lt;chr&gt;,
#   hsapiens_homolog_associated_gene_name &lt;chr&gt;</code></pre>
</div>
<p>La fonction <code>group_by()</code> n’effectue aucun traitement de
données, elle regroupe simplement les données en sous-ensembles : dans
l’exemple ci-dessus, notre <code>tibble</code> initial de 32428
observations est divisé en 1474 groupes selon la variable
<code>gene</code>.</p>
<p>On pourrait de même décider de regrouper le tibble par
échantillons :</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 32,428 × 19
# Groups:   sample [22]
   gene    sample  expression organism   age sex   infection strain  time tissue
   &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
 1 Asl     GSM254…       1170 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 2 Apod    GSM254…      36194 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 3 Cyp2d22 GSM254…       4060 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 4 Klk6    GSM254…        287 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 5 Fcrls   GSM254…         85 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 6 Slc2a4  GSM254…        782 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 7 Exd2    GSM254…       1619 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 8 Gjc2    GSM254…        288 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 9 Plp1    GSM254…      43217 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
10 Gnb4    GSM254…       1071 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
# ℹ 32,418 more rows
# ℹ 9 more variables: mouse &lt;dbl&gt;, ENTREZID &lt;dbl&gt;, product &lt;chr&gt;,
#   ensembl_gene_id &lt;chr&gt;, external_synonym &lt;chr&gt;, chromosome_name &lt;chr&gt;,
#   gene_biotype &lt;chr&gt;, phenotype_description &lt;chr&gt;,
#   hsapiens_homolog_associated_gene_name &lt;chr&gt;</code></pre>
</div>
<p>Ici, notre <code>tibble</code> initial de 32428 observations est
divisé en 22 groupes selon la variable <code>sample</code>.</p>
<p>Une fois les données regroupées, les opérations qui suivent sont
appliquées sur chaque groupe indépendamment.</p>
<div class="section level3">
<h3 id="la-fonction-summarise">La fonction <code>summarise()</code>
<a class="anchor" aria-label="anchor" href="#la-fonction-summarise"></a>
</h3>
<p><code>group_by()</code> est souvent utilisé avec
<code>summarise()</code>, qui réduit chaque groupe en un résumé d’une
seule ligne.</p>
<p><code>group_by()</code> prend comme arguments les noms de colonnes
qui contiennent les variables <strong>catégorielles</strong> pour
lesquelles vous souhaitez calculer les statistiques récapitulatives.
Donc, pour calculer l’expression moyenne par gène :</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">gene</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_expression <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1,474 × 2
   gene     mean_expression
   &lt;chr&gt;              &lt;dbl&gt;
 1 AI504432         1053.
 2 AW046200          131.
 3 AW551984          295.
 4 Aamp             4751.
 5 Abca12              4.55
 6 Abcc8            2498.
 7 Abhd14a           525.
 8 Abi2             4909.
 9 Abi3bp           1002.
10 Abl2             2124.
# ℹ 1,464 more rows</code></pre>
</div>
<p>Nous pourrions également vouloir calculer les niveaux d’expression
moyens de tous les gènes dans chaque échantillon :</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">sample</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_expression <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 22 × 2
   sample     mean_expression
   &lt;chr&gt;                &lt;dbl&gt;
 1 GSM2545336           2062.
 2 GSM2545337           1766.
 3 GSM2545338           1668.
 4 GSM2545339           1696.
 5 GSM2545340           1682.
 6 GSM2545341           1638.
 7 GSM2545342           1594.
 8 GSM2545343           2107.
 9 GSM2545344           1712.
10 GSM2545345           1700.
# ℹ 12 more rows</code></pre>
</div>
<p>On peut également regrouper les observations par plusieurs
colonnes :</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">gene</span>, <span class="va">infection</span>, <span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_expression <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'gene', 'infection'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 4,422 × 4
# Groups:   gene, infection [2,948]
   gene     infection    time mean_expression
   &lt;chr&gt;    &lt;chr&gt;       &lt;dbl&gt;           &lt;dbl&gt;
 1 AI504432 InfluenzaA      4           1104.
 2 AI504432 InfluenzaA      8           1014
 3 AI504432 NonInfected     0           1034.
 4 AW046200 InfluenzaA      4            152.
 5 AW046200 InfluenzaA      8             81
 6 AW046200 NonInfected     0            155.
 7 AW551984 InfluenzaA      4            302.
 8 AW551984 InfluenzaA      8            342.
 9 AW551984 NonInfected     0            238
10 Aamp     InfluenzaA      4           4870
# ℹ 4,412 more rows</code></pre>
</div>
<p>Une fois les données regroupées, vous pouvez également résumer
plusieurs variables en même temps (et pas nécessairement sur la même
variable). Par exemple, nous pourrions ajouter une colonne indiquant
l’expression médiane par gène et par condition :</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">gene</span>, <span class="va">infection</span>, <span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_expression <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">expression</span><span class="op">)</span>,</span>
<span>            median_expression <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'gene', 'infection'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 4,422 × 5
# Groups:   gene, infection [2,948]
   gene     infection    time mean_expression median_expression
   &lt;chr&gt;    &lt;chr&gt;       &lt;dbl&gt;           &lt;dbl&gt;             &lt;dbl&gt;
 1 AI504432 InfluenzaA      4           1104.             1094.
 2 AI504432 InfluenzaA      8           1014               985
 3 AI504432 NonInfected     0           1034.             1016
 4 AW046200 InfluenzaA      4            152.              144.
 5 AW046200 InfluenzaA      8             81                82
 6 AW046200 NonInfected     0            155.              163
 7 AW551984 InfluenzaA      4            302.              245
 8 AW551984 InfluenzaA      8            342.              287
 9 AW551984 NonInfected     0            238               265
10 Aamp     InfluenzaA      4           4870              4708
# ℹ 4,412 more rows</code></pre>
</div>
<div id="défi-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-2" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Calculer le niveau d’expression moyen du gène “Dok3” pour chaque
temps.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">gene</span> <span class="op">==</span> <span class="st">"Dok3"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 2
   time  mean
  &lt;dbl&gt; &lt;dbl&gt;
1     0  169
2     4  156.
3     8   61 </code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="count">Count<a class="anchor" aria-label="anchor" href="#count"></a>
</h3>
<p>Lorsque nous travaillons avec des données, nous souhaitons souvent
connaître le nombre d’observations trouvées pour chaque facteur ou
combinaison de facteurs. Pour cette tâche,
<strong><code>dplyr</code></strong> fournit la fonction
<code>count()</code>. Par exemple, si nous voulons compter le nombre
d’observations pour chaque échantillon infecté et non infecté :</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">count</span><span class="op">(</span><span class="va">infection</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 2
  infection       n
  &lt;chr&gt;       &lt;int&gt;
1 InfluenzaA  22110
2 NonInfected 10318</code></pre>
</div>
<p>La fonction <code>count()</code> est un raccourci pour quelque chose
que nous avons déjà vu : regrouper par une variable et la résumer en
comptant le nombre d’observations dans ce groupe. En d’autres termes,
<code>rna %&gt;% count(infection)</code> équivaut à :</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">infection</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 2
  infection       n
  &lt;chr&gt;       &lt;int&gt;
1 InfluenzaA  22110
2 NonInfected 10318</code></pre>
</div>
<p>L’exemple précédent montre l’utilisation de <code>count()</code> pour
compter le nombre de lignes/observations pour <em>un</em> facteur
(c’est-à-dire <code>infection</code>). Pour compter une <em>combinaison
de facteurs</em>, telle que <code>infection</code> et <code>time</code>,
il suffit de spécifier les deux facteurs comme arguments de
<code>count()</code> :</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">count</span><span class="op">(</span><span class="va">infection</span>, <span class="va">time</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 3
  infection    time     n
  &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;
1 InfluenzaA      4 11792
2 InfluenzaA      8 10318
3 NonInfected     0 10318</code></pre>
</div>
<p>ce qui équivaut à ceci :</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">infection</span>, <span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'infection'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 3
# Groups:   infection [2]
  infection    time     n
  &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;
1 InfluenzaA      4 11792
2 InfluenzaA      8 10318
3 NonInfected     0 10318</code></pre>
</div>
<p>Il est parfois utile de trier le résultat pour faciliter les
comparaisons. Nous pouvons utiliser <code>arrange()</code> pour trier le
tableau. Par exemple, nous pourrions vouloir organiser le tableau
ci-dessus par temps :</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">infection</span>, <span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">time</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 3
  infection    time     n
  &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;
1 NonInfected     0 10318
2 InfluenzaA      4 11792
3 InfluenzaA      8 10318</code></pre>
</div>
<p>ou par comptage :</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">infection</span>, <span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 3
  infection    time     n
  &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;
1 InfluenzaA      8 10318
2 NonInfected     0 10318
3 InfluenzaA      4 11792</code></pre>
</div>
<p>Pour trier par ordre décroissant, nous devons ajouter la fonction
<code>desc()</code> :</p>
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">infection</span>, <span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 × 3
  infection    time     n
  &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;
1 InfluenzaA      4 11792
2 InfluenzaA      8 10318
3 NonInfected     0 10318</code></pre>
</div>
<div id="défi-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-3" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Combien de gènes ont été analysés dans chaque échantillon ?</li>
<li>Utilisez <code>group_by()</code> et <code>summarise()</code> pour
évaluer la profondeur de séquençage (la somme de tous les comptes) dans
chaque échantillon. Quel échantillon a la profondeur de séquençage la
plus élevée ?</li>
<li>Choisissez un échantillon et évaluez le nombre de gènes par
biotype.</li>
<li>Identifiez les gènes associés à la description du phénotype
“abnormal DNA methylation” et calculez leur expression moyenne (en log)
au temps 0, 4 et 8.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb66">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 1.</span></span>
<span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 22 × 2
   sample         n
   &lt;chr&gt;      &lt;int&gt;
 1 GSM2545336  1474
 2 GSM2545337  1474
 3 GSM2545338  1474
 4 GSM2545339  1474
 5 GSM2545340  1474
 6 GSM2545341  1474
 7 GSM2545342  1474
 8 GSM2545343  1474
 9 GSM2545344  1474
10 GSM2545345  1474
# ℹ 12 more rows</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 2.</span></span>
<span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">sample</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>seq_depth <span class="op">=</span> <span class="fu">sum</span><span class="op">(</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">seq_depth</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 22 × 2
   sample     seq_depth
   &lt;chr&gt;          &lt;dbl&gt;
 1 GSM2545350   3255566
 2 GSM2545352   3216163
 3 GSM2545343   3105652
 4 GSM2545336   3039671
 5 GSM2545380   3036098
 6 GSM2545353   2953249
 7 GSM2545348   2913678
 8 GSM2545362   2913517
 9 GSM2545351   2782464
10 GSM2545349   2758006
# ℹ 12 more rows</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 3.</span></span>
<span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">sample</span> <span class="op">==</span> <span class="st">"GSM2545336"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">gene_biotype</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 13 × 2
   gene_biotype                           n
   &lt;chr&gt;                              &lt;int&gt;
 1 protein_coding                      1321
 2 lncRNA                                69
 3 processed_pseudogene                  59
 4 miRNA                                  7
 5 snoRNA                                 5
 6 TEC                                    4
 7 polymorphic_pseudogene                 2
 8 unprocessed_pseudogene                 2
 9 IG_C_gene                              1
10 scaRNA                                 1
11 transcribed_processed_pseudogene       1
12 transcribed_unitary_pseudogene         1
13 transcribed_unprocessed_pseudogene     1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 4.</span></span>
<span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">phenotype_description</span> <span class="op">==</span> <span class="st">"abnormal DNA methylation"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">gene</span>, <span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_expression <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="fu">log</span><span class="op">(</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'gene'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 3
# Groups:   gene [2]
  gene   time mean_expression
  &lt;chr&gt; &lt;dbl&gt;           &lt;dbl&gt;
1 Xist      0            6.95
2 Xist      4            6.34
3 Xist      8            7.13
4 Zdbf2     0            6.27
5 Zdbf2     4            6.27
6 Zdbf2     8            6.19</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="remodeler-les-données">Remodeler les données<a class="anchor" aria-label="anchor" href="#remodeler-les-donn%C3%A9es"></a>
</h2>
<hr class="half-width">
<p>Dans le tibble <code>rna</code>, les lignes contiennent des valeurs
d’expression qui sont associées à une combinaison de 2 autres variables
: <code>gene</code> et <code>sample</code>.</p>
<p>Toutes les autres colonnes correspondent à des variables décrivant
soit l’échantillon (organisme, âge, sexe, …) soit le gène
(‘gene_biotype’, ‘ENTREZ_ID’, ‘product’, …). Les variables qui ne
changent pas avec les gènes ou avec les échantillons auront la même
valeur dans toutes les lignes.</p>
<div class="codewrapper sourceCode" id="cb75">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">gene</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 32,428 × 19
   gene     sample expression organism   age sex   infection strain  time tissue
   &lt;chr&gt;    &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
 1 AI504432 GSM25…       1230 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 2 AI504432 GSM25…       1085 Mus mus…     8 Fema… NonInfec… C57BL…     0 Cereb…
 3 AI504432 GSM25…        969 Mus mus…     8 Fema… NonInfec… C57BL…     0 Cereb…
 4 AI504432 GSM25…       1284 Mus mus…     8 Fema… Influenz… C57BL…     4 Cereb…
 5 AI504432 GSM25…        966 Mus mus…     8 Male  Influenz… C57BL…     4 Cereb…
 6 AI504432 GSM25…        918 Mus mus…     8 Male  Influenz… C57BL…     8 Cereb…
 7 AI504432 GSM25…        985 Mus mus…     8 Fema… Influenz… C57BL…     8 Cereb…
 8 AI504432 GSM25…        972 Mus mus…     8 Male  NonInfec… C57BL…     0 Cereb…
 9 AI504432 GSM25…       1000 Mus mus…     8 Fema… Influenz… C57BL…     4 Cereb…
10 AI504432 GSM25…        816 Mus mus…     8 Male  Influenz… C57BL…     4 Cereb…
# ℹ 32,418 more rows
# ℹ 9 more variables: mouse &lt;dbl&gt;, ENTREZID &lt;dbl&gt;, product &lt;chr&gt;,
#   ensembl_gene_id &lt;chr&gt;, external_synonym &lt;chr&gt;, chromosome_name &lt;chr&gt;,
#   gene_biotype &lt;chr&gt;, phenotype_description &lt;chr&gt;,
#   hsapiens_homolog_associated_gene_name &lt;chr&gt;</code></pre>
</div>
<p>Cette structure est appelée “format long”, car une colonne contient
toutes les valeurs, et d’autres colonnes répertorient le contexte de la
valeur.</p>
<p>Dans certains cas, le “format long” n’est pas facile à lire, et un
autre format, un “format large” est préféré, comme manière plus compacte
de représenter les données. Cela est typiquement le cas pour des données
d’expression de gènes, qui sont généralement représentées sous forme de
matrice où les gènes sont repris le long des lignes et les échantillons
le long des colonnes.</p>
<p>Dans ce format, il devient donc simple d’explorer la relation entre
les niveaux d’expression génique au sein et entre les échantillons.</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1,474 × 23
   gene    GSM2545336 GSM2545337 GSM2545338 GSM2545339 GSM2545340 GSM2545341
   &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1 Asl           1170        361        400        586        626        988
 2 Apod         36194      10347       9173      10620      13021      29594
 3 Cyp2d22       4060       1616       1603       1901       2171       3349
 4 Klk6           287        629        641        578        448        195
 5 Fcrls           85        233        244        237        180         38
 6 Slc2a4         782        231        248        265        313        786
 7 Exd2          1619       2288       2235       2513       2366       1359
 8 Gjc2           288        595        568        551        310        146
 9 Plp1         43217     101241      96534      58354      53126      27173
10 Gnb4          1071       1791       1867       1430       1355        798
# ℹ 1,464 more rows
# ℹ 16 more variables: GSM2545342 &lt;dbl&gt;, GSM2545343 &lt;dbl&gt;, GSM2545344 &lt;dbl&gt;,
#   GSM2545345 &lt;dbl&gt;, GSM2545346 &lt;dbl&gt;, GSM2545347 &lt;dbl&gt;, GSM2545348 &lt;dbl&gt;,
#   GSM2545349 &lt;dbl&gt;, GSM2545350 &lt;dbl&gt;, GSM2545351 &lt;dbl&gt;, GSM2545352 &lt;dbl&gt;,
#   GSM2545353 &lt;dbl&gt;, GSM2545354 &lt;dbl&gt;, GSM2545362 &lt;dbl&gt;, GSM2545363 &lt;dbl&gt;,
#   GSM2545380 &lt;dbl&gt;</code></pre>
</div>
<p>Pour convertir les valeurs d’expression génique de <code>rna</code>
en un format large, nous devons créer une nouvelle table où les valeurs
de la colonne <code>sample</code> deviendraient les noms des variables
de colonne.</p>
<p>Nous <strong>remodellons</strong> les données en fonction des
observations d’intérêt, tout en continant à suivre les principles des
données tidy: niveaux d’expression par gène au lieu des les afficher par
gènes et par échantillons.</p>
<p>La transformation inverse serait de transformer les noms de colonnes
en valeurs d’une nouvelle variable.</p>
<p>Nous pouvons effectuer ces deux transformations avec deux fonctions
du package <code>tidyr</code>, à savoir <code>pivot_longer()</code> et
<code>pivot_wider()</code> (voir <a href="https://tidyr.tidyverse.org%20/dev/articles/pivot.html" class="external-link">ici</a>
pour détails).</p>
<div class="section level3">
<h3 id="pivoter-les-données-en-format-large">Pivoter les données en format large<a class="anchor" aria-label="anchor" href="#pivoter-les-donn%C3%A9es-en-format-large"></a>
</h3>
<p>Sélectionnons les 3 premières colonnes de <code>rna</code> et
utilisons <code>pivot_wider()</code> pour transformer les données en
format large.</p>
<div class="codewrapper sourceCode" id="cb78">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_exp</span> <span class="op">&lt;-</span> <span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">gene</span>, <span class="va">sample</span>, <span class="va">expression</span><span class="op">)</span></span>
<span><span class="va">rna_exp</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 32,428 × 3
   gene    sample     expression
   &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;
 1 Asl     GSM2545336       1170
 2 Apod    GSM2545336      36194
 3 Cyp2d22 GSM2545336       4060
 4 Klk6    GSM2545336        287
 5 Fcrls   GSM2545336         85
 6 Slc2a4  GSM2545336        782
 7 Exd2    GSM2545336       1619
 8 Gjc2    GSM2545336        288
 9 Plp1    GSM2545336      43217
10 Gnb4    GSM2545336       1071
# ℹ 32,418 more rows</code></pre>
</div>
<p><code>pivot_wider</code> prend trois arguments principaux :</p>
<ol style="list-style-type: decimal">
<li>les données à transformer ;</li>
<li>le <code>names_from</code> : la colonne dont les valeurs deviendront
les nouveaux noms de colonne ;</li>
<li>les <code>values_from</code> : la colonne dont les valeurs
rempliront les nouvelles colonnes.</li>
</ol>
<figure style="text-align: center"><img src="../fig/pivot_wider.png" alt="Grand pivot des données `rna`." class="figure mx-auto d-block"><figcaption>
Grand pivot des données <code>rna</code>.
</figcaption></figure><div class="codewrapper sourceCode" id="cb80">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_wide</span> <span class="op">&lt;-</span> <span class="va">rna_exp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">sample</span>,</span>
<span>              values_from <span class="op">=</span> <span class="va">expression</span><span class="op">)</span></span>
<span><span class="va">rna_wide</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1,474 × 23
   gene    GSM2545336 GSM2545337 GSM2545338 GSM2545339 GSM2545340 GSM2545341
   &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1 Asl           1170        361        400        586        626        988
 2 Apod         36194      10347       9173      10620      13021      29594
 3 Cyp2d22       4060       1616       1603       1901       2171       3349
 4 Klk6           287        629        641        578        448        195
 5 Fcrls           85        233        244        237        180         38
 6 Slc2a4         782        231        248        265        313        786
 7 Exd2          1619       2288       2235       2513       2366       1359
 8 Gjc2           288        595        568        551        310        146
 9 Plp1         43217     101241      96534      58354      53126      27173
10 Gnb4          1071       1791       1867       1430       1355        798
# ℹ 1,464 more rows
# ℹ 16 more variables: GSM2545342 &lt;dbl&gt;, GSM2545343 &lt;dbl&gt;, GSM2545344 &lt;dbl&gt;,
#   GSM2545345 &lt;dbl&gt;, GSM2545346 &lt;dbl&gt;, GSM2545347 &lt;dbl&gt;, GSM2545348 &lt;dbl&gt;,
#   GSM2545349 &lt;dbl&gt;, GSM2545350 &lt;dbl&gt;, GSM2545351 &lt;dbl&gt;, GSM2545352 &lt;dbl&gt;,
#   GSM2545353 &lt;dbl&gt;, GSM2545354 &lt;dbl&gt;, GSM2545362 &lt;dbl&gt;, GSM2545363 &lt;dbl&gt;,
#   GSM2545380 &lt;dbl&gt;</code></pre>
</div>
<p>Notez que par défaut, la fonction <code>pivot_wider()</code> ajoutera
<code>NA</code> pour les valeurs manquantes.</p>
<p>Imaginons que nous ayons des valeurs d’expression manquantes pour
certains gènes dans certains échantillons. Dans cet exemple, le gène
Cyp2d22 n’aune donnée d’expression que pour l’echantillon
GSM2545338.</p>
<p>Par défaut, la fonction <code>pivot_wider()</code> ajoutera
<code>NA</code> pour les valeurs manquantes. Ceci peut être paramétré
avec l’argument <code>values_fill</code> de la fonction
<code>pivot_wider()</code>.</p>
<div class="codewrapper sourceCode" id="cb82">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_with_missing_values</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">échantillon</span>,</span>
<span>              values_from <span class="op">=</span> <span class="va">expression</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'rna_with_missing_values' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb84">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_with_missing_values</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">échantillon</span>,</span>
<span>              values_from <span class="op">=</span> <span class="va">expression</span>,</span>
<span>              valeurs_fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'rna_with_missing_values' not found</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="pivoter-les-données-en-format-long">Pivoter les données en format long<a class="anchor" aria-label="anchor" href="#pivoter-les-donn%C3%A9es-en-format-long"></a>
</h3>
<p>Dans la situation inverse, nous utilisons les noms de colonnes et les
transformons en deux nouvelles variables. Une variable représente le nom
de colonne contenant les valeurs, et l’autre contenant les valeurs
précédemment associées aux noms de colonnes.</p>
<p><code>pivot_longer()</code> prend quatre arguments principaux :</p>
<ol style="list-style-type: decimal">
<li>les données à transformer ;</li>
<li>
<code>names_to</code> : le nouveau nom de colonne que nous
souhaitons créer et remplir avec les noms de colonnes actuels ;</li>
<li>
<code>values_to</code> : le nouveau nom de colonne que nous
souhaitons créer et remplir avec valeurs actuelles ;</li>
<li>les noms des colonnes à utiliser pour renseigner les variables
<code>names_to</code> et <code>values_to</code> (ou à ignorer).</li>
</ol>
<p><code>{r, fig.cap="Pivot long des données `rna`.", echo=FALSE, message=FALSE} knitr::include_graphics("fig/pivot_longer.png")</code></p>
<pre><code>
Pour créer `rna_long` à partir de `rna_wide`, nous créons une première variable `"sample"` qui conteindra les noms des échantillons repris comme noms de colonnes (hormi `gene`), et une seconde, `"expression"`, qui contiendra les valeurs de la table. Nous ommettons la colonne `gene` pour la transformation en y ajoutant le signe moins.

Notez que les nouveaux noms de colonnes sont repris entre guillemets.


``` r
rna_long &lt;- rna_wide %&gt;%
    pivot_longer(names_to = "sample",
                 values_to = "expression",
                 -gene)
rna_long</code></pre>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 32,428 × 3
   gene  sample     expression
   &lt;chr&gt; &lt;chr&gt;           &lt;dbl&gt;
 1 Asl   GSM2545336       1170
 2 Asl   GSM2545337        361
 3 Asl   GSM2545338        400
 4 Asl   GSM2545339        586
 5 Asl   GSM2545340        626
 6 Asl   GSM2545341        988
 7 Asl   GSM2545342        836
 8 Asl   GSM2545343        535
 9 Asl   GSM2545344        586
10 Asl   GSM2545345        597
# ℹ 32,418 more rows</code></pre>
</div>
<p>Nous aurions également pu spécifier les colonnes à inclure. Quand il
faut inclure un grand nombre de colonnes, et il est plus facile de
spécifier ce qu’il faut rassembler que ce qu’il faut ignorer. Ici, la
fonction <code>starts_with()</code> peut aider à récupérer des colonnes
sans avoir à toutes les énumérer ! Une autre possibilité serait
d’utiliser l’opérateur <code>:</code> !</p>
<div class="codewrapper sourceCode" id="cb88">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_wide</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">pivot_longer</span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"sample"</span>,</span>
<span>                 values_to <span class="op">=</span> <span class="st">"expression"</span>,</span>
<span>                 cols <span class="op">=</span> <span class="fu">start_with</span><span class="op">(</span><span class="st">"GSM"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in `pivot_longer()`:
ℹ In argument: `start_with("GSM")`.
Caused by error in `start_with()`:
! could not find function "start_with"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb90">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_wide</span> <span class="op">%&gt; %</span></span>
<span>    <span class="fu">pivot_longer</span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"sample"</span>,</span>
<span>                 valeurs_to <span class="op">=</span> <span class="st">"expression"</span>,</span>
<span>                 <span class="va">GSM2545336</span><span class="op">:</span><span class="va">GSM2545380</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in rna_wide %&gt; % pivot_longer(names_to = "sample", valeurs_to = "expression", : could not find function "%&gt; %"</code></pre>
</div>
<p>Notez que si nous avions des valeurs manquantes dans le format large,
le <code>NA</code> serait inclus dans le nouveau format long.</p>
<p>Souvenez-vous de notre précédent tibble fictif contenant des valeurs
manquantes :</p>
<div class="codewrapper sourceCode" id="cb92">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_with_missing_values</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'rna_with_missing_values' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb94">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wide_with_NA</span> <span class="op">&lt;-</span> <span class="va">rna_with_missing_values</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">sample</span>,</span>
<span>              values_from <span class="op">=</span> <span class="va">expression</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'rna_with_missing_values' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb96">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wide_with_NA</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'wide_with_NA' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb98">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wide_with_NA</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">pivot_longer</span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"sample"</span>,</span>
<span>                 values_to <span class="op">=</span> <span class="st">"expression"</span>,</span>
<span>                 <span class="op">-</span><span class="va">gene</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'wide_with_NA' not found</code></pre>
</div>
<p>Passer à des formats larges et longs peut être un moyen utile
d’équilibrer un ensemble de données afin que chaque réplique ait la même
composition.</p>
<div id="question" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="question" class="callout-inner">
<h3 class="callout-title">Question</h3>
<div class="callout-content">
<p>A partir de la table <code>rna</code>, utilisez la fonction
<code>pivot_wider()</code> pour créer un tableau au format large donnant
les niveaux d’expression génique chez chaque souris. Utilisez ensuite la
fonction <code>pivot_longer()</code> pour restaurer le tableau au format
long.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb100">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna1</span> <span class="op">&lt;-</span> <span class="va">rna</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">select</span><span class="op">(</span><span class="va">gene</span>, <span class="va">mouse</span>, <span class="va">expression</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">mouse</span>, values_from <span class="op">=</span> <span class="va">expression</span><span class="op">)</span></span>
<span><span class="va">rna1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1,474 × 23
   gene     `14`    `9`  `10`  `15`  `18`   `6`   `5`  `11`  `22`  `13`  `23`
   &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Asl      1170    361   400   586   626   988   836   535   586   597   938
 2 Apod    36194  10347  9173 10620 13021 29594 24959 13668 13230 15868 27769
 3 Cyp2d22  4060   1616  1603  1901  2171  3349  3122  2008  2254  2277  2985
 4 Klk6      287    629   641   578   448   195   186  1101   537   567   327
 5 Fcrls      85    233   244   237   180    38    68   375   199   177    89
 6 Slc2a4    782    231   248   265   313   786   528   249   266   357   654
 7 Exd2     1619   2288  2235  2513  2366  1359  1474  3126  2379  2173  1531
 8 Gjc2      288    595   568   551   310   146   186   791   454   370   240
 9 Plp1    43217 101241 96534 58354 53126 27173 28728 98658 61356 61647 38019
10 Gnb4     1071   1791  1867  1430  1355   798   806  2437  1394  1554   960
# ℹ 1,464 more rows
# ℹ 11 more variables: `24` &lt;dbl&gt;, `8` &lt;dbl&gt;, `7` &lt;dbl&gt;, `1` &lt;dbl&gt;, `16` &lt;dbl&gt;,
#   `21` &lt;dbl&gt;, `4` &lt;dbl&gt;, `2` &lt;dbl&gt;, `20` &lt;dbl&gt;, `12` &lt;dbl&gt;, `19` &lt;dbl&gt;</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb102">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna1</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">pivot_longer</span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"mouse_id"</span>, values_to <span class="op">=</span> <span class="st">"counts"</span>, <span class="op">-</span><span class="va">gene</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 32,428 × 3
   gene  mouse_id counts
   &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;
 1 Asl   14         1170
 2 Asl   9           361
 3 Asl   10          400
 4 Asl   15          586
 5 Asl   18          626
 6 Asl   6           988
 7 Asl   5           836
 8 Asl   11          535
 9 Asl   22          586
10 Asl   13          597
# ℹ 32,418 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="question-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="question-1" class="callout-inner">
<h3 class="callout-title">Question</h3>
<div class="callout-content">
<p>Extraire les gènes situés sur les chromosomes X et Y du data frame
<code>rna</code> et remodeler les données avec la variable
<code>sex</code> en colonnes et la varibale <code>chromosome_name</code>
en lignes et l’expression moyenne des gènes localisés dans chaque
chromosome comme valeurs, comme dans le tableau suivant :</p>
<figure><img src="../fig/Exercise_pivot_W.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Il faudra résumer avant de remodeler !</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<p>Calculons d’abord le niveau d’expression moyen des gènes des
chromosomes X et Y pour les échantillons mâles et femelles…</p>
<div class="codewrapper sourceCode" id="cb104">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">arn</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">chromosome_name</span> <span class="op">==</span> <span class="st">"Y"</span> <span class="op">|</span> <span class="va">chromosome_name</span> <span class="op">==</span> <span class="st">"X"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">sex</span>, <span class="va">chromosome_name</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">résumé</span><span class="op">(</span>moyenne <span class="op">=</span> <span class="fu">moyenne</span><span class="op">(</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in résumé(., moyenne = moyenne(expression)): could not find function "résumé"</code></pre>
</div>
<p>Et pivotons le tableau au format large</p>
<div class="codewrapper sourceCode" id="cb106">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_1</span> <span class="op">&lt;-</span> <span class="va">rna</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">chromosome_name</span> <span class="op">==</span> <span class="st">"Y"</span> <span class="op">|</span> <span class="va">chromosome_name</span> <span class="op">==</span> <span class="st">"X"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">sex</span>, <span class="va">chromosome_name</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu">moyenne</span><span class="op">(</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">sexe</span>,</span>
<span>              valeurs_from <span class="op">=</span> <span class="va">moyenne</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in `summarise()`:
ℹ In argument: `mean = moyenne(expression)`.
ℹ In group 1: `sex = "Female"` `chromosome_name = "X"`.
Caused by error in `moyenne()`:
! could not find function "moyenne"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb108">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'rna_1' not found</code></pre>
</div>
<p>Maintenant, prenez cette trame de données et transformez-la avec
<code>pivot_longer()</code> afin que chaque ligne soit une combinaison
unique de <code>chromosome_name</code> par <code>gender</code>.</p>
<div class="codewrapper sourceCode" id="cb110">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_1</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"gender"</span>,</span>
<span>               valeurs_to <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>               <span class="op">-</span><span class="va">chromosome_name</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'rna_1' not found</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in `pivot_longer()`:
! Arguments in `...` must be used.
✖ Problematic argument:
• valeurs_to = "mean"
ℹ Did you misspell an argument name?</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="question-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="question-2" class="callout-inner">
<h3 class="callout-title">Question</h3>
<div class="callout-content">
<p>Utilisez l’ensemble de données <code>rna</code> pour créer une
matrice d’expression où chaque ligne représente les niveaux d’expression
moyens des gènes et les colonnes représentent les différents temps.</p>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7"> Show me the solution </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" aria-labelledby="headingSolution7" data-bs-parent="#accordionSolution7">
<div class="accordion-body">
<p>Calculons d’abord l’expression moyenne par gène et par temps</p>
<div class="codewrapper sourceCode" id="cb113">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arn</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">gène</span>, <span class="va">temps</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">résumé</span><span class="op">(</span>mean_exp <span class="op">=</span> <span class="fu">moyenne</span><span class="op">(</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in résumé(., mean_exp = moyenne(expression)): could not find function "résumé"</code></pre>
</div>
<p>avant d’utiliser la fonction <code>pivot_wider()</code></p>
<div class="codewrapper sourceCode" id="cb115">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_time</span> <span class="op">&lt;-</span> <span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">gene</span>, <span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_exp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">time</span>,</span>
<span>              values_from <span class="op">=</span> <span class="va">mean_exp</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'gene'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb117">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_time</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1,474 × 4
# Groups:   gene [1,474]
   gene         `0`     `4`     `8`
   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 AI504432 1034.   1104.   1014
 2 AW046200  155.    152.     81
 3 AW551984  238     302.    342.
 4 Aamp     4603.   4870    4763.
 5 Abca12      5.29    4.25    4.14
 6 Abcc8    2576.   2609.   2292.
 7 Abhd14a   591.    547.    432.
 8 Abi2     4881.   4903.   4945.
 9 Abi3bp   1175.   1061.    762.
10 Abl2     2170.   2078.   2131.
# ℹ 1,464 more rows</code></pre>
</div>
<p>Notez que cela génère un tibble avec certains noms de colonnes
commençant par un nombre. Si nous voulions sélectionner la colonne
correspondant aux points temporels, nous ne pourrions pas utiliser
directement les noms des colonnes… Que se passe-t-il lorsque l’on
sélectionne la colonne 4 ?</p>
<div class="codewrapper sourceCode" id="cb119">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">gene</span>, <span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_exp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">time</span>,</span>
<span>              values_from <span class="op">=</span> <span class="va">mean_exp</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">gene</span>, <span class="fl">4</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'gene'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1,474 × 2
# Groups:   gene [1,474]
   gene         `8`
   &lt;chr&gt;      &lt;dbl&gt;
 1 AI504432 1014
 2 AW046200   81
 3 AW551984  342.
 4 Aamp     4763.
 5 Abca12      4.14
 6 Abcc8    2292.
 7 Abhd14a   432.
 8 Abi2     4945.
 9 Abi3bp    762.
10 Abl2     2131.
# ℹ 1,464 more rows</code></pre>
</div>
<p>Pour sélectionner le temp 4, il faudrait citer le nom de la colonne,
avec des <em>backticks</em> “\`”</p>
<div class="codewrapper sourceCode" id="cb122">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">gene</span>, <span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_exp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">time</span>,</span>
<span>              values_from <span class="op">=</span> <span class="va">mean_exp</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">gene</span>, <span class="va">`4`</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'gene'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1,474 × 2
# Groups:   gene [1,474]
   gene         `4`
   &lt;chr&gt;      &lt;dbl&gt;
 1 AI504432 1104.
 2 AW046200  152.
 3 AW551984  302.
 4 Aamp     4870
 5 Abca12      4.25
 6 Abcc8    2609.
 7 Abhd14a   547.
 8 Abi2     4903.
 9 Abi3bp   1061.
10 Abl2     2078.
# ℹ 1,464 more rows</code></pre>
</div>
<p>Une autre possibilité serait de renommer les colonnes, en choisissant
des noms qui ne commencent pas par un chiffre :</p>
<div class="codewrapper sourceCode" id="cb125">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">gene</span>, <span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_exp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">time</span>,</span>
<span>              values_from <span class="op">=</span> <span class="va">mean_exp</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span><span class="st">"time0"</span> <span class="op">=</span> <span class="va">`0`</span>, <span class="st">"time4"</span> <span class="op">=</span> <span class="va">`4`</span>, <span class="st">"time8"</span> <span class="op">=</span> <span class="va">`8`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">gene</span>, <span class="va">time4</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'gene'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1,474 × 2
# Groups:   gene [1,474]
   gene       time4
   &lt;chr&gt;      &lt;dbl&gt;
 1 AI504432 1104.
 2 AW046200  152.
 3 AW551984  302.
 4 Aamp     4870
 5 Abca12      4.25
 6 Abcc8    2609.
 7 Abhd14a   547.
 8 Abi2     4903.
 9 Abi3bp   1061.
10 Abl2     2078.
# ℹ 1,464 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="question-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="question-3" class="callout-inner">
<h3 class="callout-title">Question</h3>
<div class="callout-content">
<p>Utilisez le data frame précédent contenant les niveaux d’expression
moyens par temps et créez une nouvelle colonne contenant les
<em>fold-changes</em> entre les temps 8 et 0, et les temps 8 et 4.
Convertissez ce tableau en un tableau au format long regroupant les
<em>fold-changes</em> calculés.</p>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8"> Show me the solution </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" aria-labelledby="headingSolution8" data-bs-parent="#accordionSolution8">
<div class="accordion-body">
<p>À partir du tibble <code>rna_time</code> :</p>
<div class="codewrapper sourceCode" id="cb128">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arn_time</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'arn_time' not found</code></pre>
</div>
<p>Calculer les <em>fold-changes</em> :</p>
<div class="codewrapper sourceCode" id="cb130">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_time</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">muter</span> <span class="op">(</span>time_8_vs_0 <span class="op">=</span> <span class="va">`8`</span> <span class="op">/</span> <span class="va">`0`</span>, time_8_vs_4 <span class="op">=</span> <span class="va">`8`</span> <span class="op">/</span> <span class="va">`4`</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in muter(., time_8_vs_0 = `8`/`0`, time_8_vs_4 = `8`/`4`): could not find function "muter"</code></pre>
</div>
<p>Et utilisez la fonction <code>pivot_longer()</code> :</p>
<div class="codewrapper sourceCode" id="cb132">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_time</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>time_8_vs_0 <span class="op">=</span> <span class="va">`8`</span> <span class="op">/</span> <span class="va">`0`</span>, time_8_vs_4 <span class="op">=</span> <span class="va">`8`</span> <span class="op">/</span> <span class="va">`4`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"comparisons"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"Fold_changes"</span>,</span>
<span>               <span class="va">time_8_vs_0</span><span class="op">:</span><span class="va">time_8_vs_4</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2,948 × 6
# Groups:   gene [1,474]
   gene         `0`     `4`     `8` comparisons Fold_changes
   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt;
 1 AI504432 1034.   1104.   1014    time_8_vs_0        0.981
 2 AI504432 1034.   1104.   1014    time_8_vs_4        0.918
 3 AW046200  155.    152.     81    time_8_vs_0        0.522
 4 AW046200  155.    152.     81    time_8_vs_4        0.532
 5 AW551984  238     302.    342.   time_8_vs_0        1.44
 6 AW551984  238     302.    342.   time_8_vs_4        1.13
 7 Aamp     4603.   4870    4763.   time_8_vs_0        1.03
 8 Aamp     4603.   4870    4763.   time_8_vs_4        0.978
 9 Abca12      5.29    4.25    4.14 time_8_vs_0        0.784
10 Abca12      5.29    4.25    4.14 time_8_vs_4        0.975
# ℹ 2,938 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="jointures-de-tables">Jointures de tables<a class="anchor" aria-label="anchor" href="#jointures-de-tables"></a>
</h2>
<hr class="half-width">
<p>Dans de nombreuses situations réelles, les données sont réparties sur
plusieurs tables. Cela se produit généralement parce que différents
types d’informations sont collectés à partir de différentes sources.</p>
<p>Il peut être souhaitable que certaines analyses combinent les données
de deux ou plusieurs tables en un seul data frame basé sur une colonne
commune à toutes les tables.</p>
<p>Le package <code>dplyr</code> fournit un ensemble de fonctions de
jointure pour combiner deux data frames en fonction des correspondances
entre les colonnes spécifiées. Ici, nous fournissons une brève
introduction aux jointures. Pour en savoir plus, veuillez vous référer
au chapitre sur les <a href="https://uclouvain-cbio.github.io/WSBIM1207/sec-join.html" class="external-link">jointures
de table</a>. Le Data Transformation Cheat Sheet fournit également un
bref aperçu sur les jointures de table.</p>
<p>Nous allons illustrer la jointure en utilisant une petite table,
<code>rna_mini</code> que nous allons créer en extrayant de la table
<code>rna</code> d’origine 3 colonnes et 10 lignes.</p>
<div class="codewrapper sourceCode" id="cb134">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_mini</span> <span class="op">&lt;-</span> <span class="va">rna</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">select</span><span class="op">(</span><span class="va">gène</span>, <span class="va">échantillon</span>, <span class="va">expression</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">head</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in `select()`:
! Can't select columns that don't exist.
✖ Column `gène` doesn't exist.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb136">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_mini</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'rna_mini' not found</code></pre>
</div>
<p>Le deuxième tableau, <code>annot1</code>, contient 2 colonnes,
<code>gene</code> et <code>gene_description</code>. Vous pouvez soit <a href="https://carpentries-incubator.github.io/bioc-intro/data/annot1.csv" class="external-link">télécharger
annot1.csv</a> en cliquant sur le lien puis en déplaçant le fichier dans
le dossier <code>data/</code>, ou vous pouvez utiliser le code R
ci-dessous pour le télécharger directement dans le dossier
<code>data</code>.</p>
<div class="codewrapper sourceCode" id="cb138">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">download.file</span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://carpentries-incubator.github.io/bioc-intro/data/annot1.csv"</span>,</span>
<span>              destfile <span class="op">=</span> <span class="st">"data/annot1.csv"</span><span class="op">)</span></span>
<span><span class="va">annot1</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/annot1.csv"</span><span class="op">)</span></span>
<span><span class="va">annot1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 10 × 2
   gene    gene_description
   &lt;chr&gt;   &lt;chr&gt;
 1 Cyp2d22 cytochrome P450, family 2, subfamily d, polypeptide 22 [Source:MGI S…
 2 Klk6    kallikrein related-peptidase 6 [Source:MGI Symbol;Acc:MGI:1343166]
 3 Fcrls   Fc receptor-like S, scavenger receptor [Source:MGI Symbol;Acc:MGI:19…
 4 Plp1    proteolipid protein (myelin) 1 [Source:MGI Symbol;Acc:MGI:97623]
 5 Exd2    exonuclease 3'-5' domain containing 2 [Source:MGI Symbol;Acc:MGI:192…
 6 Apod    apolipoprotein D [Source:MGI Symbol;Acc:MGI:88056]
 7 Gnb4    guanine nucleotide binding protein (G protein), beta 4 [Source:MGI S…
 8 Slc2a4  solute carrier family 2 (facilitated glucose transporter), member 4 …
 9 Asl     argininosuccinate lyase [Source:MGI Symbol;Acc:MGI:88084]
10 Gjc2    gap junction protein, gamma 2 [Source:MGI Symbol;Acc:MGI:2153060]    </code></pre>
</div>
<p>Nous voulons maintenant joindre ces deux tables en une seule
contenant toutes les variables en utilisant la fonction
<code>full_join()</code> du package <code>dplyr</code>. La fonction
trouvera automatiquement la variable commune correspondant aux colonnes
de la première et de la deuxième table. Dans ce cas, <code>gene</code>
est la seule variable commune. De telles variables sont appelées clés.
Les clés sont utilisées pour faire correspondre les observations dans
différentes tables.</p>
<div class="codewrapper sourceCode" id="cb140">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">full_join</span><span class="op">(</span><span class="va">rna_mini</span>, <span class="va">annot1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'rna_mini' not found</code></pre>
</div>
<p>En recherche, les gènes sont parfois només différemment.</p>
<p>La table <code>annot2</code> est exactement la même que
<code>annot1</code> sauf que la variable contenant les noms de gènes est
nommée différemment. Encore une fois, <a href="https://carpentries-incubator.github.io/bioc-intro/data/annot2.csv" class="external-link">téléchargez
annot2.csv</a> vous-même et déplacez-le vers <code>data/</code> ou
utilisez le code R ci-dessous.</p>
<div class="codewrapper sourceCode" id="cb142">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">download.file</span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://carpentries-incubator.github.io/bioc-intro/data/annot2.csv"</span>,</span>
<span>              destfile <span class="op">=</span> <span class="st">"data/annot2.csv"</span><span class="op">)</span></span>
<span><span class="va">annot2</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/annot2.csv"</span><span class="op">)</span></span>
<span><span class="va">annot2</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 10 × 2
   external_gene_name description
   &lt;chr&gt;              &lt;chr&gt;
 1 Cyp2d22            cytochrome P450, family 2, subfamily d, polypeptide 22 [S…
 2 Klk6               kallikrein related-peptidase 6 [Source:MGI Symbol;Acc:MGI…
 3 Fcrls              Fc receptor-like S, scavenger receptor [Source:MGI Symbol…
 4 Plp1               proteolipid protein (myelin) 1 [Source:MGI Symbol;Acc:MGI…
 5 Exd2               exonuclease 3'-5' domain containing 2 [Source:MGI Symbol;…
 6 Apod               apolipoprotein D [Source:MGI Symbol;Acc:MGI:88056]
 7 Gnb4               guanine nucleotide binding protein (G protein), beta 4 [S…
 8 Slc2a4             solute carrier family 2 (facilitated glucose transporter)…
 9 Asl                argininosuccinate lyase [Source:MGI Symbol;Acc:MGI:88084]
10 Gjc2               gap junction protein, gamma 2 [Source:MGI Symbol;Acc:MGI:…</code></pre>
</div>
<p>Si aucun des noms de variables ne correspond, nous pouvons définir
manuellement les variables à utiliser pour la correspondance. Ces
variables peuvent être définies en utilisant l’argument <code>by</code>,
comme indiqué ci-dessous avec les tables <code>rna_mini</code> et
<code>annot2</code>.</p>
<div class="codewrapper sourceCode" id="cb144">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">full_join</span><span class="op">(</span><span class="va">rna_mini</span>, <span class="va">annot2</span>, by <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"gene"</span> <span class="op">=</span> <span class="st">"external_gene_name"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'rna_mini' not found</code></pre>
</div>
<p>Comme on peut le voir ci-dessus, le nom de variable de la première
table est lors de la jointure.</p>
<div id="défi-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-4" class="callout-inner">
<h3 class="callout-title">Défi:</h3>
<div class="callout-content">
<p>Téléchargez la table <code>annot3</code> en cliquant <a href="https://carpentries-incubator.github.io/bioc-intro/data/annot3.csv" class="external-link">ici</a>
et placez la table dans votre dossier <code>data</code>. À l’aide de la
fonction <code>full_join()</code>, joignez les tables
<code>rna_mini</code> et <code>annot3</code>. Que s’est-il passé pour
les gènes <em>Klk6</em>, <em>mt-Tf</em>, <em>mt-Rnr1</em>,
<em>mt-Tv</em>, <em>mt-Rnr2</em> et <em>mt-Tl1</em> ?</p>
</div>
</div>
</div>
<div id="accordionSolution9" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution9" aria-expanded="false" aria-controls="collapseSolution9">
  <h4 class="accordion-header" id="headingSolution9"> Show me the solution </h4>
</button>
<div id="collapseSolution9" class="accordion-collapse collapse" aria-labelledby="headingSolution9" data-bs-parent="#accordionSolution9">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb146">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annot3</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/annot3.csv"</span><span class="op">)</span></span>
<span><span class="fu">full_join</span><span class="op">(</span><span class="va">rna_mini</span>, <span class="va">annot3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'rna_mini' not found</code></pre>
</div>
<p>Les gènes <em>Klk6</em> ne sont présents que dans
<code>rna_mini</code>, tandis que les gènes <em>mt-Tf</em>,
<em>mt-Rnr1</em>, <em>mt-Tv</em>, <em>mt-Rnr2</em> et <em>mt-Tl1</em>
sont présent uniquement dans la table <code>annot3</code>. Leurs valeurs
respectives pour les variables du tableau ont été codées comme
manquantes.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="exporter-des-données">Exporter des données<a class="anchor" aria-label="anchor" href="#exporter-des-donn%C3%A9es"></a>
</h2>
<hr class="half-width">
<p>Maintenant que vous avez appris à utiliser <code>dplyr</code> pour
extraire des informations de ou résumer vos données, vous souhaiterez
peut-être exporter ces nouveaux jeux de données pour les partager avec
vos collaborateurs ou pour les archiver.</p>
<p>Tout comme à la fonction <code>read_csv()</code> utilisée pour
lire/importer les fichiers CSV dans R, il existe une fonction
<code>write_csv()</code> qui génère des fichiers CSV à partir de data
frames.</p>
<p>Avant d’utiliser <code>write_csv()</code>, nous allons créer un
nouveau dossier, <code>data_output</code>, dans notre répertoire de
travail, pour y sauvegarder nos nouveaux de données. Nous ne voulons pas
écrive les ensembles de données générés dans le même répertoire que nos
données brutes. C’est en effet une bonne pratique de les garder séparés.
Le dossier <code>data</code> ne doit contenir que les données brutes et
non modifiées, et doit être laissé tel quel pour nous assurer que nous
ne les supprimons ou modifions pas. En revanche, notre script générera
le contenu du répertoire <code>data_output</code>, donc même si les
fichiers qu’il contient sont supprimés, nous pourrons toujours les
regénérer.</p>
<p>Utilisons <code>write_csv()</code> pour sauvegarder la table
<code>rna_wide</code> que nous avons créée précédemment.</p>
<div class="codewrapper sourceCode" id="cb148">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write_csv</span><span class="op">(</span><span class="va">rna_wide</span>, file <span class="op">=</span> <span class="st">"data_output/rna_wide.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Données tabulaires dans R utilisant le méta-package
<em>tidyverse</em>.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-40-visualization"><p>Content from <a href="40-visualization.html">Visualisation de données</a></p>
<hr>
<p>Last updated on 2025-05-05 |

        <a href="https://github.com/carpentries-incubator/bioc-intro/edit/main/episodes/40-visualization.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 120 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Visualisation en R</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Produire des <em>scatter plots</em> (nuages de points), des
<em>boxplots</em> (boîtes à moustache), des <em>line plots</em> (tracés
linéaires), etc. en utilisant ggplot.</li>
<li>Définir les paramètres universels des graphiques.</li>
<li>Décrire ce qu’est le <em>faceting</em> (facettage) et appliquez le
<em>faceting</em> dans ggplot.</li>
<li>Modifiez les éléments esthétiques d’un tracé <code>ggplot</code>
existant (y compris les étiquettes et la couleur des axes).</li>
<li>Créer des graphiques complexes et personnalisés à prtir de données
dans un <em>data frame</em>.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<blockquote>
<p>Cet épisode est basé sur la leçon <em>Data Analysis and Visualisation
in R for Ecologists</em> des Data Carpentries.</p>
</blockquote>
<section><h2 class="section-heading" id="visualisation-de-données">Visualisation de données<a class="anchor" aria-label="anchor" href="#visualisation-de-donn%C3%A9es"></a>
</h2>
<hr class="half-width">
<p>Nous commençons par charger les packages requis.
<strong><code>ggplot2</code></strong> est inclus dans le package
<strong><code>tidyverse</code></strong>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">bibliothèque</span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in bibliothèque("tidyverse"): could not find function "bibliothèque"</code></pre>
</div>
<p>Si vous n’êtes pas encore dans l’espace de travail, chargez les
données que nous avons enregistrées dans la leçon précédente.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arn</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/rnaseq.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>La Data Visualization Cheat</p>
<p>couvrira les bases et les fonctionnalités plus avancées de
<code>ggplot2</code> et servira non seulement de pense-bête, mais
donnera aussi un aperçu des nombreuses représentations de données
disponibles dans le package. Les didacticiels vidéo suivants (<a href="https://www.youtube.com/watch?v=h29g21z0a68" class="external-link">partie 1</a> et <a href="https://www.youtube.com%20/watch?v=0m4yywqNPVY" class="external-link">2</a>) de Thomas
Lin Pedersen sont également très instructifs.</p>
</section><section><h2 class="section-heading" id="tracer-avec-ggplot2">Tracer avec <code>ggplot2</code>
<a class="anchor" aria-label="anchor" href="#tracer-avec-ggplot2"></a>
</h2>
<hr class="half-width">
<p><code>ggplot2</code> est un package graphique qui simplifie la
création de graphiques complexes à partir de données dans un <em>data
frame</em>. Il fournit une interface de programmation pour spécifier les
variables à représenter sur le graphique, comment elles sont
représentées, ainsi que les propriétés visuelles générales. Les concepts
théoriques qui sont à la base de <code>ggplot2</code> sont décrits dans
le livre <em>Grammar of Graphics</em> (<span class="citation">@Wilkinson</span> :2005). En utilisant cette approche ,
nous n’avons besoin que de changements minimes si les données
sous-jacentes changent ou si nous décidons de passer d’un <em>bar
plot</em> à un <em>scatter plot</em>, par exemple. Cela aide à créer des
graphiques de qualité professionnelle avec un minimum d’ajustements.</p>
<p>Il existe aussi un livre décrivant <code>ggplot2</code> (<span class="citation">@ggplot2book</span>) qui en fournit un bon aperçu, mais
il est obsolète. La 3ème édition est en préparation et sera <a href="https://ggplot2-book.org/" class="external-link">disponible gratuitement en ligne</a>.
La page Web <code>ggplot2</code> (<a href="https://ggplot2.tidyverse.org" class="external-link">https://ggplot2.tidyverse.org</a>)
fournit une documentation abondante.</p>
<p><code>ggplot2</code> fonctionne avec des données au format « long »,
c’est-à-dire une colonne pour chaque variable et une ligne pour chaque
observation. Des données bien structurées vous feront gagner beaucoup de
temps lors de la création de figures avec <code>ggplot2</code>.</p>
<p>Les graphiques ggplot sont construits étape par étape en ajoutant de
nouveaux éléments appelés <em>couches</em>. L’ajout progressif de
couches permet une grande flexibilité et une personnalisation des
graphiques.</p>
<blockquote>
<p>L’idée derrière la “Grammar of Graphics” est que vous pouvez
construire chaque graphique à partir des 3 mêmes composants : (1) un jeu
de données, (2) un système de coordonnées, et (3) des “geoms” —
c’est-à-dire des marques visuelles qui représentent des points de
données [^trois\_comp\_ggplot2]</p>
</blockquote>
<p>Pour construire un ggplot, nous utiliserons le modèle de base suivant
qui peut être utilisé pour différents types de graphiques :</p>
<pre><code>ggplot(data = &lt;DATA&gt;, mapping = aes(&lt;MAPPINGS&gt;)) +  &lt;GEOM_FUNCTION&gt;()</code></pre>
<ul>
<li>utiliser la fonction <code>ggplot()</code> et lier un <em>data
frame</em> spécifique en utilisant l’argument <code>data</code>
</li>
</ul>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna</span><span class="op">)</span></span></code></pre>
</div>
<ul>
<li>définir un <strong>mapping</strong> (en utilisant la fonction
d’esthétique (<code>aes</code>)), qui consiste à: (1) sélectionner les
variables du <em>data frame</em> à réprésenter et (2) les lier à des
caractéristiques du graphique comme les coordonnées x ou y, ou encore la
taille, la couleur, la forme, etc.</li>
</ul>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">expression</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<ul>
<li>ajouter des ‘<strong>geoms</strong>’ - géométries ou représentations
graphiques des données dans le graphique (points, lignes, barres).
<code>ggplot2</code> propose de nombreux <em>geom</em> différents. Ici
nous utiliserons les plus courantes, par exemple :</li>
</ul>
<pre><code>* `geom_point()` pour les *scatter plots* (nuages de points), les *dot plots* (diagrammes de points), etc.
* `geom_histogram()` pour les histogrammes
* `geom_boxplot()` pour, eh bien, les *boxplots* !
* `geom_line()` pour les lignes de tendance, les séries chronologiques, etc.</code></pre>
<p>Pour ajouter un <em>geom</em> au graphique, utilisez l’opérateur
<code>+</code>. Utilisons d’abord <code>geom_histogram()</code> :</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">expression</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna, mapping = aes(x = expression)): could not find function "ggplot"</code></pre>
</div>
<p>Le symbole <code>+</code> dans le package <code>ggplot2</code> est
particulièrement utile car il vous permet de modifier les objets
<code>ggplot</code> existants. Cela signifie que vous pouvez facilement
configurer des modèles de graphique et explorer facilement différents
types de graphiques. En procédant de la sorte, le graphique obtenu
précédemment peut également être généré avec un code comme
celui-ci :</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assign plot to a variable</span></span>
<span><span class="va">rna_plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna</span>,</span>
<span>                   mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">expression</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Draw the plot</span></span>
<span><span class="va">rna_plot</span> <span class="op">+</span> <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div id="défi" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Vous avez probablement remarqué un message automatique qui apparaît
lorsqu’on trace un histogramme :</p>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(rna, aes(x = expression)): could not find function "ggplot"</code></pre>
</div>
<p>Définissez un <em>mapping</em> (en utilisant la fonction esthétique
(<code>aes</code>)), qui consiste à: (1) sélectionner les variables du
<em>data frame</em> à réprésenter et (2) les lier à des caractéristiques
du graphique comme les coordonnées x ou y, ou encore la taille, la
couleur, la forme, etc.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># change bins</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">rna</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">expression</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(rna, aes(x = expression)): could not find function "ggplot"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># change binwidth</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">rna</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">expression</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(rna, aes(x = expression)): could not find function "ggplot"</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Nous pouvons observer ici que les données présentent un <em>right
skew</em> (asymétrie vers la droite). Nous pouvons appliquer la
transformation log2 pour obtenir une distribution plus symétrique. Notez
que nous ajoutons ici une petite valeur constante (<code>+1</code>) pour
éviter que <code>-Inf</code> soit renvoyée pour des expressions égales à
0.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arn</span> <span class="op">&lt;-</span> <span class="va">arn</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">muter</span><span class="op">(</span>expression_log <span class="op">=</span> <span class="fu">log2</span><span class="op">(</span><span class="va">expression</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in arn %&gt;% muter(expression_log = log2(expression + 1)): could not find function "%&gt;%"</code></pre>
</div>
<p>Si l’on dessine maintenant l’histogramme des expressions transformées
en log2, la distribution est en effet plus proche d’une distribution
normale.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">rna</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">expression_log</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(rna, aes(x = expression_log)): could not find function "ggplot"</code></pre>
</div>
<p>À partir de maintenant, nous travaillerons sur les valeurs
d’expression transformées en log.</p>
<div id="défi-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-1" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Une autre façon de visualiser cette transformation, plutôt que de
transformer les données elles-mêmes, est de garder les données
inchangées mais de choisir une autre échelle des observations. Par
exemple, il peut être intéressant de changer l’échelle de l’axe pour
mieux répartir les observations dans le graphique. Changer l’échelle des
axes se fait de la même manière que pour ajouter/modifier d’autres
composants (c’est-à-dire en ajoutant progressivement des commandes).
Essayez de modifier le graphique précédent de la manière suivante:</p>
<ul>
<li>Représenter l’expression non transformée sur l’échelle log10 ; voir
<code>scale_x_log10()</code>. Comparer le résultat avec le graphique
précédent. Pourquoi des <em>warnings</em> (messages d’avertissement)
apparaissent-ils maintenant ?</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna</span>,mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">expression</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna, mapping = aes(x = expression)): could not find function "ggplot"</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><strong>Remarques</strong></p>
<ul>
<li>Tout ce que vous mentionnez dans la fonction <code>ggplot()</code>
peut être vu par n’importe quelle couche <em>geom</em> que vous ajoutez
par la suite (c’est-à-dire qu’il s’agit de paramètres de graphiques
globaux). Ceci y compris le mapping des axes x et y que vous avez
configuré dans <code>aes()</code>.</li>
<li>Vous pouvez également spécifier des mappings pour un <em>geom</em>
donné, indépendamment des mappings définis globalement dans la fonction
<code>ggplot()</code>.</li>
<li>Le signe <code>+</code>, utilisé pour ajouter de nouvelles couches,
doit être placé à la fin de la ligne contenant la couche précédente. Si
, au contraire, le signe <code>+</code> est ajouté au début d’une ligne
contenant la nouvelle couche, <code>ggplot2</code> n’ajoutera pas la
nouvelle couche et retournera un message d’erreur.</li>
</ul>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This is the correct syntax for adding layers</span></span>
<span><span class="va">rna_plot</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This will not add the new layer and will return an error message</span></span>
<span><span class="va">rna_plot</span></span>
<span>  <span class="op">+</span> <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="construire-vos-graphiques-de-manière-itérative">Construire vos graphiques de manière itérative<a class="anchor" aria-label="anchor" href="#construire-vos-graphiques-de-mani%C3%A8re-it%C3%A9rative"></a>
</h2>
<hr class="half-width">
<p>Nous allons maintenant dessiner un <em>scatter plot</em> avec deux
variables continues et la fonction <code>geom_point()</code>. Ce
graphique représentera les <code>log2 fold changes</code> (ratio de
valeurs convertis en <code>log</code>) des expressions, entre le temps 8
et le temps 0 d’une part, et entre le temps 4 et le temps 0 d’autre
part. Pour ce faire, nous devons d’abord calculer les moyennes des
valeurs d’expression transformées en log par gène et par temps, puis les
<em>log fold changes</em> souhaités. Notez que nous incluons également
ici le biotype du gène, que nous utiliserons plus tard pour représenter
les gènes. Nous enregistrerons les <em>log fold changes</em> dans un
nouveau <em>data frame</em> appelé <code>rna_fc.</code></p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_fc</span> <span class="op">&lt;-</span> <span class="va">rna</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">gene</span>, <span class="va">time</span>,</span>
<span>                         <span class="va">gene_biotype</span>, <span class="va">expression_log</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">gene</span>, <span class="va">time</span>, <span class="va">gene_biotype</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summary</span><span class="op">(</span>mean_exp <span class="op">=</span> <span class="fu">moyenne</span> <span class="op">(</span><span class="va">expression_log</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">temps</span>,</span>
<span>              valeurs_from <span class="op">=</span> <span class="va">moyenne_exp</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>time_8_vs_0 <span class="op">=</span> <span class="va">`8`</span> <span class="op">-</span> <span class="va">`0`</span>, time_4_vs_0 <span class="op">=</span> <span class="va">`4`</span> <span class="op">-</span> <span class="va">`0`</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in rna %&gt;% select(gene, time, gene_biotype, expression_log) %&gt;% : could not find function "%&gt;%"</code></pre>
</div>
<p>Nous pouvons ensuite construire un ggplot avec le jeu de données
nouvellement créé <code>rna_fc</code>. Construire des graphiques avec
<code>ggplot2</code> est généralement un processus itératif. Nous
commençons par définir le jeu de données que nous allons utiliser,
tracer les axes et choisir une <em>geom</em> :</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna_fc</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_4_vs_0</span>, y <span class="op">=</span> <span class="va">time_8_vs_0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna_fc, mapping = aes(x = time_4_vs_0, y = time_8_vs_0)): could not find function "ggplot"</code></pre>
</div>
<p>Ensuite, nous commençons à modifier ce graphique pour en extraire
davantage d’informations. Par exemple, nous pouvons ajouter de la
transparence (« alpha ») pour éviter la surcharge du graphique:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna_fc</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_4_vs_0</span>, y <span class="op">=</span> <span class="va">time_8_vs_0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna_fc, mapping = aes(x = time_4_vs_0, y = time_8_vs_0)): could not find function "ggplot"</code></pre>
</div>
<p>On peut également ajouter des couleurs pour tous les points :</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna_fc</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_4_vs_0</span>, y <span class="op">=</span> <span class="va">time_8_vs_0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna_fc, mapping = aes(x = time_4_vs_0, y = time_8_vs_0)): could not find function "ggplot"</code></pre>
</div>
<p>Ou pour colorer différemment chaque gène du graphique, vous pouvez
utiliser un vecteur comme input dans l’argument <strong>color</strong>.
<code>ggplot2</code> assignera une couleur différente à chaques valeurs
dans le vecteur. Voici un exemple où nous colorons avec la variable
<code>gene_biotype</code> :</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna_fc</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_4_vs_0</span>, y <span class="op">=</span> <span class="va">time_8_vs_0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span>, <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">gene_biotype</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna_fc, mapping = aes(x = time_4_vs_0, y = time_8_vs_0)): could not find function "ggplot"</code></pre>
</div>
<p>Nous pouvons également spécifier les couleurs directement à
l’intérieur du mapping fourni dans la fonction <code>ggplot()</code>.
Cela sera visible par toutes les couches de <em>geom</em> et le mapping
sera déterminé par les axes x et y définis dans <code>aes()</code>.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna_fc</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_4_vs_0</span>, y <span class="op">=</span> <span class="va">time_8_vs_0</span>,</span>
<span>                                color <span class="op">=</span> <span class="va">gene_biotype</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna_fc, mapping = aes(x = time_4_vs_0, y = time_8_vs_0, : could not find function "ggplot"</code></pre>
</div>
<p>Enfin, nous pourrions également ajouter une ligne diagonale avec la
fonction <code>geom_abline()</code>  :</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna_fc</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_4_vs_0</span>, y <span class="op">=</span> <span class="va">time_8_vs_0</span>,</span>
<span>                                color <span class="op">=</span> <span class="va">gene_biotype</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna_fc, mapping = aes(x = time_4_vs_0, y = time_8_vs_0, : could not find function "ggplot"</code></pre>
</div>
<p>Notez que nous pouvons remplacer <code>geom_point</code> par
<code>geom_jitter</code> et les couleurs seront toujours déterminées par
<code>gene_biotype</code>.</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna_fc</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_4_vs_0</span>, y <span class="op">=</span> <span class="va">time_8_vs_0</span>,</span>
<span>                                color <span class="op">=</span> <span class="va">gene_biotype</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna_fc, mapping = aes(x = time_4_vs_0, y = time_8_vs_0, : could not find function "ggplot"</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in bibliothèque("hexbin"): could not find function "bibliothèque"</code></pre>
</div>
<div id="défi-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-2" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Les <em>scatter plots</em> peuvent être des outils d’exploration
utiles pour de petits jeux de données. Pour les jeux de données avec un
grand nombre d’observations, tels que le jeu de données
<code>rna_fc</code> , l’accumulation de points peut surcharger le
graphique, ce qui constitue une limitation des <em>scatter plots</em>.
Une stratégie possible dans de tels cas consiste à utiliser le
regroupement hexagonal d’observations. Dans ce cas, l’espace du
graphique est divisé en hexagones. Chaque hexagone se voit attribuer une
couleur en fonction du nombre d’observations qui se trouvent à
l’intérieur.</p>
<ul>
<li><p>Pour utiliser le regroupement hexagonal dans
<code>ggplot2</code>, installez d’abord le package R <code>hexbin</code>
depuis CRAN et chargez-le.</p></li>
<li><p>Utilisez ensuite la fonction <code>geom_hex()</code> pour
produire la figure hexbin.</p></li>
<li><p>Quelles sont les avantages et inconvénients d’un diagramme
hexagonal, par rapport à un <em>scatter plot</em> ? Examinez le
<em>scatter plot</em> ci-dessus et comparez-le avec le diagramme
hexagonal que vous avez créé.</p></li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"hexbin"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="st">"hexbin"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in library("hexbin"): there is no package called 'hexbin'</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna_fc</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_4_vs_0</span>, y <span class="op">=</span> <span class="va">time_8_vs_0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hex</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna_fc, mapping = aes(x = time_4_vs_0, y = time_8_vs_0)): could not find function "ggplot"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="défi-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-3" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Utilisez ce que vous venez d’apprendre pour créer un <em>scatter
plot</em> de la variable <code>expression_log</code> en fonction de la
variable <code>sample</code>, à partir du jeu de données
<code>rna</code>, avec l’heure affichée dans différentes couleurs.
Est-ce une bonne façon d’afficher ce type de données ?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">expression_log</span>, x <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">time</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna, mapping = aes(y = expression_log, x = sample)): could not find function "ggplot"</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="boxplot-boîte-à-moustaches">
<em>Boxplot</em> (boîte à moustaches)<a class="anchor" aria-label="anchor" href="#boxplot-bo%C3%AEte-%C3%A0-moustaches"></a>
</h2>
<hr class="half-width">
<p>Nous pouvons utiliser des <em>boxplots</em> pour visualiser la
distribution des expressions géniques au sein de chaque
échantillon :</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna</span>,</span>
<span>         mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">expression_log</span>, x <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna, mapping = aes(y = expression_log, x = sample)): could not find function "ggplot"</code></pre>
</div>
<p>En ajoutant des points au <em>boxplot</em>, on peut avoir une
meilleure idée du nombre de mesures et de leur distribution :</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna</span>,</span>
<span>         mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">expression_log</span>, x <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span>, color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna, mapping = aes(y = expression_log, x = sample)): could not find function "ggplot"</code></pre>
</div>
<div id="défi-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-4" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Avez-vous remarqué que la couche <em>boxplot</em> se trouve devant la
couche <em>jitter</em> ? Que devez-vous modifier dans le code pour
placer le <em>boxplot</em> sous les points ?</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p>Nous devrions inverser l’ordre de ces deux <em>geom</em>:</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna</span>,</span>
<span>         mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">expression_log</span>, x <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span>, color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna, mapping = aes(y = expression_log, x = sample)): could not find function "ggplot"</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Vous remarquerez peut-être que les valeurs sur l’axe des x ne sont
toujours pas lisibles correctement. Modifions l’orientation des
étiquettes et ajustons-les verticalement et horizontalement afin
qu’elles ne se chvauchent pas. Vous pouvez utiliser un angle de 90
degrés ou expérimenter pour trouver l’angle approprié pour des
étiquettes orientées en diagonale :</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna</span>,</span>
<span>         mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">expression_log</span>, x <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span>, color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>,  hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna, mapping = aes(y = expression_log, x = sample)): could not find function "ggplot"</code></pre>
</div>
<div id="défi-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-5" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Ajoutez de la couleur aux points de données sur votre
<em>boxplot</em> en fonction de la durée de l’infection (« time »).</p>
<p><em>Indice :</em> Vérifiez la classe pour la variable <em>time</em>.
Envisagez de changer la classe de <code>time</code> d’entier à
<em>factor</em> directement dans le mapping ggplot. Pourquoi cela
change-t-il la façon dont R crée le graphique ?</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># time as integer</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna</span>,</span>
<span>         mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">expression_log</span>,</span>
<span>                       x <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span>, <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>,  hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna, mapping = aes(y = expression_log, x = sample)): could not find function "ggplot"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># time as factor</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna</span>,</span>
<span>         mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">expression_log</span>,</span>
<span>                       x <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span>, <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="fu">as.factor</span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>,  hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna, mapping = aes(y = expression_log, x = sample)): could not find function "ggplot"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="défi-6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-6" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Les <em>boxplots</em> sont des résumés utiles, mais ils ne révèlent
pas la forme de la distribution. Par exemple, si la distribution est
bi-modale, nous ne le verrions pas dans un <em>boxplot</em>. Une
alternative au <em>boxplot</em> est le <em>violin plot</em> (graphiques
en violon) , où la forme de la densité de points est dessinée.</p>
<ul>
<li>Remplacez la <em>box plot</em> par un <em>violin plot</em> ; voir
<code>geom_violin()</code>. Liez la couleur de remplissage des violons à
la variable <code>time</code>, grâce à l’argument
<code>fill</code>.</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7"> Show me the solution </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" aria-labelledby="headingSolution7" data-bs-parent="#accordionSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna</span>,</span>
<span>         mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">expression_log</span>, x <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu">as.factor</span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>,  hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna, mapping = aes(y = expression_log, x = sample)): could not find function "ggplot"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="défi-7" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-7" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<ul>
<li>Modifiez le <em>violin plot</em> pour lier la couleur de remplissage
des violons à la variable “sex”.</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8"> Show me the solution </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" aria-labelledby="headingSolution8" data-bs-parent="#accordionSolution8">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rna</span>,</span>
<span>         mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">expression_log</span>, x <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>,  hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = rna, mapping = aes(y = expression_log, x = sample)): could not find function "ggplot"</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="line-plots-graphiques-linéaires">
<em>Line plots</em> (graphiques linéaires)<a class="anchor" aria-label="anchor" href="#line-plots-graphiques-lin%C3%A9aires"></a>
</h2>
<hr class="half-width">
<p>Calculons l’expression moyenne par durée de l’infection pour les 10
gènes ayant les <em>log fold changes</em> comparant le temps 8 au temps
0 les plus élevés. Tout d’abord, nous devons sélectionner les gènes et
créer un sous-ensemble de <code>rna</code> appelé <code>sub_rna</code>
contenant les 10 gènes sélectionnés, puis nous devons regrouper les
données et calculer l’expression moyenne des gènes dans chaque groupe
:</p>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rna_fc</span> <span class="op">&lt;-</span> <span class="va">rna_fc</span> <span class="op">|&gt;</span> <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">time_8_vs_0</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in arrange(rna_fc, desc(time_8_vs_0)): could not find function "arrange"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genes_selected</span> <span class="op">&lt;-</span> <span class="va">rna_fc</span><span class="op">$</span><span class="va">gene</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'rna_fc' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sub_rna</span> <span class="op">&lt;-</span> <span class="va">rna</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="va">gene</span> <span class="op">%in%</span> <span class="va">genes_selected</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'rna' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb69">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_exp_by_time</span> <span class="op">&lt;-</span> <span class="va">sub_rna</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">gene</span>,<span class="va">time</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_exp <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">expression_log</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in summarize(group_by(sub_rna, gene, time), mean_exp = mean(expression_log)): could not find function "summarize"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb71">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_exp_by_time</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'mean_exp_by_time' not found</code></pre>
</div>
<p>Nous pouvons construire le <em>line plot</em> avec la durée de
l’infection sur l’axe des x et l’expression moyenne sur l’axe des
y :</p>
<div class="codewrapper sourceCode" id="cb73">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">moyenne_exp_by_time</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">temps</span>, y <span class="op">=</span> <span class="va">moyenne_exp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = moyenne_exp_by_time, mapping = aes(x = temps, y = moyenne_exp)): could not find function "ggplot"</code></pre>
</div>
<p>Malheureusement, cela ne fonctionne pas car nous avons représenté
ensemble les données de tous les gènes . Nous devons dire à ggplot de
tracer une ligne pour chaque gène en modifiant la fonction esthétique
pour inclure <code>group = gene</code> :</p>
<div class="codewrapper sourceCode" id="cb75">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">moyenne_exp_by_time</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">temps</span>, y <span class="op">=</span> <span class="va">moyenne_exp</span>, groupe <span class="op">=</span> <span class="va">gène</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = moyenne_exp_by_time, mapping = aes(x = temps, y = moyenne_exp, : could not find function "ggplot"</code></pre>
</div>
<p>Nous pourrons distinguer les gènes dans le graphique si nous ajoutons
des couleurs (l’utilisation de <code>color</code> regroupe également
automatiquement les données) :</p>
<div class="codewrapper sourceCode" id="cb77">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">moyenne_exp_by_time</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">temps</span>, y <span class="op">=</span> <span class="va">moyenne_exp</span>, couleur <span class="op">=</span> <span class="va">gène</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = moyenne_exp_by_time, mapping = aes(x = temps, y = moyenne_exp, : could not find function "ggplot"</code></pre>
</div>
</section><section><h2 class="section-heading" id="faceting-diviser-en-facettes">
<em>Faceting</em> (diviser en facettes)<a class="anchor" aria-label="anchor" href="#faceting-diviser-en-facettes"></a>
</h2>
<hr class="half-width">
<p><code>ggplot2</code> a une technique spéciale appelée
<em>faceting</em> qui permet à l’utilisateur de diviser un graphique en
plusieurs (sous) graphiques en fonction d’un facteur inclus dans le jeu
de données. Ces différents sous-graphiques héritent des mêmes propriétés
(limites des axes, graduations, …) pour faciliter leur comparaison
directe. Nous allons l’utiliser pour créer un <em>line plot</em> en
fonction du temps pour chaque gène :</p>
<div class="codewrapper sourceCode" id="cb79">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">moyenne_exp_by_time</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">temps</span>, y <span class="op">=</span> <span class="va">moyenne_exp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">gène</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = moyenne_exp_by_time, mapping = aes(x = temps, y = moyenne_exp)): could not find function "ggplot"</code></pre>
</div>
<p>Ici, les axes x et y ont la même échelle pour tous les
sous-graphiques. Vous pouvez changer ce comportement par défaut en
modifiant <code>scales</code> afin d’autoriser une échelle libre pour
l’axe y :</p>
<div class="codewrapper sourceCode" id="cb81">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">moyenne_exp_by_time</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">temps</span>, y <span class="op">=</span> <span class="va">moyenne_exp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">gene</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = moyenne_exp_by_time, mapping = aes(x = temps, y = moyenne_exp)): could not find function "ggplot"</code></pre>
</div>
<p>Nous aimerions maintenant diviser la ligne dans chaque graphiques
selon le sexe des souris. Pour ce faire, nous devons calculer
l’expression moyenne dans le <em>data frame</em> regroupé par “gene”,
“time” et “sex” :</p>
<div class="codewrapper sourceCode" id="cb83">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Mean_exp_by_time_sex</span> <span class="op">&lt;-</span> <span class="va">sub_rna</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">gene</span>, <span class="va">time</span>, <span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summary</span><span class="op">(</span>mean_exp <span class="op">=</span> <span class="fu">Mean</span><span class="op">(</span><span class="va">expression_log</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in sub_rna %&gt;% group_by(gene, time, sex) %&gt;% summary(mean_exp = Mean(expression_log)): could not find function "%&gt;%"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb85">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Mean_exp_by_time_sex</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'Mean_exp_by_time_sex' not found</code></pre>
</div>
<p>Nous pouvons maintenant créer le graphique à facettes. Nous ajoutons
encore de l’information en divisant le <em>line plot</em> par sexe en y
associant des couleurs (au sein d’un seul graphique) :</p>
<div class="codewrapper sourceCode" id="cb87">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">moyenne_exp_by_time_sex</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">temps</span>, y <span class="op">=</span> <span class="va">moyenne_exp</span>, couleur <span class="op">=</span> <span class="va">sexe</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">gène</span>, échelles <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = moyenne_exp_by_time_sex, mapping = aes(x = temps, : could not find function "ggplot"</code></pre>
</div>
<p>Généralement, les graphiques sur fond blanc sont plus lisibles une
fois imprimés. Nous pouvons définir l’arrière-plan en blanc en utilisant
la fonction <code>theme_bw()</code>. De plus, nous pouvons supprimer la
grille :</p>
<div class="codewrapper sourceCode" id="cb89">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">moyenne_exp_by_time_sex</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">temps</span>, y <span class="op">=</span> <span class="va">moyenne_exp</span>, couleur <span class="op">=</span> <span class="va">sexe</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">gène</span>, échelles <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = moyenne_exp_by_time_sex, mapping = aes(x = temps, : could not find function "ggplot"</code></pre>
</div>
<div id="défi-8" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-8" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Utilisez ce que vous venez d’apprendre pour créer un graphique
illustrant comment l’expression moyenne de chaque chromosome change au
cours de la durée de l’infection .</p>
</div>
</div>
</div>
<div id="accordionSolution9" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution9" aria-expanded="false" aria-controls="collapseSolution9">
  <h4 class="accordion-header" id="headingSolution9"> Show me the solution </h4>
</button>
<div id="collapseSolution9" class="accordion-collapse collapse" aria-labelledby="headingSolution9" data-bs-parent="#accordionSolution9">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb91">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Mean_exp_by_chromosome</span> <span class="op">&lt;-</span> <span class="va">rna</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">chromosome_name</span>, <span class="va">time</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summary</span><span class="op">(</span>mean_exp <span class="op">=</span> <span class="fu">Mean</span><span class="op">(</span><span class="va">expression_log</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in rna %&gt;% group_by(chromosome_name, time) %&gt;% summary(mean_exp = Mean(expression_log)): could not find function "%&gt;%"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb93">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">Mean_exp_by_chromosome</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span> x <span class="op">=</span> <span class="va">temps</span>,</span>
<span>                                y <span class="op">=</span> <span class="va">moyenne_exp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">chromosome_name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = Mean_exp_by_chromosome, mapping = aes(x = temps, : could not find function "ggplot"</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Le <em>geom</em> <code>facet_wrap</code> extrait les graphiques dans
un nombre quelconque de dimensions pour leur permettre de s’adapter
joliment à une seule page. De plus, le <em>geom</em>
<code>facet_grid</code> permet de spécifier explicitement comment les
graphiques doivent être disposés par la notation en formule
(<code>rows ~ columns</code>; un <code>.</code> peut-être utilisé comme
un raccourci pour indiquer une seule ligne ou colonne).</p>
<p>Modifions le graphique précédent pour comparer l’évolution de
l’expression génétique moyenne des hommes et des femmes au fil du
temps :</p>
<div class="codewrapper sourceCode" id="cb95">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Une colonne, facette par lignes</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">Mean_exp_by_time_sex</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">Mean_exp</span>, color <span class="op">=</span> <span class="va">gene</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">sexe</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = Mean_exp_by_time_sex, mapping = aes(x = time, y = Mean_exp, : could not find function "ggplot"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb97">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Une ligne, facette par colonne</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">Mean_exp_by_time_sex</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">Mean_exp</span>, color <span class="op">=</span> <span class="va">gene</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">sexe</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = Mean_exp_by_time_sex, mapping = aes(x = time, y = Mean_exp, : could not find function "ggplot"</code></pre>
</div>
</section><section><h2 class="section-heading" id="thèmes-ggplot2">Thèmes <code>ggplot2</code>
<a class="anchor" aria-label="anchor" href="#th%C3%A8mes-ggplot2"></a>
</h2>
<hr class="half-width">
<p>En plus de <code>theme_bw()</code>, qui change l’arrière-plan du
graphique en blanc, <code>ggplot2</code> contient plusieurs autres
thèmes qui peuvent être utiles pour changer rapidement l’apparence de
votre visualisation. La liste complète des thèmes est disponible sur <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">https://ggplot2.tidyverse.org/reference/ggtheme.html</a>.
<code>theme_minimal()</code> et <code>theme_light()</code> sont
populaires, et <code>theme_void()</code> peut être utile comme point de
départ pour créer un nouveau thème à la main.</p>
<p>Le package <a href="https://jrnold.github.io/ggthemes/reference/index.html" class="external-link">ggthemes</a>
fournit une grande variété d’options (y compris un thème Excel 2003 ).
Le <a href="https://exts.ggplot2.tidyverse.org/" class="external-link">site internet des
extensions <code>ggplot2</code></a> met à disposition une collection de
packages permettant d’étendre les fonctionnalités de
<code>ggplot2</code>, y compris des thèmes supplémentaires.</p>
</section><section><h2 class="section-heading" id="personnalisation">Personnalisation<a class="anchor" aria-label="anchor" href="#personnalisation"></a>
</h2>
<hr class="half-width">
<p>Revenons au graphique à facettes de l’expression moyenne par temps et
gène, colorée par sexe.</p>
<p>Consultez la ggplot2, et réfléchissez aux améliorations possibles à
apporter à votre graphique.</p>
<p>Maintenant, nous pouvons changer les noms des axes en quelque chose
de plus informatif que ‘time’ et ‘mean_exp’, et ajouter un titre à la
figure :</p>
<div class="codewrapper sourceCode" id="cb99">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">moyenne_exp_by_time_sex</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">temps</span>, y <span class="op">=</span> <span class="va">moyenne_exp</span>, couleur <span class="op">=</span> <span class="va">sexe</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">gène</span>, échelles <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Expression moyenne des gènes selon la durée de l'infection"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Durée de l'infection (en jours)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Expression moyenne des gènes"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = moyenne_exp_by_time_sex, mapping = aes(x = temps, : could not find function "ggplot"</code></pre>
</div>
<p>Les axes ont des noms plus informatifs, mais leur lisibilité peut
être améliorée en augmentant la taille de la police :</p>
<div class="codewrapper sourceCode" id="cb101">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">moyenne_exp_by_time_sex</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">temps</span>, y <span class="op">=</span> <span class="va">moyenne_exp</span>, couleur <span class="op">=</span> <span class="va">sexe</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">gène</span>, échelles <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Expression moyenne des gènes selon la durée de l'infection"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Durée de l'infection (en jours)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Expression génétique moyenne"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = moyenne_exp_by_time_sex, mapping = aes(x = temps, : could not find function "ggplot"</code></pre>
</div>
<p>Notez qu’il est également possible de changer les polices de vos
graphiques. Si vous êtes sous Windows, vous devrez peut-être installer
le <a href="https://cran.r-project.org/web/packages/extrafont%20/index.html" class="external-link">package
<strong><code>extrafont</code></strong></a>.</p>
<p>Nous pouvons personnaliser davantage la couleur du texte des axes x
et y, la couleur de la grille, etc. Nous pouvons aussi par exemple
déplacer la légende vers le haut en mettant <code>legend.position</code>
égal à <code>"top"</code>.</p>
<div class="codewrapper sourceCode" id="cb103">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mean_exp_by_time_sex</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">mean_exp</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">gene</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Mean gene expression by duration of the infection"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Duration of the infection (in days)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Mean gene expression"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"royalblue4"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"royalblue4"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        panel.grid <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"lightsteelblue1"</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = mean_exp_by_time_sex, mapping = aes(x = time, y = mean_exp, : could not find function "ggplot"</code></pre>
</div>
<p>Si vous aimez les modifications que vous avez créées au thème par
défaut, vous pouvez les enregistrer en tant qu’objet pour pouvoir les
appliquer facilement à d’autres graphiques par la suite. Voici un
exemple avec l’histogramme que nous avons créé précédemment.</p>
<div class="codewrapper sourceCode" id="cb105">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">blue_theme</span> <span class="op">&lt;-</span> <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"royalblue4"</span>,</span>
<span>                                               size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                    axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"royalblue4"</span>,</span>
<span>                                               size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                    text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>                    panel.grid <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"lightsteelblue1"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in theme(axis.text.x = element_text(colour = "royalblue4", size = 12), : could not find function "theme"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb107">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">rna</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">expression_log</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">blue_theme</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(rna, aes(x = expression_log)): could not find function "ggplot"</code></pre>
</div>
<div id="défi-9" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-9" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Considérant toutes ces nouvelles informations, pourriez-vous
consacrer encore cinq minutes, soit pour améliorer l’un des graphiques
générés dans cet exercice, soit pour créer votre propre graphique ?
Utilisez la RStudio ggplot2 pour vous en inspirer. Voici quelques idées
:</p>
<ul>
<li>Voyez si vous pouvez modifier l’épaisseur des lignes.</li>
<li>Pouvez-vous trouver un moyen de changer le nom de la légende ? Qu’en
est-il de ses labels ? (indice : recherchez une fonction ggplot
commençant par <code>scale_</code>)</li>
<li>Essayez d’utiliser une palette de couleurs différente ou de
spécifier manuellement les couleurs pour les lignes (voir <a href="https://www.cookbook-r.com/Graphs/Colors_%5C(ggplot2%5C)/" class="external-link">http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/</a>).</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution10" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution10" aria-expanded="false" aria-controls="collapseSolution10">
  <h4 class="accordion-header" id="headingSolution10"> Show me the solution </h4>
</button>
<div id="collapseSolution10" class="accordion-collapse collapse" aria-labelledby="headingSolution10" data-bs-parent="#accordionSolution10">
<div class="accordion-body">
<p>Par exemple, sur la base de ce graphique :</p>
<div class="codewrapper sourceCode" id="cb109">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">moyenne_exp_by_time_sex</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">temps</span>, y <span class="op">=</span> <span class="va">moyenne_exp</span>, couleur <span class="op">=</span> <span class="va">sexe</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">gène</span>, échelles <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = moyenne_exp_by_time_sex, mapping = aes(x = temps, : could not find function "ggplot"</code></pre>
</div>
<p>Nous pouvons le personnaliser des manières suivantes :</p>
<div class="codewrapper sourceCode" id="cb111">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># change the thickness of the lines</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mean_exp_by_time_sex</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">mean_exp</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">gene</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = mean_exp_by_time_sex, mapping = aes(x = time, y = mean_exp, : could not find function "ggplot"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb113">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># change the name of the legend and the labels</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mean_exp_by_time_sex</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">mean_exp</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">gene</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Gender"</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"M"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = mean_exp_by_time_sex, mapping = aes(x = time, y = mean_exp, : could not find function "ggplot"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb115">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># using a different color palette</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mean_exp_by_time_sex</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">mean_exp</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">gene</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_brewer</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Gender"</span>, labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"M"</span><span class="op">)</span>, palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = mean_exp_by_time_sex, mapping = aes(x = time, y = mean_exp, : could not find function "ggplot"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb117">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># manually specifying the colors</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mean_exp_by_time_sex</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">mean_exp</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">gene</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Gender"</span>,  labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"M"</span><span class="op">)</span>,</span>
<span>                     values <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"royalblue"</span>, <span class="st">"deeppink"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = mean_exp_by_time_sex, mapping = aes(x = time, y = mean_exp, : could not find function "ggplot"</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="composer-des-graphques">Composer des graphques<a class="anchor" aria-label="anchor" href="#composer-des-graphques"></a>
</h2>
<hr class="half-width">
<p>Le <em>faceting</em> est un super outil pour diviser un graphique en
plusieurs sous-graphiques, mais parfois on aimerait plutôt obtenir une
figure unique qui contient plusieurs graphiques indépendants, i.e. des
graphiques basés sur différentes variables ou même différents <em>data
frames</em>.</p>
<p>Commençons par créer les deux graphiques que nous souhaitons disposer
l’un à côté de l’autre.</p>
<p>Le premier graphique compte le nombre de gènes uniques par
chromosome. Nous devons d’abord réorganiser les niveaux de
<code>chromosome_name</code> et filtrer les gènes uniques par
chromosome. Nous modifions également l’échelle de l’axe y en une échelle
log10 pour une meilleure lisibilité.</p>
<div class="codewrapper sourceCode" id="cb119">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arn</span><span class="op">$</span><span class="va">chromosome_name</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="va">rna</span><span class="op">$</span><span class="va">chromosome_name</span>,</span>
<span>                               niveaux <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">19</span>,<span class="st">"X"</span>,<span class="st">"Y"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in factor(rna$chromosome_name, niveaux = c(1:19, "X", "Y")): unused argument (niveaux = c(1:19, "X", "Y"))</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb121">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_gene_chromosome</span> <span class="op">&lt;-</span> <span class="va">rna</span> <span class="op">%&gt; %</span> <span class="fu">select</span><span class="op">(</span><span class="va">chromosome_name</span>, <span class="va">gene</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">chromosome_name</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"seagreen"</span>,</span>
<span>           position <span class="op">=</span> <span class="st">"esquive"</span>, stat <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"log10(n gènes)"</span>, x <span class="op">=</span> <span class="st">"chromosome"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in rna %&gt; % select(chromosome_name, gene) %&gt;% distinct() %&gt;% ggplot(): could not find function "%&gt;%"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb123">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_gene_chromosome</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'count_gene_chromosome' not found</code></pre>
</div>
<p>Ci-dessous, nous supprimons également complètement la légende en
mettant <code>legend.position</code> à<code>"none"</code>.</p>
<div class="codewrapper sourceCode" id="cb125">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp_boxplot_sex</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">rna</span>, <span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">expression_log</span>, x <span class="op">=</span> <span class="fu">as.factor</span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,</span>
<span>                 color<span class="op">=</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">geom_boxplot</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Exp moyenne du gène"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(rna, aes(y = expression_log, x = as.factor(time), color = sex)): could not find function "ggplot"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb127">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp_boxplot_sex</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'exp_boxplot_sex' not found</code></pre>
</div>
<p>Le package <a href="https://github.com/thomasp85/patchwork" class="external-link"><strong>patchwork</strong></a>
fournit une approche élégante pour combiner des figures en utilisant le
« + » pour disposer les figures (typiquement côte à côte). Plus
précisément, le <code>|</code> les dispose explicitement côte à côte et
<code>/</code> les empile les uns sur les autres .</p>
<div class="codewrapper sourceCode" id="cb129">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"patchwork"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb130">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="st">"patchwork"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in library("patchwork"): there is no package called 'patchwork'</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb132">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_gene_chromosome</span> <span class="op">+</span> <span class="va">exp_boxplot_sex</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'count_gene_chromosome' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb134">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## ou count_gene_chromosome | exp_boxplot_sex</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb135">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_gene_chromosome</span> <span class="op">/</span> <span class="va">exp_boxplot_sex</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'count_gene_chromosome' not found</code></pre>
</div>
<p>Nous pouvons encore améliorer l’aspect de la composition finale avec
<code>plot_layout</code> pour créer des mises en page plus
complexes :</p>
<div class="codewrapper sourceCode" id="cb137">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_gene_chromosome</span> <span class="op">+</span> <span class="va">exp_boxplot_sex</span> <span class="op">+</span> <span class="fu">plot_layout</span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'count_gene_chromosome' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb139">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_gene_chromosome</span> <span class="op">+</span></span>
<span> <span class="op">(</span><span class="va">count_gene_chromosome</span> <span class="op">+</span> <span class="va">exp_boxplot_sex</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="va">exp_boxplot_sex</span> <span class="op">+</span></span>
<span> <span class="fu">plot_layout</span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'count_gene_chromosome' not found</code></pre>
</div>
<p>Le dernier graphique peut également être créé à l’aide des opérateurs
de composition <code>|</code> et <code>/</code>:</p>
<div class="codewrapper sourceCode" id="cb141">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_gene_chromosome</span> <span class="op">/</span></span>
<span> <span class="op">(</span><span class="va">count_gene_chromosome</span> <span class="op">|</span> <span class="va">exp_boxplot_sex</span><span class="op">)</span> <span class="op">/</span></span>
<span> <span class="va">exp_boxplot_sex</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'count_gene_chromosome' not found</code></pre>
</div>
<p>Apprenez-en plus sur <code>patchwork</code> sur sa <a href="https://patchwork.data-imaginist.com/" class="external-link">page Web</a> ou dans cette
<a href="https://www.youtube.%20com/watch?v=0m4yywqNPVY" class="external-link">vidéo</a>.</p>
<p>Une autre possibilité est le package
<strong><code>gridExtra</code></strong> qui permet de combiner des
ggplots séparés en une seule figure en utilisant
<code>grid.arrange()</code> :</p>
<div class="codewrapper sourceCode" id="cb143">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"gridExtra"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb144">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="st">"gridExtra"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in library("gridExtra"): there is no package called 'gridExtra'</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb146">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">grid.arrange</span><span class="op">(</span><span class="va">count_gene_chromosome</span>, <span class="va">exp_boxplot_sex</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in grid.arrange(count_gene_chromosome, exp_boxplot_sex, ncol = 2): could not find function "grid.arrange"</code></pre>
</div>
<p>En plus des arguments <code>ncol</code> et <code>nrow</code>,
utilisés pour créer des arrangements simples, il existe des outils pour
<a href="https://cran.r-project.%20org/web/packages/gridExtra/vignettes/arrangeGrob.html" class="external-link">construire
des dispositions plus complexes</a>.</p>
</section><section><h2 class="section-heading" id="exporter-des-graphiques">Exporter des graphiques<a class="anchor" aria-label="anchor" href="#exporter-des-graphiques"></a>
</h2>
<hr class="half-width">
<p>Après avoir créé votre graphique, vous pouvez le sauvegarder dans un
fichier, avec votre format préféré. L’onglet <strong>Export</strong>
dans le volet <strong>Plot</strong> de RStudio enregistrera vos
graphiques, mais néanmoins à basse résolution, ce qui pourrait
compromettre leur publication dans de nombreuses revues et qui ne
s’adaptera pas bien aux posters de grande taille.</p>
<p>Utilisez plutôt la fonction <code>ggsave()</code>, qui vous permet de
modifier facilement la dimension et la résolution de votre tracé en
modifiant les arguments appropriés (<code>width</code>,
<code>height</code> et <code>dpi</code> ).</p>
<p>Assurez-vous d’avoir le dossier <code>fig_output/</code> dans votre
répertoire de travail.</p>
<div class="codewrapper sourceCode" id="cb148">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mean_exp_by_time_sex</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">mean_exp</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">gene</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Mean gene expression by duration of the infection"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Duration of the infection (in days)"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Mean gene expression"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>color<span class="op">=</span><span class="fu">guide_legend</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Gender"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"royalblue4"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"royalblue4"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>        panel.grid <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"lightsteelblue1"</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="st">"fig_output/mean_exp_by_time_sex.png"</span>, <span class="va">my_plot</span>, width <span class="op">=</span> <span class="fl">15</span>,</span>
<span>       height <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This also works for grid.arrange() plots</span></span>
<span><span class="va">combo_plot</span> <span class="op">&lt;-</span> <span class="fu">grid.arrange</span><span class="op">(</span><span class="va">count_gene_chromosome</span>, <span class="va">exp_boxplot_sex</span>,</span>
<span>                           ncol <span class="op">=</span> <span class="fl">2</span>, widths <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="st">"fig_output/combo_plot_chromosome_sex.png"</span>, <span class="va">combo_plot</span>,</span>
<span>       width <span class="op">=</span> <span class="fl">10</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code></pre>
</div>
<p>Remarque : Les paramètres “width” et “height” déterminent également
la taille de la police dans le graphique enregistré.</p>
</section><section><h2 class="section-heading" id="autres-packages-pour-la-visualisation">Autres packages pour la visualisation<a class="anchor" aria-label="anchor" href="#autres-packages-pour-la-visualisation"></a>
</h2>
<hr class="half-width">
<p><code>ggplot2</code> est un package très puissant qui s’intègre très
bien dans l’ensemble <em>tidy data</em> et <em>tidy tools</em>. Il
existe cependant d’autres packages de visualisation dans R qu’il est
intéressant de connaître également.</p>
<div class="section level3">
<h3 id="base-graphics">
<em>Base graphics</em><a class="anchor" aria-label="anchor" href="#base-graphics"></a>
</h3>
<p>Le système graphique par défaut fourni avec R, souvent appelé
<em>base R graphics</em> est simple et rapide. Il est basé sur le
<em>painter’s or canvas model</em>, où différentes sorties sont
directement superposées les unes sur les autres (voir figure <span class="citation">@ref</span>(fig:paintermodel)). C’est une différence
fondamentale avec <code>ggplot2</code> (et avec <code>lattice</code>,
décrit ci-dessous), qui renvoie des objets dédiés, qui sont visualisés à
l’écran ou dans un fichier, et qui peuvent même être modifiés.</p>
<div class="codewrapper sourceCode" id="cb149">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">par</span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, main <span class="op">=</span> <span class="st">"Première couche, produite avec plot(1:20)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, main <span class="op">=</span> <span class="st">"Une ligne rouge horizontale, ajoutée avec abline(h = 10)"</span><span class="op">)</span></span>
<span><span class="fu">abline</span><span class="op">(</span>h <span class="op">=</span> <span class="fl">10</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, main <span class="op">=</span> <span class="st">"Un rectangle , ajouté avec rect(5, 5, 15, 15)"</span><span class="op">)</span></span>
<span><span class="fu">abline</span><span class="op">(</span>h <span class="op">=</span> <span class="fl">10</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu">rect</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">15</span>, <span class="fl">15</span>, lwd <span class="op">=</span> <span class="fl">3</span> <span class="op">)</span></span></code></pre>
</div>
<figure style="text-align: center"><img src="../fig/40-visualization-rendered-paintermodel-1.png" alt="Successive layers added on top of each other." class="figure mx-auto d-block"><figcaption>
Successive layers added on top of each other.
</figcaption></figure><p>Une autre différence importante est que les fonctions de <em>base
graphics</em> essaient de deviner ce que l’utilisateur veut faire, en
fonction de leur type d’entrée, c’est-à-dire qu’elles adapteront leur
comportement en fonction de la classe de leur entrée. C’est encore une
fois très différent de ce que nous avons avec <code>ggplot2</code>, qui
n’accepte que les <em>data frames</em> en entrée, et qui nécessite que
les graphiques soient construits petit à petit.</p>
<div class="codewrapper sourceCode" id="cb150">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">par</span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">boxplot</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Boxplot de rnorm(100)"</span><span class="op">)</span></span>
<span><span class="fu">boxplot</span><span class="op">(</span><span class="fu">matrix</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span> <span class="fl">100</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Boxplot de la matrice(rnorm(100), ncol = 10)"</span><span class="op">)</span></span>
<span><span class="fu">hist</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">hist</span><span class="op">(</span> <span class="fu">matrice</span><span class="op">(</span><span class="fu">rnorm</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in matrice(rnorm(100), ncol = 10): could not find function "matrice"</code></pre>
</div>
<figure style="text-align: center"><img src="../fig/40-visualization-rendered-plotmethod-1.png" alt="Plotting boxplots (top) and histograms (bottom) vectors (left) or a matrices (right)." class="figure mx-auto d-block"><figcaption>
Plotting boxplots (top) and histograms (bottom) vectors (left) or a
matrices (right).
</figcaption></figure><p>L’approche ‘clé sur porte’ de <em>base graphics</em> peut être très
efficace pour des figures simples et standards, qui peuvent être
produites très rapidement avec une seule ligne de code et une seule
fonction telle que <code>plot</code>, <code>hist</code>, ou
<code>boxplot</code>, … Les valeurs par défaut ne sont cependant pas
toujours les plus pertinentes et le peaufinage des figures peut devenir
long et fastidieux, surtout lorsqu’elles deviennent plus complexes (par
exemple pour le <em>faceting</em>).</p>
</div>
<div class="section level3">
<h3 id="le-package-lattice">Le package <em>lattice</em>
<a class="anchor" aria-label="anchor" href="#le-package-lattice"></a>
</h3>
<p>Le package <strong><code>lattice</code></strong> est similaire à
<code>ggplot2</code> dans le sens où il utilise des <em>data frames</em>
en entrée, renvoie des objets graphiques et prend en charge le
<em>faceting</em>. Cependant, <code>lattice</code> n’est pas basé sur la
<em>Grammar of Graphics</em> et a une interface plus alambiquée.</p>
<p>Une bonne référence pour le package <code>lattice</code> est <span class="citation">@latticebook</span>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Visualisation en R</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-60-next-steps"><p>Content from <a href="60-next-steps.html">Prochaines étapes</a></p>
<hr>
<p>Last updated on 2025-05-05 |

        <a href="https://github.com/carpentries-incubator/bioc-intro/edit/main/episodes/60-next-steps.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 90 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Qu’est-ce qu’un « SummarizedExperiment » ?</li>
<li>Qu’est-ce que Bioconductor ?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Présenter le projet Bioconductor.</li>
<li>Introduire la notion de ‘conteneurs’ de données.</li>
<li>Donner un aperçu du <code>SummarizedExperiment</code>, très
fréquemment utilisé dans les analyses de données de type omiques.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="prochaines-étapes">Prochaines étapes<a class="anchor" aria-label="anchor" href="#prochaines-%C3%A9tapes"></a>
</h2>
<hr class="half-width">
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in bibliothèque("tidyverse"): could not find function "bibliothèque"</code></pre>
</div>
<p>Pour faciliter l’analyse des données omiques qui sont généralement
complexes, les développeurs ont défini des conteneurs spécialisés
(appelés classes), spécifiquement adaptés à leurs propriétés, afin de
pouvoir les stocker et les manipuler facilement.</p>
<p>Cet aspect est central au projet <strong>Bioconductor</strong><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> qui
utilise la même <strong>infrastructure de données</strong> dans tous ses
<em>packages</em>. Il est en effet demandé aux développeurs de packages
Bioconductor d’utiliser l’infrastructure existante pour assurer la
cohérence, l’interopérabilité et la stabilité du projet dans son
ensemble. Ceci a d’ailleurs certainement contribué au succès de
Bioconductor . Ceci a d’ailleurs certainement contribué au succès de
Bioconductor .</p>
<p>Pour illustrer la notion de <strong>conteneur de données
omiques</strong>, nous présenterons la classe appelée
<code>SummarizedExperiment</code>.</p>
</section><section><h2 class="section-heading" id="summarizedexperiment">SummarizedExperiment<a class="anchor" aria-label="anchor" href="#summarizedexperiment"></a>
</h2>
<hr class="half-width">
<p>La figure ci-dessous représente la structure de cette classe.</p>
<figure><img src="https://uclouvain-cbio.github.io/WSBIM1322/figs/SE.svg" width="80%" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Les objets de la classe SummarizedExperiment contiennent :</p>
<ul>
<li><p><strong>Un (ou plusieurs) test(s)</strong> contenant les données
omiques quantitatives (données d’expression), stockées sous forme
d’objet de type matriciel. dans lesquelles les lignes représentent les
<em>features</em> (les variables mesurées, comme par exemple les gènes
dans le cas d’une analyse RNAseq) et les colonnes représentent les
différents échantillons analysés.</p></li>
<li><p>Les métadonnées décrivant les échantillons sous forme d’un
<em>data frame</em>. Les lignes de ce tableau représentent les
différents échantillons (l’ordre des lignes doit correspondre exactement
à l’ordre des colonnes des données d’expression).</p></li>
<li><p>Un <em>slot</em> avec les <strong>métadonnées décrivant les
<em>features</em></strong> sous forme d’un <em>data frame</em>.
également. Dans cette table, les lignes représentent chaque
<em>feature</em> et l’ordre de ces lignes doit être le même que dans la
table des données d’expression. Les colonnes de cette table représentent
les co-variables des <em>features</em> comme par exemple la localisation
chromosomique des gènes, leur référence ENSEMBL ou leur
fonction.</p></li>
</ul>
<p>La structure coordonnée du <code>SummarizedExperiment</code> garantit
que lors de la manipulation des données, les dimensions des différents
<em>slots</em> corresponderont toujours (c’est-à-dire les colonnes des
données d’expression puis les lignes de les exemples de métadonnées,
ainsi que les lignes des données d’expression et les métadonnées des
fonctionnalités). Par exemple, si nous devions exclure un échantillon du
test, il serait automatiquement supprimé des métadonnées de
l’échantillon au cours de la même opération.</p>
<p>On peut par contre peut ajouter aux <em>slots</em> de métadonnées des
co-variables supplémentaires (colonnes) sans affecter les autres
structures.</p>
<div class="section level3">
<h3 id="création-dun-summarizedexperiment">Création d’un SummarizedExperiment<a class="anchor" aria-label="anchor" href="#cr%C3%A9ation-dun-summarizedexperiment"></a>
</h3>
<p>Afin de créer un <code>SummarizedExperiment</code>, nous allons
commencer par en créer les composants individuels, c’est-à-dire la
matrice de comptage, la table de métadonnées des échantillons et celle
des <em>features</em>. Nous allons générer ces tables à partir de
fichiers csv C’est généralement ainsi que les données RNA-Seq sont
fournies (après le traitement des données brutes).</p>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in read_csv("data/rnaseq.csv"): could not find function "read_csv"</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in pivot_wider(select(rna, gene, sample, expression), names_from = sample, : could not find function "pivot_wider"</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in select(counts, -gene): could not find function "select"</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'counts' not found</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in select(rna, sample, organism, age, sex, infection, strain, time, : could not find function "select"</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'sample_metadata' not found</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in select(rna, gene, ENTREZID, product, ensembl_gene_id, external_synonym, : could not find function "select"</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'gene_metadata' not found</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, p): object 'count_matrix' not found</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, p): object 'gene_metadata' not found</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, p): object 'sample_metadata' not found</code></pre>
</div>
<ul>
<li>
<strong>Une matrice d’expression</strong> : nous chargeons la
matrice de comptage, en spécifiant que la première colonnes contient les
noms des gènes, et nous convertissons le <em>data frame</em> en une
<code>matrice</code>. Vous pouvez télécharger le <em>data frame</em> <a href="https://carpentries-incubator.github.io/bioc-intro/data/count_matrix.csv" class="external-link">ici</a>.</li>
</ul>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_matrix</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/count_matrix.csv"</span>,</span>
<span>                         row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">as.matrix</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in read.csv("data/count_matrix.csv", row.names = 1) %&gt;% as.matrix(): could not find function "%&gt;%"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'count_matrix' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="va">count_matrix</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'count_matrix' not found</code></pre>
</div>
<ul>
<li>
<strong>Un tableau décrivant les échantillons</strong>, disponible
<a href="https://carpentries-incubator.github.io/bioc-intro/data/sample_metadata.csv" class="external-link">ici</a>.</li>
</ul>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_metadata</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/sample_metadata.csv"</span><span class="op">)</span></span>
<span><span class="va">sample_metadata</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       sample     organism age    sex   infection  strain time     tissue mouse
1  GSM2545336 Mus musculus   8 Female  InfluenzaA C57BL/6    8 Cerebellum    14
2  GSM2545337 Mus musculus   8 Female NonInfected C57BL/6    0 Cerebellum     9
3  GSM2545338 Mus musculus   8 Female NonInfected C57BL/6    0 Cerebellum    10
4  GSM2545339 Mus musculus   8 Female  InfluenzaA C57BL/6    4 Cerebellum    15
5  GSM2545340 Mus musculus   8   Male  InfluenzaA C57BL/6    4 Cerebellum    18
6  GSM2545341 Mus musculus   8   Male  InfluenzaA C57BL/6    8 Cerebellum     6
7  GSM2545342 Mus musculus   8 Female  InfluenzaA C57BL/6    8 Cerebellum     5
8  GSM2545343 Mus musculus   8   Male NonInfected C57BL/6    0 Cerebellum    11
9  GSM2545344 Mus musculus   8 Female  InfluenzaA C57BL/6    4 Cerebellum    22
10 GSM2545345 Mus musculus   8   Male  InfluenzaA C57BL/6    4 Cerebellum    13
11 GSM2545346 Mus musculus   8   Male  InfluenzaA C57BL/6    8 Cerebellum    23
12 GSM2545347 Mus musculus   8   Male  InfluenzaA C57BL/6    8 Cerebellum    24
13 GSM2545348 Mus musculus   8 Female NonInfected C57BL/6    0 Cerebellum     8
14 GSM2545349 Mus musculus   8   Male NonInfected C57BL/6    0 Cerebellum     7
15 GSM2545350 Mus musculus   8   Male  InfluenzaA C57BL/6    4 Cerebellum     1
16 GSM2545351 Mus musculus   8 Female  InfluenzaA C57BL/6    8 Cerebellum    16
17 GSM2545352 Mus musculus   8 Female  InfluenzaA C57BL/6    4 Cerebellum    21
18 GSM2545353 Mus musculus   8 Female NonInfected C57BL/6    0 Cerebellum     4
19 GSM2545354 Mus musculus   8   Male NonInfected C57BL/6    0 Cerebellum     2
20 GSM2545362 Mus musculus   8 Female  InfluenzaA C57BL/6    4 Cerebellum    20
21 GSM2545363 Mus musculus   8   Male  InfluenzaA C57BL/6    4 Cerebellum    12
22 GSM2545380 Mus musculus   8 Female  InfluenzaA C57BL/6    8 Cerebellum    19</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="va">sample_metadata</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 22  9</code></pre>
</div>
<ul>
<li>
<strong>Un tableau décrivant les gènes</strong>, disponible <a href="https://carpentries-incubator.github.io/bioc-intro/data/gene_metadata.csv" class="external-link">ici</a>.</li>
</ul>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_metadata</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/gene_metadata.csv"</span><span class="op">)</span></span>
<span><span class="va">gene_metadata</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      gene ENTREZID
1      Asl   109900
2     Apod    11815
3  Cyp2d22    56448
4     Klk6    19144
5    Fcrls    80891
6   Slc2a4    20528
7     Exd2    97827
8     Gjc2   118454
9     Plp1    18823
10    Gnb4    14696
                                                                         product
1                                 argininosuccinate lyase, transcript variant X1
2                                         apolipoprotein D, transcript variant 3
3   cytochrome P450, family 2, subfamily d, polypeptide 22, transcript variant 2
4                           kallikrein related-peptidase 6, transcript variant 2
5                  Fc receptor-like S, scavenger receptor, transcript variant X1
6            solute carrier family 2 (facilitated glucose transporter), member 4
7                                          exonuclease 3'-5' domain containing 2
8                            gap junction protein, gamma 2, transcript variant 1
9                           proteolipid protein (myelin) 1, transcript variant 1
10 guanine nucleotide binding protein (G protein), beta 4, transcript variant X2
      ensembl_gene_id
1  ENSMUSG00000025533
2  ENSMUSG00000022548
3  ENSMUSG00000061740
4  ENSMUSG00000050063
5  ENSMUSG00000015852
6  ENSMUSG00000018566
7  ENSMUSG00000032705
8  ENSMUSG00000043448
9  ENSMUSG00000031425
10 ENSMUSG00000027669</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="va">gene_metadata</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1474    9</code></pre>
</div>
<p>Nous allons créer un <code>SummarizedExperiment</code> à partir de
ces tables :</p>
<ul>
<li><p>La matrice de comptage sera utilisée comme
<em><strong>assay</strong></em></p></li>
<li><p>Le tableau décrivant les échantillons sera utilisé comme
emplacement de métadonnées **sample **</p></li>
<li><p>Le tableau décrivant les gènes sera utilisé comme emplacement de
métadonnées **features **</p></li>
</ul>
<p>Nous allons assembler les différentes parties à l’aide du
constructeur <code>SummarizedExperiment</code> :</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## BiocManager::install("SummarizedExperiment")</span></span>
<span><span class="fu">bibliothèque</span><span class="op">(</span><span class="st">"SummarizedExperiment"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in bibliothèque("SummarizedExperiment"): could not find function "bibliothèque"</code></pre>
</div>
<p>Tout d’abord, il est impératif de s’assurer que les échantillons sont
dans le même ordre dans la matrice de comptage et dans les annotations
des échantillons. De même, nous allons vérifier que l’ordre des gènes de
la matrice de comptage correspond bien à l’ordre des gènes dans les
métadonnées les décrivant.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stopifnot</span><span class="op">(</span><span class="fu">rownames</span><span class="op">(</span><span class="va">count_matrix</span><span class="op">)</span> <span class="op">==</span> <span class="va">gene_metadata</span><span class="op">$</span><span class="va">gene</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'count_matrix' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stopifnot</span><span class="op">(</span><span class="fu">colnames</span><span class="op">(</span><span class="va">count_matrix</span><span class="op">)</span> <span class="op">==</span> <span class="va">sample_metadata</span><span class="op">$</span><span class="va">sample</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'count_matrix' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperiment</span><span class="op">(</span>assays <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>counts <span class="op">=</span> <span class="va">count_matrix</span><span class="op">)</span>,</span>
<span>                           colData <span class="op">=</span> <span class="va">sample_metadata</span>,</span>
<span>                           rowData <span class="op">=</span> <span class="va">gene_metadata</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in SummarizedExperiment(assays = list(counts = count_matrix), colData = sample_metadata, : could not find function "SummarizedExperiment"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'se' not found</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="la-sauvegarde-des-données">La sauvegarde des données<a class="anchor" aria-label="anchor" href="#la-sauvegarde-des-donn%C3%A9es"></a>
</h3>
<p>L’export de données vers un tableur, comme nous l’avons fait dans un
épisode précédent, présente plusieurs limitations, comme celles décrites
dans le premier chapitre (éventuelles incohérences avec <code>,</code>
et <code>.</code> pour les séparateurs décimaux et manque de définitions
de types de variables). De plus, l’exportation de données vers une
feuille de calcul n’est pertinente que pour les données rectangulaires
telles que les <em>data frames</em> et les matrices.</p>
<p>Une manière plus générale de sauvegarder des données, spécifique à R
et dont le fonctionnement est garanti sur n’importe quel système
d’exploitation, consiste à utiliser la fonction <code>saveRDS()</code> .
Cette fonction sauvegardera une représentation binaire de l’objet sur le
disque (en utilisant l’extension de fichier <code>.rds</code> ici), et
celle-ci pourra être rechargée dans R à l’aide de la fonction
<code>readRDS</code>.</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">saveRDS</span><span class="op">(</span><span class="va">se</span>, file <span class="op">=</span> <span class="st">"data_output/se.rds"</span><span class="op">)</span></span>
<span><span class="fu">rm</span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu">readRDS</span><span class="op">(</span><span class="st">"data_output/se.rds"</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span></code></pre>
</div>
<p>Pour conclure, lorsqu’il s’agit de sauvegarder des données qui seront
re-chargées ultérieurement dans R, la sauvegarde et le chargement avec
<code>saveRDS</code> et <code>readRDS</code> sont les approches les plus
adéquates. Si les données tabulaires doivent être partagées avec
quelqu’un qui n’utilise pas R, alors l’exportation vers une feuille de
calcul sous forme de texte est une bonne alternative.</p>
<p>En utilisant cette structure de données, nous pouvons accéder à la
matrice d’expression avec la fonction <code>assay()</code> :</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="fu">essai</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in essai(se): could not find function "essai"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="fu">essai</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in essai(se): could not find function "essai"</code></pre>
</div>
<p>Nous pouvons accéder aux de métadonnées des échantillons à l’aide de
la fonction <code>colData</code> :</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in colData(se): could not find function "colData"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in colData(se): could not find function "colData"</code></pre>
</div>
<p>Nous pouvons également accéder aux métadonnées des <em>features</em>
à l’aide de la fonction <code>rowData()</code> :</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="fu">rowData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in rowData(se): could not find function "rowData"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="fu">rowData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in rowData(se): could not find function "rowData"</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="sous-ensemble-dun-summarizedexperiment">Sous-ensemble d’un SummarizedExperiment<a class="anchor" aria-label="anchor" href="#sous-ensemble-dun-summarizedexperiment"></a>
</h3>
<p>Il est possible d’extraire un sous-ensemble d’un SummarizedExperiment
exactement de la même manière que pour un <em>data frame</em>, en
utilsant des indices ou des caractères logiques.</p>
<p>Ci-dessous, nous allons créer par exemple un nouveau
SummarizedExperiment qui ne contient que les 5 premiers gènes et les 3
premiers échantillons.</p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se1</span> <span class="op">&lt;-</span> <span class="va">se</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'se' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'se1' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colData</span><span class="op">(</span><span class="va">se1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in colData(se1): could not find function "colData"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rowData</span><span class="op">(</span><span class="va">se1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in rowData(se1): could not find function "rowData"</code></pre>
</div>
<p>Nous pouvons également utiliser la fonction <code>colData()</code>
pour créer un sous-ensemble basé sur une caractéristique des
échantillons, ou la fonction <code>rowData()</code> pour créer un
sous-ensemble basé sur une caractéristique des gènes. Dans l’exemple
ci-dessous, nous n’allons conserver que les gènes correspondant à des
miRNAs et uniquement les échantillons non-infectés :</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se1</span> <span class="op">&lt;-</span> <span class="va">se</span><span class="op">[</span><span class="fu">rowData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">gene_biotype</span> <span class="op">==</span> <span class="st">"miRNA"</span>,</span>
<span>          <span class="fu">colData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">infection</span> <span class="op">==</span> <span class="st">"NonInfected"</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'se' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'se1' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">assay</span><span class="op">(</span><span class="va">se1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in assay(se1): could not find function "assay"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colData</span><span class="op">(</span><span class="va">se1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in colData(se1): could not find function "colData"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb66">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rowData</span><span class="op">(</span><span class="va">se1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in rowData(se1): could not find function "rowData"</code></pre>
</div>
<!--For the following exercise, you should download the SE.rda object
(that contains the `se` object), and open the file using the 'load()'
function.-->
<!-- ```{r, eval = FALSE, echo = FALSE} -->
<!-- download.file(url = "https://raw.githubusercontent.com/UCLouvain-CBIO/bioinfo-training-01-intro-r/master/data/SE.rda", -->
<!--               destfile = "data/SE.rda") -->
<!-- load("data/SE.rda") -->
<!-- ``` -->
<div id="défi" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Extraire les niveaux d’expression génique des 3 premiers gènes dans
les échantillons collectés au temps 0 et au temps 8.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">assay</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fu">colData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">time</span> <span class="op">!=</span> <span class="fl">4</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in assay(se): could not find function "assay"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Equivalent to</span></span>
<span><span class="fu">assay</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fu">colData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">time</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">|</span> <span class="fu">colData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">time</span> <span class="op">==</span> <span class="fl">8</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in assay(se): could not find function "assay"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="défi-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="défi-1" class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Vérifiez que vous obtenez les mêmes valeurs en utilisant la longue
table <code>rna</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arn</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">filtre</span><span class="op">(</span><span class="va">gène</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Asl"</span>, <span class="st">"Apod"</span>, <span class="st">"Cyd2d22"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">filtre</span><span class="op">(</span><span class="va">temps</span> <span class="op">!=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">expression</span> <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in select(filtre(filtre(arn, gène %in% c("Asl", "Apod", "Cyd2d22")), : could not find function "select"</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>La table en format long et le <code>SummarizedExperiment</code>
contiennent les mêmes informations, mais sont simplement structurés
différemment. Chaque structure a ses avantages propres: la première
convient bien aux <em>packages</em> <code>tidyverse</code>, tandis que
la seconde est une structure adéquate pour faciliter l’analyse et le
traitement statistique de nombreuses données omiques. Le
<code>SummarizedExperiment</code> est par exemple utilisé lors des
analyses de RNA-seq avec le package <code>DESeq2</code>.</p>
<div class="section level4">
<h4 id="ajouter-des-variables-aux-métadonnées">Ajouter des variables aux métadonnées<a class="anchor" aria-label="anchor" href="#ajouter-des-variables-aux-m%C3%A9tadonn%C3%A9es"></a>
</h4>
<p>Comme mentionné ci-dessus, il est possible d’ajouter des informations
aux métadonnées. Supposons que vous souhaitiez ajouter le centre où les
échantillons ont été collectés…</p>
<div class="codewrapper sourceCode" id="cb74">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">center</span> <span class="op">&lt;-</span> <span class="fu">rep</span><span class="op">(</span><span class="st">"Université de l'Illinois"</span>, <span class="fu">nrow</span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in colData(se): could not find function "colData"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb76">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in colData(se): could not find function "colData"</code></pre>
</div>
<p>Cela illustre le fait que les <em>slots</em> de métadonnées peuvent
croître indéfiniment sans affecter les autres structures !</p>
</div>
</div>
<div class="section level3">
<h3 id="tidyrésuméexpérience">TidyRésuméExpérience<a class="anchor" aria-label="anchor" href="#tidyr%C3%A9sum%C3%A9exp%C3%A9rience"></a>
</h3>
<p>Vous vous demandez peut-être si pouvons-nous utiliser les commandes
Tidyverse pour interagir avec les objets
<code>SummarizedExperiment</code> ? La réponse est oui, nous pouvons le
faire grâce au package <code>tidySummarizedExperiment</code>.</p>
<p>Rappelez-vous à quoi ressemble notre objet SummarizedExperiment :</p>
<div class="codewrapper sourceCode" id="cb78">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'se' not found</code></pre>
</div>
<p>Chargez <code>tidySummarizedExperiment</code> puis jetez à nouveau un
œil à l’objet se .</p>
<div class="codewrapper sourceCode" id="cb80">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#BiocManager::install("tidySummarizedExperiment")</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"tidySummarizedExperiment"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in library("tidySummarizedExperiment"): there is no package called 'tidySummarizedExperiment'</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb82">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'se' not found</code></pre>
</div>
<p>Il s’agit toujours d’un objet <code>SummarizedExperiment</code>, il
conserve donc sa structure spécifique, mais nous pouvons maintenant le
voir comme un <em>tibble</em>. Notez la première ligne de la sortie dit
ceci, c’est une abstraction
<code>SummarizedExperiment</code>-<code>tibble</code> . Nous pouvons
également voir dans la deuxième ligne affichée le nombre de gènes et
d’échantillons.</p>
<p>Si nous voulons revenir à la vue standard
<code>SummarizedExperiment</code>, nous pouvons le faire.</p>
<div class="codewrapper sourceCode" id="cb84">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">options</span><span class="op">(</span><span class="st">"restore_SummarizedExperiment_show"</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">se</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'se' not found</code></pre>
</div>
<p>Mais ici, nous restons sur la vue tibble.</p>
<div class="codewrapper sourceCode" id="cb86">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">options</span><span class="op">(</span><span class="st">"restore_SummarizedExperiment_show"</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">se</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'se' not found</code></pre>
</div>
<p>Nous pouvons maintenant utiliser les commandes Tidyverse pour
interagir avec l’objet <code>SummarizedExperiment</code>.</p>
<p>Nous pouvons utiliser <code>filter</code> pour filtrer les lignes en
utilisant une condition, par exemple pour afficher toutes les lignes
pour un échantillon.</p>
<div class="codewrapper sourceCode" id="cb88">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span> <span class="op">%&gt;%</span> <span class="fu">filtre</span><span class="op">(</span><span class="va">.sample</span> <span class="op">==</span> <span class="st">"GSM2545336"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in se %&gt;% filtre(.sample == "GSM2545336"): could not find function "%&gt;%"</code></pre>
</div>
<p>Nous pouvons utiliser « select » pour spécifier les colonnes que nous
voulons afficher.</p>
<div class="codewrapper sourceCode" id="cb90">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span> <span class="op">%&gt;%</span> <span class="fu">sélectionner</span> <span class="op">(</span><span class="va">.sample</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in se %&gt;% sélectionner(.sample): could not find function "%&gt;%"</code></pre>
</div>
<p>Nous pouvons utiliser <code>mutate</code> pour ajouter des
informations sur les métadonnées.</p>
<div class="codewrapper sourceCode" id="cb92">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span> <span class="op">%&gt;%</span> <span class="fu">muter</span><span class="op">(</span>center <span class="op">=</span> <span class="st">"Université de Heidelberg"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in se %&gt;% muter(center = "Université de Heidelberg"): could not find function "%&gt;%"</code></pre>
</div>
<p>Nous pouvons également combiner des commandes avec le <em>pipe</em>
‘%&gt;%’ de tidyverse . Pour l’exemple de , nous pourrions combiner
<code>group_by</code> et <code>summarise</code> pour obtenir le nombre
total de pour chaque échantillon.</p>
<div class="codewrapper sourceCode" id="cb94">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">.sample</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarise</span><span class="op">(</span>total_counts<span class="op">=</span><span class="fu">sum</span><span class="op">(</span><span class="va">counts</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in se %&gt;% group_by(.sample) %&gt;% summarise(total_counts = sum(counts)): could not find function "%&gt;%"</code></pre>
</div>
<p>Nous pouvons également utiliser l’objet
<code>SummarizedExperiment</code> comme un <em>tibble</em> classique
pour la visualisation.</p>
<p>Ici, nous traçons la distribution des comptes par échantillon.</p>
<div class="codewrapper sourceCode" id="cb96">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">counts</span> <span class="op">+</span> <span class="fl">1</span>, group<span class="op">=</span><span class="va">.sample</span>, color<span class="op">=</span><span class="va">infection</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(se, aes(counts + 1, group = .sample, color = infection)): could not find function "ggplot"</code></pre>
</div>
<p>Pour plus d’informations sur <code>TidySummarizedExperiment</code>,
consultez le site Web du package <a href="https://stemangiola.github.io/tidySummarizedExperiment/" class="external-link">ici</a>.</p>
<p><strong>A retenir</strong></p>
<ul>
<li><p>Le <code>SummarizedExperiment</code> est un moyen très efficace
de stocker et de gérer les données omiques.</p></li>
<li><p>Les <code>SummarizedExperiments</code>sont utilisés dans de
nombreux <em>packages</em> Bioconductor.</p></li>
</ul>
<p>Si vous suivez la prochaine formation axée sur l’analyse de
séquençage d’ARN, vous apprendrez à utiliser le package Bioconductor
<code>DESeq2</code> pour faire des analyses d’expression différentielle.
Ce <em>package</em> utilise un <code>SummarizedExperiment</code> pour
traiter l’ensemble des données.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Bioconductor est un projet qui fournit un cadre et des
<em>packages</em> pour faciliter l’analyse et l’interprétation des
données issues de la biologie à haut débit.</li>
<li>Un <code>SummarizedExperiment</code> est un type d’objet
particulièrement utile pour stocker et traiter ce type de donnée.</li>
</ul>
</div>
</div>
</div>
</div>
</section><div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Le <a href="https://www.bioconductor.org" class="external-link">projet
Bioconductor</a> a été initié par Robert Gentleman, l’un des deux
créateurs du langage R . Bioconductor utilise le langage R pour fournir
des outils dédiés à l’analyse des données omiques. Bioconductor est
<em>open source</em> et <em>open development</em>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/carpentries-incubator/bioc-intro/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/carpentries-incubator/bioc-intro/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries-incubator/bioc-intro/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries-incubator/bioc-intro/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:laurent.gatto@uclouvain.be">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.11" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.5" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries-incubator.github.io/bioc-intro/instructor/aio.html",
  "inLanguage": "fr",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://carpentries-incubator.github.io/bioc-intro/instructor/aio.html",
  "identifier": "https://carpentries-incubator.github.io/bioc-intro/instructor/aio.html",
  "dateCreated": "2020-09-14",
  "dateModified": "2025-05-05",
  "datePublished": "2025-05-05"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

