---
source: Rmd
title: Organisation des données avec des feuilles de calcul
teaching: 30
exercises: 30
---

```{r, include=FALSE}

```

::::::::::::::::::::::::::::::::::::::: objectives

- Découvrez les feuilles de calcul, leurs forces et leurs faiblesses.
- Comment formater les données dans des feuilles de calcul pour une utilisation efficace des données ?
- Découvrez les erreurs courantes des feuilles de calcul et comment les corriger.
- Organisez vos données selon des principes de données propres.
- Découvrez les formats de feuilles de calcul textuels tels que les formats séparés par des virgules (CSV) ou par des tabulations (TSV).

::::::::::::::::::::::::::::::::::::::::::::::::::

:::::::::::::::::::::::::::::::::::::::: questions

- Comment organiser des données tabulaires ?

::::::::::::::::::::::::::::::::::::::::::::::::::

> Cet épisode est basé sur la leçon _Analyse des données et
> Visualisation dans R pour les écologistes_ de Data Carpentries.

## Tableurs

**Question**

- Quels sont les principes de base d'utilisation des feuilles de calcul pour une bonne organisation des données
   ?

**Objectifs**

- Décrire les bonnes pratiques pour organiser les données afin que les ordinateurs puissent en faire
  la meilleure utilisation.

**Point clé**

- Une bonne organisation des données est la base de tout projet de recherche.

Good data organization is the foundation of your research
project. Most researchers have data or do data entry in
spreadsheets. Spreadsheet programs are very useful graphical
interfaces for designing data tables and handling very basic data
quality control functions. See also @Broman:2018.

### Spreadsheet outline

Spreadsheets are good for data entry. Therefore we have a lot of data
in spreadsheets.  Much of your time as a researcher will be spent in
this 'data wrangling' stage.  It's not the most fun, but it's
necessary. We'll teach you how to think about data organization and
some practices for more effective data wrangling.

### What this lesson will not teach you

- How to do _statistics_ in a spreadsheet
- How to do _plotting_ in a spreadsheet
- How to _write code_ in spreadsheet programs

If you're looking to do this, a good reference is Head First
Excel,
published by O'Reilly.

### Pourquoi n'enseignons-nous pas l'analyse de données dans des feuilles de calcul

- L'analyse de données dans des feuilles de calcul nécessite généralement beaucoup de travail manuel. Si vous souhaitez modifier un paramètre ou exécuter une analyse avec un nouvel ensemble de données, vous devez généralement tout refaire à la main. (Nous savons que vous pouvez créer des macros, mais voir le point suivant.)

- Il est également difficile de suivre ou de reproduire des analyses statistiques ou graphiques effectuées dans des tableurs lorsque vous souhaitez revenir à votre travail ou que quelqu'un vous demande des détails sur votre analyse.

Many spreadsheet programs are available. Since most participants
utilise Excel as their primary spreadsheet program, this lesson will
make use of Excel examples. A free spreadsheet program that can also
be used is LibreOffice. Les commandes peuvent différer un peu selon les programmes, mais l'idée générale est la même.

Les tableurs englobent de nombreuses choses que nous devons être en mesure de faire en tant que chercheurs. We can use them for:

- Data entry
- L'organisation des données
- Extraire des sous-ensembles et trier des données
- Des statistiques
- Visualiser des données

Spreadsheet programs use tables to represent and display data. Les données formatées sous forme de tableaux sont également le thème principal de ce chapitre, et nous
verrons comment organiser les données en tableaux de manière standardisée pour assurer une analyse efficace en aval.

:::::::::::::::::::::::::::::::::::::::  challenge

## Challenge: Discuss the following points with your neighbour

- Avez-vous utilisé des feuilles de calcul, dans vos recherches, vos cours, ou à la maison ?
- What kind of operations do you do in spreadsheets?
- Which ones do you think spreadsheets are good for?
- Avez-vous accidentellement fait quelque chose dans un tableur qui vous a rendu frustré ou triste ?

::::::::::::::::::::::::::::::::::::::::::::::::::

### Problems with spreadsheets

Les feuilles de calcul sont utiles pour la saisie de données, mais en réalité, nous avons tendance à utiliser des tableurs pour bien plus que la saisie de données. Nous les utilisons pour créer des tableaux de données pour les publications, pour générer des statistiques récapitulatives et faire des graphiques.

Générer des tableaux pour des publications dans une feuille de calcul n'est pas
optimal - souvent, lors du formatage d'un tableau de données, nous
rapportons les principales statistiques récapitulatives d'une manière qui n'est pas vraiment destinée à être lue comme des données, et implique souvent un formatage spécial
(fusion de cellules, création de bordures, préférences esthétiques pour les couleurs, etc.). Nous vous conseillons d'effectuer ce genre d'opération au sein de votre logiciel d'édition de documents.

Les deux dernières applications, la génération de statistiques et de graphiques, doivent
être utilisées avec précaution : en raison de la nature graphique et glisser-déposer des
tableurs, il peut être très difficile, voire impossible, de
retracer vos pas (et encore plus de retracer ceux de quelqu'un d'autre), en particulier si vos
statistiques ou graphiques nécessitent que vous fassiez des calculs plus complexes. De plus, en effectuant des calculs dans une feuille de calcul, il est facile d'appliquer accidentellement une
formule légèrement différente à plusieurs cellules adjacentes. Lorsque vous utilisez un programme de statistiques basé sur une ligne de commande comme R ou SAS, il est pratiquement impossible d'appliquer un calcul à une observation de votre ensemble de données mais pas à une autre, sauf si vous le faites exprès.

### Using spreadsheets for data entry and cleaning

Dans cette leçon, nous supposerons que vous utilisez très probablement Excel comme tableur principal - il en existe d'autres (gnumeric, Calc d'OpenOffice), et leurs fonctionnalités sont similaires, mais Excel semble être le programme le plus utilisé par les biologistes et les chercheurs en biomédical.

In this lesson we're going to talk about:

1. Formatage de tableaux de données dans des feuilles de calcul
2. Formatting problems
3. Exportation des données

## Formatage de tableaux de données dans des feuilles de calcul

**Questions**

- Comment formater les données dans des feuilles de calcul pour une utilisation efficace des données ?

**Objectives**

- Décrire les meilleures pratiques pour la saisie et le formatage des données dans les feuilles de calcul.

- Appliquer les meilleures pratiques pour organiser les variables et les observations dans une feuille de calcul.

**Keypoints**

- Never modify your raw data. Faites toujours une copie avant d'apporter des modifications.

- Gardez une trace de toutes les étapes que vous suivez pour nettoyer vos données dans un fichier texte brut.

- Organisez vos données selon des principes de données propres.

L'erreur la plus courante est de traiter les tableurs comme des cahiers de laboratoire, c'est-à-dire de s'appuyer sur le contexte, les notes dans la marge, la disposition spatiale
des données et des champs pour transmettre des informations. En tant qu'êtres humains, nous pouvons
(généralement) interpréter cela, mais les ordinateurs ne voient pas les informations
de la même manière, et à moins que nous expliquions à l'ordinateur ce que tout signifie (et ça peut être dur !), il ne pourra pas voir comment
nos données sont reliées.

En utilisant la puissance des ordinateurs, nous pouvons gérer et analyser les données de manière beaucoup
plus efficace et plus rapide, mais pour utiliser cette puissance, nous devons
configurer nos données pour que l'ordinateur puisse les comprendre (et
les ordinateurs sont très littéraux).

This is why it's extremely important to set up well-formatted tables
from the outset - before you even start entering data from your very
first preliminary experiment. Data organization is the foundation of
your research project. Cela peut simplifier ou complexifier le travail avec
vos données tout au long de votre analyse. Ça vaut donc la peine d'y réfléchir au moment où vous effectuez votre saisie de données ou configurez votre expérience. Vous pouvez configurer les choses de différentes manières dans des feuilles de calcul, mais certains de ces choix peuvent limiter votre capacité à travailler avec les données dans d'autres programmes ou empêcher quelqu'un d'autre de travailler avec les données.

**Remarque :** les meilleures mises en page/formats (ainsi que les logiciels et les interfaces
) pour la saisie et l'analyse des données peuvent être différents. It is
important to take this into account, and ideally automate the
conversion from one to another.

### Keeping track of your analyses

Lorsque vous travaillez avec des feuilles de calcul, lors du nettoyage ou des analyses des données, il est très facile de vous retrouver avec une feuille de calcul qui semble très différente de celle avec laquelle vous avez commencée. Afin de pouvoir reproduire vos analyses ou comprendre ce que vous avez fait lorsqu'un relecteur ou un instructeur demande une analyse différente, vous devez

- Créer un nouveau fichier avec vos données nettoyées ou analysées. Ne modifiez pas le jeu de données d'origine, sinon vous ne saurez jamais par où vous avez commencé !

- Garder une trace des étapes que vous avez suivies lors de votre nettoyage ou de votre analyse. Vous devriez noter ces étapes comme vous le feriez pour n’importe quelle étape d’une expérience. Nous vous recommandons de le faire dans un fichier texte brut stocké dans le même dossier que le fichier de données.

Ceci pourrait être un exemple de configuration d'une feuille de calcul :

![](fig/spreadsheet-setup-updated.png)

Put these principles in to practice today during your exercises.

Bien que la gestion des versions soit hors de portée de ce cours, vous pouvez consulter la leçon
_Carpentries_ sur
['Git'](https://swcarpentry.github.io/git-novice/) pour découvrir comment
maintenir le **contrôle des versions** de vos données. See also this blog
post for a quick tutorial or
@Perez-Riverol:2016 for a more research-oriented use-case.

### Structuring data in spreadsheets

The cardinal rules of using spreadsheet programs for data:

1. Mettez toutes vos variables dans des colonnes - ce que vous mesurez, comme "poids" ou "température".
2. Placez chaque observation dans sa propre ligne.
3. Don't combine multiple pieces of information in one cell. Parfois cela semble n'être qu'une seule information, mais demandez-vous si c'est la seule façon dont vous voulez utiliser ou trier ces données.
4. Laissez les données brutes telles quelles - ne les modifiez pas !
5. Exportez les données nettoyées dans un format texte tel que le format CSV (_comma-separated values_ - valeurs séparées par des virgules). Cela garantit que n’importe qui peut utiliser les données et c'est requis par la plupart des référentiels de données.

Par exemple, nous disposons de données provenant de patients ayant visité plusieurs hôpitaux à Bruxelles, en Belgique. La date de la visite,
l'hôpital, le sexe, le poids et le groupe sanguin des patients ont été enregistrés.

Si nous enregistrions les données comme ceci :

![](fig/multiple-info.png)

le problème est que les groupes sanguins ABO et le rhésus sont dans la même colonne `Blood`. Donc, si on voulait examiner toutes les observations du groupe A
ou examiner les distributions de poids par groupe ABO, il serait difficile
de le faire en utilisant cette configuration de données. Si à la place nous mettions les groupes ABO et le rhésus
dans des colonnes différentes, vous voyez que ce serait beaucoup plus facile.

![](fig/single-info.png)

Une règle importante lors de la création d'une feuille de données est que les **colonnes sont utilisées pour les variables** et les **lignes sont utilisées pour les observations** :

- columns are variables
- rows are observations
- cells are individual values

:::::::::::::::::::::::::::::::::::::::  challenge

## Défi : Nous allons prendre un jeu de données désordonné et décrire comment nous allons le nettoyer.

1. Téléchargez un jeu de données désordonné en cliquant sur
  [ici](https://github.com/UCLouvain-CBIO/WSBIM1207/raw/master/data/messy_covid.xlsx).

2. Open up the data in a spreadsheet program.

3. You can see that there are two tabs. Les données contiennent diverses variables cliniques enregistrées dans divers hôpitaux bruxellois lors des première et deuxième vagues du COVID-19 en 2020. Comme vous pouvez le constater, les données ont été enregistrées différemment lors des vagues de mars et novembre. Vous êtes désormais la personne en charge de ce projet et vous souhaitez pouvoir commencer à analyser les données.

4. Avec la personne à côté de vous, identifiez ce qui ne va pas avec cette feuille de calcul. Discutez également des étapes que vous devriez suivre pour nettoyer les onglets de la première et de la deuxième vague, et pour les rassembler tous dans une seule feuille de calcul.

**Important :** N'oubliez pas notre premier conseil : pour créer un
nouveau fichier (ou onglet) pour les données nettoyées, ne modifiez jamais vos données (brutes) d'origine.

::::::::::::::::::::::::::::::::::::::::::::::::::

After you go through this exercise, we'll discuss as a group what was
wrong with this data and how you would fix it.

<!-- - Take about 10 minutes to work on this exercise. -->

<!-- - All the mistakes in the *common mistakes* section below are present -->

<!--   in the messy dataset. If the exercise is done during a workshop, ask -->

<!--   people what they saw as wrong with the data. As they bring up -->

<!--   different points, you can refer to the common mistakes or expand a -->

<!--   bit on the point they brought up. -->

<!-- - If you get a response where they've fixed the date, you can pause -->

<!--   and go to the dates lesson. Or you can say you'll come back to dates -->

<!--   at the end. -->

:::::::::::::::::::::::::::::::::::::::  challenge

## Défi : Une fois que vous avez nettoyé les données, répondez aux questions suivantes :

- How many men and women took part in the study?
- Combien de personnes des groupes A, AB et B ont été testés ?
- Idem, mais sans tenir compte des échantillons contaminés ?
- Combien de personnes des rhésus + et - ont été testés ?
- How many universal donors (O-) have been tested?
- What is the average weight of AB men?
- How many samples have been tested in the different hospitals?

::::::::::::::::::::::::::::::::::::::::::::::::::

An **excellent reference**, in particular with regard to R scripting
is the _Tidy Data_ paper @Wickham:2014.

## Common spreadsheet errors

**Questions**

- Quels sont les problèmes courants liés au formatage des données dans les feuilles de calcul et comment pouvons-nous les éviter ?

**Objectives**

- Recognise and resolve common spreadsheet formatting problems.

**Keypoints**

- Éviter d'utiliser plusieurs tableaux dans une même feuille de calcul.
- Éviter de répartir les données sur plusieurs onglets.
- Enregistrer les zéros comme des zéros.
- Utilisez une valeur vide appropriée pour enregistrer les données manquantes.
- Don't use formatting to convey information or to make your spreadsheet look pretty.
- Place comments in a separate column.
- Record units in column headers.
- Include only one piece of information in a cell.
- Avoid spaces, numbers and special characters in column headers.
- Avoid special characters in your data.
- Record metadata in a separate plain text file.

<!-- This lesson is meant to be used as a reference for discussion as -->

<!-- learners identify issues with the messy dataset discussed in the -->

<!-- previous lesson. Instructors: don't go through this lesson except to -->

<!-- refer to responses to the exercise in the previous lesson. -->

There are a few potential errors to be on the lookout for in your own
data as well as data from collaborators or the Internet. If you are
aware of the errors and the possible negative effect on downstream
data analysis and result interpretation, it might motivate yourself
and your project members to try and avoid them. Making small changes
to the way you format your data in spreadsheets, can have a great
impact on efficiency and reliability when it comes to data cleaning
and analysis.

- [Utilisation de plusieurs tables](#tables)
- [Utilisation de plusieurs onglets](#tabs)
- [Zéros non remplis](#zéros)
- [Utilisation de valeurs vides problématiques](#null)
- [Utilisation du formatage pour transmettre des informations](#formatting)
- [Utilisation du formatage pour rendre la feuille de calcul jolie](#formatting_pretty)
- [Commentaires ou unités dans des cellules](#unités)
- [Plusieurs informations dans une cellule](#info)
- [Using problematic field names](#field_name)
- [Using special characters in data](#special)
- [Inclusion of metadata in data table](#metadata)

### Using multiple tables {#tables}

A common strategy is creating multiple data tables within one
spreadsheet. This confuses the computer, so don't do this!  When you
create multiple tables within one spreadsheet, you're drawing false
associations between things for the computer, which sees each row as
an observation. Vous utilisez également potentiellement le même nom de champ à
plusieurs endroits, ce qui rendra plus difficile le nettoyage de vos données dans
un format utilisable. L'exemple ci-dessous illustre ce problème :

![](fig/2_datasheet_example.jpg)

In the example above, the computer will see (for example) row 4 and
assume that all columns A-AF refer to the same sample. This row
actually represents four distinct samples (sample 1 for each of four
different collection dates - May 29th, June 12th, June 19th, and June
26th), as well as some calculated summary statistics (an average (avr)
and standard error of measurement (SEM)) for two of those
samples. Other rows are similarly problematic.

### Utilisation de plusieurs onglets {#tabs}

But what about workbook tabs? Cela semble être un moyen simple d'organiser les données, n'est-ce pas ? Well, yes and no. Lorsque vous créez des onglets supplémentaires, vous ne permettez pas
à l'ordinateur de voir les connexions dans les données qui s'y trouvent (vous devez introduire des fonctions spécifiques à l'application de feuille de calcul ou des scripts pour garantir cette connexion). Supposons, par exemple, que vous aillez créé un
onglet séparé pour chaque jour où vous prenez une mesure.

This isn't good practice for two reasons:

1. vous êtes plus susceptible d'ajouter accidentellement des incohérences à vos données si à chaque fois que vous prenez une mesure, vous commencez à enregistrer les données dans un nouvel onglet, et

2. même si vous parvenez à empêcher toute incohérence, vous vous ajoutez une étape supplémentaire avant même d'analyser les données car vous devrez combiner ces données en une seule table de données. Vous devrez indiquer explicitement à l'ordinateur comment combiner les onglets - et si les onglets ne sont pas formatés de manière cohérente, vous devrez peut-être même le faire manuellement.

La prochaine fois que vous saisirez des données et que vous créerez un autre onglet
ou un autre tableau, demandez-vous si vous pourriez éviter d'ajouter cet onglet en ajoutant une autre colonne à votre feuille de calcul d'origine. Nous avons utilisé plusieurs onglets dans notre exemple de fichier de données désordonné, mais vous avez maintenant vu comment vous pouvez réorganiser vos données pour regrouper les onglets.

Votre feuille de calcul peut devenir très longue au cours de l'expérience. Cela rend plus difficile la saisie des données si vous ne voyez pas vos en-têtes
en haut de la feuille de calcul mais ne répétez pas votre ligne d'en-tête. These can easily get mixed into the data, leading to problems
down the road. Instead you can freeze the column
headers
so that they remain visible even when you have a spreadsheet with many
rows.

### Zéros non remplis {#zeros}

Il se peut que lorsque vous mesurez quelque chose, il s'agisse généralement d'un zéro, par exemple le nombre de fois qu'un lapin est observé dans l'enquête. Pourquoi s'embêter à écrire le chiffre zéro dans cette colonne, alors qu'il s'agit majoritairement de zéros ?

Cependant, il existe une différence entre un zéro et une cellule vide dans une feuille de calcul. To the computer, a zero is actually data. You measured or
counted it. Une cellule vide signifie qu'elle n'a pas été mesurée et l'ordinateur
l'interprétera comme une valeur inconnue (également appelée valeur vide
ou valeur manquante).

Les feuilles de calcul ou les programmes statistiques interpréteront probablement mal les cellules vides que vous envisagez d'être des zéros. En n'entrant pas la valeur de votre observation, vous dites à votre ordinateur de représenter ces données comme inconnues ou manquantes (vides). This can cause problems with subsequent
calculations or analyses. Par exemple, la moyenne d'un ensemble de nombres
qui comprend une seule valeur vide est toujours vide (car l'ordinateur
ne peut pas deviner la valeur des observations manquantes). À cause de cela, il est très important d'enregistrer les zéros comme des zéros et vraiment les données manquantes comme des valeurs vides.

### Utilisation de valeurs vides problématiques {#null}

**Exemple** : utiliser -999 ou d'autres valeurs numériques (ou zéro) pour
représenter les données manquantes.

**Solutions**:

Il existe plusieurs raisons pour lesquelles les valeurs vides sont représentées différemment dans un jeu de données. Parfois, des valeurs vides déroutantes sont automatiquement
enregistrées à partir de l'appareil de mesure. Si tel est le cas, vous ne pouvez pas
faire grand-chose, mais cela peut être résolu lors du nettoyage des données avec un outil
comme
[OpenRefine](https://www.datacarpentry .org/OpenRefine-ecology-lesson/)
avant l'analyse. D'autres fois, différentes valeurs vides sont utilisées pour transmettre
différentes raisons pour lesquelles les données ne sont pas là. This is important
information to capture, but is in effect using one column to capture
two pieces of information. Like for using formatting to convey
information it would be good here to create a new
column like 'data\_missing' and use that column to capture the
different reasons.

Whatever the reason, it's a problem if unknown or missing data is
recorded as -999, 999, or 0.

De nombreux programmes statistiques ne reconnaitront pas qu'ils sont censés représenter des valeurs manquantes. How these values are interpreted
will depend on the software you use to analyse your data. Il est
essentiel d’utiliser un indicateur clairement défini et cohérent pour les valeurs vides.

Les blancs (pour la plupart des applications) et NA (pour R) sont de bons choix. @White : 2013 explique les bons choix pour indiquer des valeurs vides
pour différentes applications logicielles dans leur article :

![](fig/3_white_table_1.jpg)

### Utilisation du formatage pour transmettre des informations {#formatting}

**Example**: highlighting cells, rows or columns that should be
excluded from an analysis, leaving blank rows to indicate
separations in data.

![](fig/formatting.png)

**Solution** : créer un nouveau champ pour coder les données qui doivent être
exclues.

![](fig/good_formatting.png)

### Utilisation du formatage pour rendre la feuille de calcul jolie {#formatting\_pretty}

**Example**: merging cells.

**Solution** : Si vous ne faites pas attention, le formatage d'une feuille de calcul pour qu'elle soit plus
esthétique peut compromettre la capacité de votre ordinateur à voir les
associations dans les données. Merged cells will make your data unreadable
by statistics software. Consider restructuring your data in such a way
that you will not need to merge cells to organise your data.

### Commentaires ou unités dans des cellules {#units}

La plupart des logiciels d'analyse ne peuvent pas voir les commentaires Excel ou LibreOffice, et
serait embrouillé par les commentaires placés dans vos cellules de données. As
described above for formatting, create another field if you need to
add notes to cells. Similarly, don't include units in cells: ideally,
all the measurements you place in one column should be in the same
unit, but if for some reason they aren't, create another field and
specify the units the cell is in.

### Plusieurs informations dans une cellule {#info}

**Exemple** : Enregistrement des groupes sanguins ABO et rhésus dans une seule cellule, tels que A+,
B+, A-, ...

**Solution**: Don't include more than one piece of information in a
cell. This will limit the ways in which you can analyse your data.  Si
vous avez besoin de ces deux mesures, concevez votre feuille de calcul pour inclure
ces informations. Par exemple, incluez une colonne pour le groupe ABO et
une pour le rhésus.

### Using problematic field names {#field\_name}

Choose descriptive field names, but be careful not to include spaces,
numbers, or special characters of any kind. Les espaces peuvent être
mal interprétés par les parseurs qui utilisent des espaces comme délimiteurs et certains programmes
n'aiment pas les noms de champs qui sont des chaînes de caractères commençant par
nombres.

Les tirets bas (`_`) sont une bonne alternative aux espaces. Pensez à écrire les noms
en _camel case_ (comme ceci : SampleFileName) pour améliorer la lisibilité de. Remember that abbreviations that make sense at the moment
may not be so obvious in 6 months, but don't overdo it with names that
are excessively long. Including the units in the field names avoids
confusion and enables others to readily interpret your fields.

**Examples**

| Bon Nom                                                                   | Bonne Alternative                           | Avoid                                 |
| ------------------------------------------------------------------------- | ------------------------------------------- | ------------------------------------- |
| Max\_temp\_C                  | MaxTemp                                     | Temp Maximale (°C) |
| Precipitations\_mm                                  | Precipitation                               | precmm                                |
| Croissance\_annuelle\_moyenne | CroissanceAnnuelleMoyenne                   | Mean growth/year                      |
| sex                                                                       | sex                                         | M/F                                   |
| weight                                                                    | weight                                      | w.                    |
| type\_cellulaire                                    | TypeCellulaire                              | Type cellulaire                       |
| Observation\_01                                     | premiere\_observation | 1st Obs                               |

### Using special characters in data {#special}

**Example**: You treat your spreadsheet program as a word processor
when writing notes, for example copying data directly from Word or
other applications.

**Solution**: This is a common strategy. Par exemple, lorsqu'ils écrivent
un texte plus long dans une cellule, les utilisateurs incluent souvent des sauts de ligne, des tirets cadratins, etc. dans leur feuille de calcul. De même, lors de la copie de données à partir d'applications
telles que Word, le formatage et les caractères
non standard (tels que les guillemets alignés à gauche et à droite et les accents) sont inclus. When exporting this data into a coding/statistical
environment or into a relational database, dangerous things may occur,
such as lines being cut in half and encoding errors being thrown.

La meilleure pratique consiste à éviter d'ajouter des caractères tels que des nouvelles lignes, des tabulations
et des accents. En d'autres termes, traitez une cellule de texte comme s'il s'agissait d'un simple formulaire web qui ne peut contenir que du texte et des espaces.

### Inclusion of metadata in data table {#metadata}

**Example**: You add a legend at the top or bottom of your data table
explaining column meaning, units, exceptions, etc.

**Solution**: Recording data about your data ("metadata") is
essential. Il se peut que vous connaissiez parfaitement votre jeu de données pendant que vous les collectez et les analysez, mais il y a peu de chances que vous vous souveniez encore que la variable "sglmemgp" signifie membre unique d'un groupe, par exemple, ou de l'algorithme exact que vous avez utilisé pour transformer une variable ou en créer une dérivée, après quelques mois, un an ou plus.

De plus, il existe de nombreuses raisons pour lesquelles d'autres personnes pourraient vouloir examiner ou utiliser vos données : pour comprendre vos conclusions, pour vérifier vos conclusions, pour examiner la publication que vous avez soumise, pour reproduire vos résultats, pour concevoir une étude similaire, ou même archiver vos données pour y accéder et réutiliser par d'autres. While digital data by definition are
machine-readable, understanding their meaning is a job for human
beings. L'importance de documenter vos données pendant la phase de collecte
et d'analyse de votre recherche ne doit pas être sous-estimée,
surtout si votre recherche doit faire partie du dossier scientifique.

Cependant, les métadonnées ne doivent pas être contenues dans le fichier de données lui-même. Contrairement à un tableau dans un article ou un fichier supplémentaire, les métadonnées (sous forme de légendes) ne doivent pas être incluses dans un fichier de données puisque ces informations ne sont pas des données, et leur inclusion peut perturber la façon dont les programmes informatiques
interprètent votre fichier de données. Les métadonnées doivent plutôt être stockées
dans un fichier distinct dans le même dossier que votre fichier de données, de préférence
au format texte brut avec un nom qui l'associe clairement à votre
fichier de données. Parce que les fichiers de métadonnées sont au format texte libre, ils vous permettent également d'encoder des commentaires, des unités, des informations sur la façon dont les valeurs vides sont encodées, etc. qui sont importants pour documenter vos données, mais peuvent perturber le formatage de votre fichier de données.

De plus, les métadonnées au niveau d'un fichier ou de la base de données décrivent comment les fichiers qui constituent le jeu de données sont liés les uns aux autres ; dans quel format ils se trouvent ; et s'ils remplacent ou sont remplacés par les fichiers précédents. Un fichier readme.txt au niveau du dossier
est la manière classique de répertorier tous les
fichiers et dossiers d'un projet.

(Text on metadata adapted from the online course Research Data
[MANTRA](https://datalib.edina.ac.uk/mantra) by EDINA and Data Library,
University of Edinburgh. MANTRA is licensed under a Creative Commons
Attribution 4.0 International
License.)

## Exportation des données

**Question**

- Comment pouvons-nous exporter des données à partir de feuilles de calcul d'une manière utile pour les applications en aval ?

**Objectives**

- Stocker les données des feuilles de calcul dans des formats de fichiers universels.
- Exporter les données d'une feuille de calcul vers un fichier CSV.

**Keypoints**

- Les données stockées dans des formats de feuilles de calcul courants ne seront souvent pas lues correctement dans un logiciel d'analyse de données, introduisant des erreurs dans vos données.

- L'exportation de données à partir de feuilles de calcul vers des formats tels que CSV ou TSV les met dans un format qui peut être utilisé de manière cohérente par la plupart des programmes.

Storing the data you're going to work with for your analyses in Excel
default file format (`*.xls` or `*.xlsx` - depending on the Excel
version) isn't a good idea. Pourquoi ?

- Parce qu'il s'agit d'un format propriétaire, et qu'il est possible que dans le futur, la technologie n'existera pas (ou devienne suffisamment rare) pour rendre l'ouverture du fichier peu pratique, voire impossible.

- D'autres logiciels de tableur peuvent ne pas être en mesure d'ouvrir les fichiers enregistrés dans un format Excel propriétaire.

- Different versions of Excel may handle data differently, leading to
  inconsistencies. [Les dates](https://datacarpentry.org/spreadsheet-ecology-lesson/03-dates-as-data/index.html)
  sont un exemple bien documenté d'incohérences dans le stockage de données.

- Enfin, de plus en plus de revues et d'organismes de financement vous demandent de
  déposer vos données dans un dépôt de données, et la plupart d'entre eux n'acceptent pas
  le format Excel. Les données doivent être dans l’un des formats discutés
  ci-dessous.

- Les points ci-dessus s'appliquent également à d'autres formats tels que les formats open data
  utilisés par LibreOffice/Open Office. Ces formats ne sont pas statiques et ne sont pas analysés de la même manière par différents logiciels.

Le stockage des données dans un format universel, ouvert et statique aidera à résoudre ce problème. Essayez les valeurs délimitées par des tabulations (_tab separated values_ ou TSV) ou délimitées par des virgules (_comma separated values_ ou CSV). Les fichiers CSV sont des fichiers texte simples
où les colonnes sont séparées par des virgules, d'où _"comma separated values"_ ou CSV. The advantage of a CSV file over an
Excel/SPSS/etc. file is that we can open and read a CSV file using
just about any software, including plain text editors like TextEdit or
NotePad. Les données d'un fichier CSV peuvent également être facilement importées dans d'autres
formats et environnements, tels que SQLite et R. Nous ne sommes pas limités à une
certaine version d'un certain programme coûteux lorsque nous travaillons avec des
fichiers CSV, c'est donc un bon format avec lequel travailler pour une interopérabilité et une durabilité maximale. Most spreadsheet programs can save to delimited text
formats like CSV easily, although they may give you a warning during
the file export.

To save a file you have opened in Excel in CSV format:

1. Dans le menu supérieur, sélectionnez "Fichier" et "Enregistrer sous".
2. Dans le champ "Format", dans la liste, sélectionnez "délimité par des virgules" (`*.csv`).
3. Vérifiez le nom du fichier et l'emplacement où vous souhaitez l'enregistrer
  et cliquez sur "Enregistrer".

An important note for backwards compatibility: you can open CSV files
in Excel!

```{r, results="markup", fig.cap="Saving an Excel file to CSV.", echo=FALSE, purl=FALSE, out.width="70%", fig.align="center"}
knitr::include_graphics("fig/excel-to-csv.png")
```

**A note on R and `xls`**: There are R packages that can read `xls`
files (as well as Google spreadsheets). Il est même possible d'accéder à
différentes feuilles de calcul des documents `xls`.

**But**

- some of these only work on Windows.
- cela équivaut à remplacer une exportation (simple mais manuelle) vers `csv` par une complexité/dépendance supplémentaire dans le code R d'analyse des données.
- les meilleures pratiques en matière de formatage des données s’appliquent toujours.
- Y a-t-il vraiment une bonne raison pour laquelle `csv` (ou un format similaire) n'est pas adéquat ?

### Caveats on commas

Dans certains jeux de données, les valeurs des données elles-mêmes peuvent inclure des virgules
(,). In that case, the software which you use (including Excel) will
most likely incorrectly display the data in columns. En effet,
les virgules qui font partie des valeurs de données seront interprétées comme des délimiteurs.

For example, our data might look like this:

```
species_id,genus,species,taxa
AB,Amphispiza,bilineata,Bird
AH,Ammospermophilus,harrisi,Rodent, not censused
AS,Ammodramus,savannarum,Bird
BA,Baiomys,taylori,Rodent
```

Dans l'enregistrement "AH, Ammospermophilus, harrisi, Rodent, not censused", la valeur
pour « taxons » comprend une virgule ("Rodent, not censused").  If we try
to read the above into Excel (or other spreadsheet program), we will
get something like this:

```{r, results="markup", fig.cap="The risks of having commas inside comma-separated data.", echo=FALSE, purl=FALSE, out.width="80%", fig.align="center"}
knitr::include_graphics("fig/csv-mistake.png")
```

La valeur de « taxons » a été divisée en deux colonnes (au lieu d'être placée
dans une seule colonne "D"). Cela peut se propager à un certain nombre d'autres erreurs. For example, the extra column will be interpreted as a column
with many missing values (and without a proper header). En plus de
cela, la valeur dans la colonne "D" pour l'enregistrement de la ligne 3 (donc celle
où la valeur de "taxons" contenait la virgule) est désormais incorrecte.

If you want to store your data in `csv` format and expect that your
data values may contain commas, you can avoid the problem discussed
above by putting the values in quotes (""). Applying this rule, our
data might look like this:

```
species_id,genus,species,taxa
"AB","Amphispiza","bilineata","Bird"
"AH","Ammospermophilus","harrisi","Rodent, not censused"
"AS","Ammodramus","savannarum","Bird"
"BA","Baiomys","taylori","Rodent"
```

Désormais, l'ouverture de ce fichier en tant que "csv" dans Excel n'entraînera pas une colonne
supplémentaire, car Excel n'utilisera que des virgules qui se trouvent en dehors des guillemets
comme caractères de délimitation.

Alternatively, if you are working with data that contains commas, you
likely will need to use another delimiter when working in a
spreadsheet[^decsep]. In this case, consider using tabs as your delimiter and
working with TSV files. TSV files can be exported from spreadsheet
programs in the same way as CSV files.

[^decsep]: This is particularly relevant in European
    countries where the comma is used as a decimal
    separator. In such cases, the default value separator in a
    csv file will be the semi-colon (;), or values will be
    systematically quoted.

Si vous travaillez avec un jeu de données déjà existant dans lequel les valeurs de données ne sont pas incluses entre "" mais qui ont à la fois des virgules comme délimiteurs et faisant partie de valeurs de données, vous êtes potentiellement confronté à un problème majeur avec le nettoyage des données. Si le jeu de données que vous traitez contient
des centaines ou des milliers d'enregistrements, les nettoyer manuellement (soit en
supprimant les virgules des valeurs de données, soit en mettant les valeurs entre
guillemets - "") non seulement va prendre des heures et des heures, mais peut
finir par vous amener à introduire accidentellement de nombreuses erreurs.

Le nettoyage des jeux de données est l’un des problèmes majeurs dans de nombreuses disciplines scientifiques. The approach almost always depends on the particular
context. However, it is a good practice to clean the data in an
automated fashion, for example by writing and running a script. Des leçons
Python et R vous donneront les bases pour développer des compétences permettant de
créer des scripts pertinents.

## Summary

```{r analysis, results="asis", fig.margin=TRUE, fig.cap="A typical data analysis workflow.", fig.width=7, fig.height=4, echo=FALSE, purl=FALSE}
knitr::include_graphics("fig/analysis.png")
```

Un _workflow_ typique d'analyse de données est illustré dans la figure ci-dessus,
où les données sont transformées, visualisées et modélisées à plusieurs reprises. Cette itération est répétée plusieurs fois jusqu'à ce que les données soient comprises. Cependant, dans de nombreux cas réels, la majorité du temps est consacré au nettoyage et à la préparation des données, plutôt qu'à leur analyse et à leur compréhension.

Un _workflow_ d'analyse de données agile, avec plusieurs itérations rapides du cycle transformation/visualisation/modèle, n'est possible que si les données sont formatées de manière prévisible et que l'on peut raisonner sur les données sans avoir à les regarder et/ou à les corriger.

:::::::::::::::::::::::::::::::::::::::: keypoints

- Une bonne organisation des données est la base de tout projet de recherche.

::::::::::::::::::::::::::::::::::::::::::::::::::
